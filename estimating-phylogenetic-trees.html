<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Session 12 – Estimating Phylogenetic Trees | Bioinformatics Workshop Gitbook</title>
  <meta name="description" content="none" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Session 12 – Estimating Phylogenetic Trees | Bioinformatics Workshop Gitbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="none" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Session 12 – Estimating Phylogenetic Trees | Bioinformatics Workshop Gitbook" />
  
  <meta name="twitter:description" content="none" />
  

<meta name="author" content="Juan C. Santos &amp; Randy Ortiz" />


<meta name="date" content="2022-02-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sequence-alignments.html"/>
<link rel="next" href="mining-from-a-reference-dataset.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bioinformatics Workshop Gitbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>1</b> – Getting Started with R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#why-do-we-use-r"><i class="fa fa-check"></i><b>1.1</b> Why do we use R?</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#get-a-good-text-editor"><i class="fa fa-check"></i><b>1.2</b> Get a good text editor</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#r-studio"><i class="fa fa-check"></i><b>1.3</b> R studio</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-r"><i class="fa fa-check"></i><b>1.4</b> Installing R</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#annotating-code"><i class="fa fa-check"></i><b>1.5</b> Annotating code</a></li>
<li class="chapter" data-level="1.6" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#defining-a-working-directory-in-r"><i class="fa fa-check"></i><b>1.6</b> Defining a working directory in R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="using-r-installing-packages-and-importingexporting-data.html"><a href="using-r-installing-packages-and-importingexporting-data.html"><i class="fa fa-check"></i><b>2</b> – Using R, Installing Packages and Importing/Exporting Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-r-installing-packages-and-importingexporting-data.html"><a href="using-r-installing-packages-and-importingexporting-data.html#your-first-session"><i class="fa fa-check"></i><b>2.1</b> Your first session</a></li>
<li class="chapter" data-level="2.2" data-path="using-r-installing-packages-and-importingexporting-data.html"><a href="using-r-installing-packages-and-importingexporting-data.html#doing-some-base-functions-and-getting-help"><i class="fa fa-check"></i><b>2.2</b> Doing some base functions and getting help</a></li>
<li class="chapter" data-level="2.3" data-path="using-r-installing-packages-and-importingexporting-data.html"><a href="using-r-installing-packages-and-importingexporting-data.html#about-r-packages"><i class="fa fa-check"></i><b>2.3</b> About R-packages</a></li>
<li class="chapter" data-level="2.4" data-path="using-r-installing-packages-and-importingexporting-data.html"><a href="using-r-installing-packages-and-importingexporting-data.html#installing-packages"><i class="fa fa-check"></i><b>2.4</b> Installing packages</a></li>
<li class="chapter" data-level="2.5" data-path="using-r-installing-packages-and-importingexporting-data.html"><a href="using-r-installing-packages-and-importingexporting-data.html#downloading-data-files-github"><i class="fa fa-check"></i><b>2.5</b> Downloading data files (GitHub)</a></li>
<li class="chapter" data-level="2.6" data-path="using-r-installing-packages-and-importingexporting-data.html"><a href="using-r-installing-packages-and-importingexporting-data.html#importing-and-exporting-data"><i class="fa fa-check"></i><b>2.6</b> Importing and exporting data</a></li>
<li class="chapter" data-level="2.7" data-path="using-r-installing-packages-and-importingexporting-data.html"><a href="using-r-installing-packages-and-importingexporting-data.html#saving-data-as-rdata-.rdata-.rda"><i class="fa fa-check"></i><b>2.7</b> Saving data as Rdata (.rdata, .rda)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-data-structures-in-r.html"><a href="basic-data-structures-in-r.html"><i class="fa fa-check"></i><b>3</b> – Basic Data Structures in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-data-structures-in-r.html"><a href="basic-data-structures-in-r.html#scalars-and-vectors"><i class="fa fa-check"></i><b>3.1</b> Scalars and vectors</a></li>
<li class="chapter" data-level="3.2" data-path="basic-data-structures-in-r.html"><a href="basic-data-structures-in-r.html#matrices"><i class="fa fa-check"></i><b>3.2</b> Matrices</a></li>
<li class="chapter" data-level="3.3" data-path="basic-data-structures-in-r.html"><a href="basic-data-structures-in-r.html#arrays"><i class="fa fa-check"></i><b>3.3</b> Arrays</a></li>
<li class="chapter" data-level="3.4" data-path="basic-data-structures-in-r.html"><a href="basic-data-structures-in-r.html#data-frames"><i class="fa fa-check"></i><b>3.4</b> Data Frames</a></li>
<li class="chapter" data-level="3.5" data-path="basic-data-structures-in-r.html"><a href="basic-data-structures-in-r.html#tables"><i class="fa fa-check"></i><b>3.5</b> Tables</a></li>
<li class="chapter" data-level="3.6" data-path="basic-data-structures-in-r.html"><a href="basic-data-structures-in-r.html#lists"><i class="fa fa-check"></i><b>3.6</b> Lists</a></li>
<li class="chapter" data-level="3.7" data-path="basic-data-structures-in-r.html"><a href="basic-data-structures-in-r.html#data-tables"><i class="fa fa-check"></i><b>3.7</b> Data Tables</a></li>
<li class="chapter" data-level="3.8" data-path="basic-data-structures-in-r.html"><a href="basic-data-structures-in-r.html#tibbles"><i class="fa fa-check"></i><b>3.8</b> Tibbles</a></li>
<li class="chapter" data-level="3.9" data-path="basic-data-structures-in-r.html"><a href="basic-data-structures-in-r.html#dnastringsets-rnastringsets-and-aastringsets"><i class="fa fa-check"></i><b>3.9</b> DNAStringSets, RNAStringSets and AAStringSets</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="text-editing-and-data-transformations.html"><a href="text-editing-and-data-transformations.html"><i class="fa fa-check"></i><b>4</b> – Text Editing and Data Transformations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="text-editing-and-data-transformations.html"><a href="text-editing-and-data-transformations.html#working-with-character-strings"><i class="fa fa-check"></i><b>4.1</b> Working with character strings</a></li>
<li class="chapter" data-level="4.2" data-path="text-editing-and-data-transformations.html"><a href="text-editing-and-data-transformations.html#regular-expressions-regex"><i class="fa fa-check"></i><b>4.2</b> Regular expressions (Regex)</a></li>
<li class="chapter" data-level="4.3" data-path="text-editing-and-data-transformations.html"><a href="text-editing-and-data-transformations.html#comparing-ordering-and-simplifying-vectors"><i class="fa fa-check"></i><b>4.3</b> Comparing, ordering and simplifying vectors</a></li>
<li class="chapter" data-level="4.4" data-path="text-editing-and-data-transformations.html"><a href="text-editing-and-data-transformations.html#useful-functions-of-stringr"><i class="fa fa-check"></i><b>4.4</b> Useful functions of <code>stringr</code></a></li>
<li class="chapter" data-level="4.5" data-path="text-editing-and-data-transformations.html"><a href="text-editing-and-data-transformations.html#data-transformations"><i class="fa fa-check"></i><b>4.5</b> Data transformations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="getting-biological-data-from-public-repositories.html"><a href="getting-biological-data-from-public-repositories.html"><i class="fa fa-check"></i><b>5</b> – Getting Biological Data from Public Repositories</a>
<ul>
<li class="chapter" data-level="5.1" data-path="getting-biological-data-from-public-repositories.html"><a href="getting-biological-data-from-public-repositories.html#ncbi-databases-genbank-and-others"><i class="fa fa-check"></i><b>5.1</b> NCBI databases: GenBank and others</a></li>
<li class="chapter" data-level="5.2" data-path="getting-biological-data-from-public-repositories.html"><a href="getting-biological-data-from-public-repositories.html#accessing-ncbi-within-r-rentrez"><i class="fa fa-check"></i><b>5.2</b> Accessing NCBI within R: <code>rentrez</code></a></li>
<li class="chapter" data-level="5.3" data-path="getting-biological-data-from-public-repositories.html"><a href="getting-biological-data-from-public-repositories.html#retrieving-pubmed-references"><i class="fa fa-check"></i><b>5.3</b> Retrieving PubMed references</a></li>
<li class="chapter" data-level="5.4" data-path="getting-biological-data-from-public-repositories.html"><a href="getting-biological-data-from-public-repositories.html#comparing-sequences-blast"><i class="fa fa-check"></i><b>5.4</b> Comparing sequences: BLAST</a></li>
<li class="chapter" data-level="5.5" data-path="getting-biological-data-from-public-repositories.html"><a href="getting-biological-data-from-public-repositories.html#other-databases-uniprot"><i class="fa fa-check"></i><b>5.5</b> Other databases: UniProt</a></li>
<li class="chapter" data-level="5.6" data-path="getting-biological-data-from-public-repositories.html"><a href="getting-biological-data-from-public-repositories.html#other-databases-ensembl"><i class="fa fa-check"></i><b>5.6</b> Other databases: Ensembl</a></li>
<li class="chapter" data-level="5.7" data-path="getting-biological-data-from-public-repositories.html"><a href="getting-biological-data-from-public-repositories.html#other-databases-taxonomy-phylogenetic-trees-and-species-distributions"><i class="fa fa-check"></i><b>5.7</b> Other databases: Taxonomy, phylogenetic trees and species distributions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html"><i class="fa fa-check"></i><b>6</b> – Basic Statistics in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#exploring-your-data"><i class="fa fa-check"></i><b>6.1</b> Exploring your data</a></li>
<li class="chapter" data-level="6.2" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#normalizing-your-data"><i class="fa fa-check"></i><b>6.2</b> Normalizing your data</a></li>
<li class="chapter" data-level="6.3" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#what-test-should-i-use"><i class="fa fa-check"></i><b>6.3</b> What test should I use?</a></li>
<li class="chapter" data-level="6.4" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#comparing-means-t-test"><i class="fa fa-check"></i><b>6.4</b> Comparing means: t-test</a></li>
<li class="chapter" data-level="6.5" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#beyond-t-test-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>6.5</b> Beyond t-test: Wilcoxon signed rank test</a></li>
<li class="chapter" data-level="6.6" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#beyond-t-test-binomial-test"><i class="fa fa-check"></i><b>6.6</b> Beyond t-test: Binomial test</a></li>
<li class="chapter" data-level="6.7" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#beyond-t-test-chi-square-goodness-of-fit"><i class="fa fa-check"></i><b>6.7</b> Beyond t-test: Chi-square goodness of fit</a></li>
<li class="chapter" data-level="6.8" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#beyond-t-test-mcnemars-test"><i class="fa fa-check"></i><b>6.8</b> Beyond t-test: McNemar’s test</a></li>
<li class="chapter" data-level="6.9" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#beyond-t-test-fishers-exact-test"><i class="fa fa-check"></i><b>6.9</b> Beyond t-test: Fisher’s exact test</a></li>
<li class="chapter" data-level="6.10" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#correlations"><i class="fa fa-check"></i><b>6.10</b> Correlations</a></li>
<li class="chapter" data-level="6.11" data-path="basic-statistics-in-r.html"><a href="basic-statistics-in-r.html#comparing-distributions"><i class="fa fa-check"></i><b>6.11</b> Comparing distributions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html"><i class="fa fa-check"></i><b>7</b> – Regressions and ANOVA in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#linear-regressions"><i class="fa fa-check"></i><b>7.1</b> Linear regressions</a></li>
<li class="chapter" data-level="7.2" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#selecting-predictors"><i class="fa fa-check"></i><b>7.2</b> Selecting predictors</a></li>
<li class="chapter" data-level="7.3" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#logistic-regressions"><i class="fa fa-check"></i><b>7.3</b> Logistic regressions</a></li>
<li class="chapter" data-level="7.4" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#non-linear-regressions"><i class="fa fa-check"></i><b>7.4</b> Non-linear regressions</a></li>
<li class="chapter" data-level="7.5" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#toy-datasets-for-regressions"><i class="fa fa-check"></i><b>7.5</b> Toy datasets for regressions</a></li>
<li class="chapter" data-level="7.6" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#anova"><i class="fa fa-check"></i><b>7.6</b> ANOVA</a></li>
<li class="chapter" data-level="7.7" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#one-way-anova"><i class="fa fa-check"></i><b>7.7</b> One-way ANOVA</a></li>
<li class="chapter" data-level="7.8" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#two-way-anova"><i class="fa fa-check"></i><b>7.8</b> Two-way ANOVA</a></li>
<li class="chapter" data-level="7.9" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#post-hoc-tests"><i class="fa fa-check"></i><b>7.9</b> Post-hoc tests</a></li>
<li class="chapter" data-level="7.10" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#beyond-anova-kruskal-wallis-test"><i class="fa fa-check"></i><b>7.10</b> Beyond ANOVA: Kruskal-Wallis Test</a></li>
<li class="chapter" data-level="7.11" data-path="regressions-and-anova-in-r.html"><a href="regressions-and-anova-in-r.html#toy-datasets-for-anova"><i class="fa fa-check"></i><b>7.11</b> Toy datasets for ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exploring-multidimensional-data-in-r.html"><a href="exploring-multidimensional-data-in-r.html"><i class="fa fa-check"></i><b>8</b> – Exploring Multidimensional Data in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="exploring-multidimensional-data-in-r.html"><a href="exploring-multidimensional-data-in-r.html#principal-component-analysis"><i class="fa fa-check"></i><b>8.1</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="8.2" data-path="exploring-multidimensional-data-in-r.html"><a href="exploring-multidimensional-data-in-r.html#multidimensional-scaling"><i class="fa fa-check"></i><b>8.2</b> Multidimensional scaling</a></li>
<li class="chapter" data-level="8.3" data-path="exploring-multidimensional-data-in-r.html"><a href="exploring-multidimensional-data-in-r.html#cluster-analysis-dfa"><i class="fa fa-check"></i><b>8.3</b> Cluster analysis: DFA</a></li>
<li class="chapter" data-level="8.4" data-path="exploring-multidimensional-data-in-r.html"><a href="exploring-multidimensional-data-in-r.html#cluster-analysis-k-means-unsupervised"><i class="fa fa-check"></i><b>8.4</b> Cluster analysis: <em>k</em>-means (unsupervised)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html"><i class="fa fa-check"></i><b>9</b> – Graphics and Colors</a>
<ul>
<li class="chapter" data-level="9.1" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#avoid-bad-graphics"><i class="fa fa-check"></i><b>9.1</b> Avoid bad graphics</a></li>
<li class="chapter" data-level="9.2" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#graphics-in-r-ggplot2"><i class="fa fa-check"></i><b>9.2</b> Graphics in R – ggplot2</a></li>
<li class="chapter" data-level="9.3" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#preparing-your-dataset"><i class="fa fa-check"></i><b>9.3</b> Preparing your dataset</a></li>
<li class="chapter" data-level="9.4" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#color-palettes-online"><i class="fa fa-check"></i><b>9.4</b> Color palettes online</a></li>
<li class="chapter" data-level="9.5" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#ggplot2-default-palette"><i class="fa fa-check"></i><b>9.5</b> <code>ggplot2</code> default palette</a></li>
<li class="chapter" data-level="9.6" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#heatmaps-or-tiled-charts"><i class="fa fa-check"></i><b>9.6</b> Heatmaps or tiled charts</a></li>
<li class="chapter" data-level="9.7" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#r-packages-about-color"><i class="fa fa-check"></i><b>9.7</b> R-packages about color</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#viridis-package"><i class="fa fa-check"></i><b>9.7.1</b> <code>viridis</code> package</a></li>
<li class="chapter" data-level="9.7.2" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#rcolorbrewer-package"><i class="fa fa-check"></i><b>9.7.2</b> <code>RColorBrewer</code> package</a></li>
<li class="chapter" data-level="9.7.3" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#ggsci-package"><i class="fa fa-check"></i><b>9.7.3</b> <code>ggsci</code> package</a></li>
<li class="chapter" data-level="9.7.4" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#wesanderson-package"><i class="fa fa-check"></i><b>9.7.4</b> <code>wesanderson</code> package</a></li>
<li class="chapter" data-level="9.7.5" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#rcartocolor-package"><i class="fa fa-check"></i><b>9.7.5</b> <code>rcartocolor</code> package</a></li>
<li class="chapter" data-level="9.7.6" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#colorspace-package"><i class="fa fa-check"></i><b>9.7.6</b> <code>colorspace</code> package</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="graphics-and-colors.html"><a href="graphics-and-colors.html#making-your-own-palette"><i class="fa fa-check"></i><b>9.8</b> Making your own palette</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="basic-graphics.html"><a href="basic-graphics.html"><i class="fa fa-check"></i><b>10</b> – Basic Graphics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-graphics.html"><a href="basic-graphics.html#bar-charts"><i class="fa fa-check"></i><b>10.1</b> Bar charts</a></li>
<li class="chapter" data-level="10.2" data-path="basic-graphics.html"><a href="basic-graphics.html#stacked-bar-charts"><i class="fa fa-check"></i><b>10.2</b> Stacked bar charts</a></li>
<li class="chapter" data-level="10.3" data-path="basic-graphics.html"><a href="basic-graphics.html#histograms"><i class="fa fa-check"></i><b>10.3</b> Histograms</a></li>
<li class="chapter" data-level="10.4" data-path="basic-graphics.html"><a href="basic-graphics.html#multiple-histograms"><i class="fa fa-check"></i><b>10.4</b> Multiple histograms</a></li>
<li class="chapter" data-level="10.5" data-path="basic-graphics.html"><a href="basic-graphics.html#density-plots"><i class="fa fa-check"></i><b>10.5</b> Density plots</a></li>
<li class="chapter" data-level="10.6" data-path="basic-graphics.html"><a href="basic-graphics.html#box-plots"><i class="fa fa-check"></i><b>10.6</b> Box plots</a></li>
<li class="chapter" data-level="10.7" data-path="basic-graphics.html"><a href="basic-graphics.html#violin-plots"><i class="fa fa-check"></i><b>10.7</b> Violin plots</a></li>
<li class="chapter" data-level="10.8" data-path="basic-graphics.html"><a href="basic-graphics.html#scatterplots"><i class="fa fa-check"></i><b>10.8</b> Scatterplots</a></li>
<li class="chapter" data-level="10.9" data-path="basic-graphics.html"><a href="basic-graphics.html#lines-and-scatterplots"><i class="fa fa-check"></i><b>10.9</b> Lines and Scatterplots</a></li>
<li class="chapter" data-level="10.10" data-path="basic-graphics.html"><a href="basic-graphics.html#multiple-graphs-at-once-with-cowplot"><i class="fa fa-check"></i><b>10.10</b> Multiple graphs at once with <code>cowplot</code></a></li>
<li class="chapter" data-level="10.11" data-path="basic-graphics.html"><a href="basic-graphics.html#save-your-plots-as-pdf-or-png"><i class="fa fa-check"></i><b>10.11</b> Save your plots as PDF or PNG</a></li>
<li class="chapter" data-level="10.12" data-path="basic-graphics.html"><a href="basic-graphics.html#other-resources"><i class="fa fa-check"></i><b>10.12</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="sequence-alignments.html"><a href="sequence-alignments.html"><i class="fa fa-check"></i><b>11</b> – Sequence Alignments</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sequence-alignments.html"><a href="sequence-alignments.html#retrieving-sequences-using-rentrez"><i class="fa fa-check"></i><b>11.1</b> Retrieving sequences using ‘rentrez’</a></li>
<li class="chapter" data-level="11.2" data-path="sequence-alignments.html"><a href="sequence-alignments.html#retrieving-sequences-manually-from-ncbi"><i class="fa fa-check"></i><b>11.2</b> Retrieving sequences manually from NCBI</a></li>
<li class="chapter" data-level="11.3" data-path="sequence-alignments.html"><a href="sequence-alignments.html#retrieving-accession-numbers"><i class="fa fa-check"></i><b>11.3</b> Retrieving accession numbers</a></li>
<li class="chapter" data-level="11.4" data-path="sequence-alignments.html"><a href="sequence-alignments.html#alignment-with-decipher"><i class="fa fa-check"></i><b>11.4</b> Alignment with <code>DECIPHER</code></a></li>
<li class="chapter" data-level="11.5" data-path="sequence-alignments.html"><a href="sequence-alignments.html#visualize-alignment"><i class="fa fa-check"></i><b>11.5</b> Visualize alignment</a></li>
<li class="chapter" data-level="11.6" data-path="sequence-alignments.html"><a href="sequence-alignments.html#save-alignment-to-file"><i class="fa fa-check"></i><b>11.6</b> Save alignment to file</a></li>
<li class="chapter" data-level="11.7" data-path="sequence-alignments.html"><a href="sequence-alignments.html#concatenate-and-align-several-markers"><i class="fa fa-check"></i><b>11.7</b> Concatenate and align several markers</a></li>
<li class="chapter" data-level="11.8" data-path="sequence-alignments.html"><a href="sequence-alignments.html#concatenate-with-data.table"><i class="fa fa-check"></i><b>11.8</b> Concatenate with <code>data.table</code></a></li>
<li class="chapter" data-level="11.9" data-path="sequence-alignments.html"><a href="sequence-alignments.html#concatenate-with-biostrings"><i class="fa fa-check"></i><b>11.9</b> Concatenate with <code>Biostrings</code></a></li>
<li class="chapter" data-level="11.10" data-path="sequence-alignments.html"><a href="sequence-alignments.html#visualizing-alignments-in-r"><i class="fa fa-check"></i><b>11.10</b> Visualizing alignments in R</a></li>
<li class="chapter" data-level="11.11" data-path="sequence-alignments.html"><a href="sequence-alignments.html#other-sequence-alignment-software"><i class="fa fa-check"></i><b>11.11</b> Other sequence alignment software</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html"><i class="fa fa-check"></i><b>12</b> – Estimating Phylogenetic Trees</a>
<ul>
<li class="chapter" data-level="12.1" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#phylogeny-inference-with-iqtree2"><i class="fa fa-check"></i><b>12.1</b> Phylogeny inference with <code>iqtree2</code></a></li>
<li class="chapter" data-level="12.2" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#installing-iqtree2-in-macos"><i class="fa fa-check"></i><b>12.2</b> Installing <code>iqtree2</code> in macOS</a></li>
<li class="chapter" data-level="12.3" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#installing-and-running-iqtree2-in-a-pc"><i class="fa fa-check"></i><b>12.3</b> Installing and running <code>iqtree2</code> in a PC</a></li>
<li class="chapter" data-level="12.4" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#loading-the-iqtree_runner_r-function"><i class="fa fa-check"></i><b>12.4</b> Loading the <code>iqtree_runner_R</code> function</a></li>
<li class="chapter" data-level="12.5" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#running-iqtree2-from-r"><i class="fa fa-check"></i><b>12.5</b> Running <code>iqtree2</code> from R</a></li>
<li class="chapter" data-level="12.6" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#one-marker-and-no-partitions"><i class="fa fa-check"></i><b>12.6</b> One marker and no partitions</a></li>
<li class="chapter" data-level="12.7" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#one-marker-and-with-partitions"><i class="fa fa-check"></i><b>12.7</b> One marker and with partitions</a></li>
<li class="chapter" data-level="12.8" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#bootstrap-support"><i class="fa fa-check"></i><b>12.8</b> Bootstrap support</a></li>
<li class="chapter" data-level="12.9" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#many-markers-and-with-partitions"><i class="fa fa-check"></i><b>12.9</b> Many markers and with partitions</a></li>
<li class="chapter" data-level="12.10" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#other-sequence-phylogenetic-tree-estimation-software"><i class="fa fa-check"></i><b>12.10</b> Other sequence phylogenetic tree estimation software</a></li>
<li class="chapter" data-level="12.11" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#drawing-phylogenetic-trees-with-ggtree"><i class="fa fa-check"></i><b>12.11</b> Drawing phylogenetic trees with <code>ggtree</code></a></li>
<li class="chapter" data-level="12.12" data-path="estimating-phylogenetic-trees.html"><a href="estimating-phylogenetic-trees.html#save-ggtree-plots-as-pdf-or-png"><i class="fa fa-check"></i><b>12.12</b> Save ggtree plots as PDF or PNG</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mining-from-a-reference-dataset.html"><a href="mining-from-a-reference-dataset.html"><i class="fa fa-check"></i><b>13</b> – Mining from a reference dataset</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mining-from-a-reference-dataset.html"><a href="mining-from-a-reference-dataset.html#a-worked-example-using-the-mtcars-dataset"><i class="fa fa-check"></i><b>13.1</b> A worked example using the <code>mtcars</code> dataset</a></li>
<li class="chapter" data-level="13.2" data-path="mining-from-a-reference-dataset.html"><a href="mining-from-a-reference-dataset.html#build-a-reference-dataset"><i class="fa fa-check"></i><b>13.2</b> Build a reference dataset</a></li>
<li class="chapter" data-level="13.3" data-path="mining-from-a-reference-dataset.html"><a href="mining-from-a-reference-dataset.html#build-a-sampling-dataset"><i class="fa fa-check"></i><b>13.3</b> Build a sampling dataset</a></li>
<li class="chapter" data-level="13.4" data-path="mining-from-a-reference-dataset.html"><a href="mining-from-a-reference-dataset.html#extracting-from-reference-dataset"><i class="fa fa-check"></i><b>13.4</b> Extracting from reference dataset</a></li>
<li class="chapter" data-level="13.5" data-path="mining-from-a-reference-dataset.html"><a href="mining-from-a-reference-dataset.html#plots-of-the-extracted-data"><i class="fa fa-check"></i><b>13.5</b> Plots of the extracted data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="introduction-to-python.html"><a href="introduction-to-python.html"><i class="fa fa-check"></i><b>14</b> – Introduction to Python</a>
<ul>
<li class="chapter" data-level="14.1" data-path="introduction-to-python.html"><a href="introduction-to-python.html#welcome-to-python-why-python"><i class="fa fa-check"></i><b>14.1</b> Welcome to Python! Why Python?</a></li>
<li class="chapter" data-level="14.2" data-path="introduction-to-python.html"><a href="introduction-to-python.html#which-python-should-i-install"><i class="fa fa-check"></i><b>14.2</b> Which Python should I install?</a></li>
<li class="chapter" data-level="14.3" data-path="introduction-to-python.html"><a href="introduction-to-python.html#mac-os-x-python-installations"><i class="fa fa-check"></i><b>14.3</b> Mac OS X Python Installations</a></li>
<li class="chapter" data-level="14.4" data-path="introduction-to-python.html"><a href="introduction-to-python.html#windows-python-installations"><i class="fa fa-check"></i><b>14.4</b> Windows Python Installations</a></li>
<li class="chapter" data-level="14.5" data-path="introduction-to-python.html"><a href="introduction-to-python.html#install-an-ide-or-integrated-development-environment"><i class="fa fa-check"></i><b>14.5</b> Install an IDE, or integrated development environment</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="python-keywords-and-identifiers.html"><a href="python-keywords-and-identifiers.html"><i class="fa fa-check"></i><b>15</b> – Python: Keywords and Identifiers</a>
<ul>
<li class="chapter" data-level="15.1" data-path="python-keywords-and-identifiers.html"><a href="python-keywords-and-identifiers.html#keywords-in-python"><i class="fa fa-check"></i><b>15.1</b> Keywords in Python</a></li>
<li class="chapter" data-level="15.2" data-path="python-keywords-and-identifiers.html"><a href="python-keywords-and-identifiers.html#identifiers-in-python"><i class="fa fa-check"></i><b>15.2</b> Identifiers in Python</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="python-statements-and-expressions.html"><a href="python-statements-and-expressions.html"><i class="fa fa-check"></i><b>16</b> – Python: Statements and Expressions</a>
<ul>
<li class="chapter" data-level="16.1" data-path="python-statements-and-expressions.html"><a href="python-statements-and-expressions.html#what-are-statements"><i class="fa fa-check"></i><b>16.1</b> What are statements?</a></li>
<li class="chapter" data-level="16.2" data-path="python-statements-and-expressions.html"><a href="python-statements-and-expressions.html#expressions-in-python"><i class="fa fa-check"></i><b>16.2</b> Expressions in Python</a></li>
<li class="chapter" data-level="16.3" data-path="python-statements-and-expressions.html"><a href="python-statements-and-expressions.html#simple-assignment-statements-in-python"><i class="fa fa-check"></i><b>16.3</b> Simple Assignment Statements in Python</a></li>
<li class="chapter" data-level="16.4" data-path="python-statements-and-expressions.html"><a href="python-statements-and-expressions.html#augmented-assignment-statements-in-python"><i class="fa fa-check"></i><b>16.4</b> Augmented Assignment Statements in Python</a></li>
<li class="chapter" data-level="16.5" data-path="python-statements-and-expressions.html"><a href="python-statements-and-expressions.html#explicit-and-implicit-line-continuation"><i class="fa fa-check"></i><b>16.5</b> Explicit and Implicit Line Continuation</a></li>
<li class="chapter" data-level="16.6" data-path="python-statements-and-expressions.html"><a href="python-statements-and-expressions.html#indentation-in-python-is-crucial-to-proper-code-function"><i class="fa fa-check"></i><b>16.6</b> Indentation in Python is Crucial to Proper Code function</a></li>
<li class="chapter" data-level="16.7" data-path="python-statements-and-expressions.html"><a href="python-statements-and-expressions.html#comments"><i class="fa fa-check"></i><b>16.7</b> Comments</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="python-data-types.html"><a href="python-data-types.html"><i class="fa fa-check"></i><b>17</b> – Python: Data Types</a>
<ul>
<li class="chapter" data-level="17.1" data-path="python-data-types.html"><a href="python-data-types.html#booleans"><i class="fa fa-check"></i><b>17.1</b> Booleans</a></li>
<li class="chapter" data-level="17.2" data-path="python-data-types.html"><a href="python-data-types.html#numbers-int-float-and-complex"><i class="fa fa-check"></i><b>17.2</b> Numbers: int, float and complex</a></li>
<li class="chapter" data-level="17.3" data-path="python-data-types.html"><a href="python-data-types.html#strings"><i class="fa fa-check"></i><b>17.3</b> Strings</a></li>
<li class="chapter" data-level="17.4" data-path="python-data-types.html"><a href="python-data-types.html#bytes"><i class="fa fa-check"></i><b>17.4</b> Bytes</a></li>
<li class="chapter" data-level="17.5" data-path="python-data-types.html"><a href="python-data-types.html#lists-1"><i class="fa fa-check"></i><b>17.5</b> Lists</a></li>
<li class="chapter" data-level="17.6" data-path="python-data-types.html"><a href="python-data-types.html#tuples"><i class="fa fa-check"></i><b>17.6</b> Tuples</a></li>
<li class="chapter" data-level="17.7" data-path="python-data-types.html"><a href="python-data-types.html#sets"><i class="fa fa-check"></i><b>17.7</b> Sets</a></li>
<li class="chapter" data-level="17.8" data-path="python-data-types.html"><a href="python-data-types.html#dictionary"><i class="fa fa-check"></i><b>17.8</b> Dictionary</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="python-strings.html"><a href="python-strings.html"><i class="fa fa-check"></i><b>18</b> – Python: Strings</a>
<ul>
<li class="chapter" data-level="18.1" data-path="python-strings.html"><a href="python-strings.html#string-operators"><i class="fa fa-check"></i><b>18.1</b> String Operators</a></li>
<li class="chapter" data-level="18.2" data-path="python-strings.html"><a href="python-strings.html#other-string-modifiers"><i class="fa fa-check"></i><b>18.2</b> Other String Modifiers</a></li>
<li class="chapter" data-level="18.3" data-path="python-strings.html"><a href="python-strings.html#format-characters-in-strings"><i class="fa fa-check"></i><b>18.3</b> Format-Characters in Strings</a></li>
<li class="chapter" data-level="18.4" data-path="python-strings.html"><a href="python-strings.html#comparisons-with-strings"><i class="fa fa-check"></i><b>18.4</b> Comparisons with Strings</a></li>
<li class="chapter" data-level="18.5" data-path="python-strings.html"><a href="python-strings.html#padding-strings"><i class="fa fa-check"></i><b>18.5</b> Padding strings</a></li>
<li class="chapter" data-level="18.6" data-path="python-strings.html"><a href="python-strings.html#search-for-words-in-string-and-output-location"><i class="fa fa-check"></i><b>18.6</b> Search for words in string and output location</a></li>
<li class="chapter" data-level="18.7" data-path="python-strings.html"><a href="python-strings.html#seek-and-replace-in-strings"><i class="fa fa-check"></i><b>18.7</b> Seek and replace in strings</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="python-operators.html"><a href="python-operators.html"><i class="fa fa-check"></i><b>19</b> – Python: Operators</a>
<ul>
<li class="chapter" data-level="19.1" data-path="python-operators.html"><a href="python-operators.html#many-types-of-operators"><i class="fa fa-check"></i><b>19.1</b> Many types of operators</a></li>
<li class="chapter" data-level="19.2" data-path="python-operators.html"><a href="python-operators.html#arithmetic-operators"><i class="fa fa-check"></i><b>19.2</b> Arithmetic operators</a></li>
<li class="chapter" data-level="19.3" data-path="python-operators.html"><a href="python-operators.html#comparison-operators"><i class="fa fa-check"></i><b>19.3</b> Comparison operators</a></li>
<li class="chapter" data-level="19.4" data-path="python-operators.html"><a href="python-operators.html#logical-operators"><i class="fa fa-check"></i><b>19.4</b> Logical operators</a></li>
<li class="chapter" data-level="19.5" data-path="python-operators.html"><a href="python-operators.html#bitwise-operators"><i class="fa fa-check"></i><b>19.5</b> Bitwise operators</a></li>
<li class="chapter" data-level="19.6" data-path="python-operators.html"><a href="python-operators.html#identity-operators"><i class="fa fa-check"></i><b>19.6</b> Identity Operators</a></li>
<li class="chapter" data-level="19.7" data-path="python-operators.html"><a href="python-operators.html#membership-operators"><i class="fa fa-check"></i><b>19.7</b> Membership operators</a></li>
<li class="chapter" data-level="19.8" data-path="python-operators.html"><a href="python-operators.html#what-is-the-order-of-operations-with-operators"><i class="fa fa-check"></i><b>19.8</b> What is the order of operations with operators?</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="biopython.html"><a href="biopython.html"><i class="fa fa-check"></i><b>20</b> – Biopython</a>
<ul>
<li class="chapter" data-level="20.1" data-path="biopython.html"><a href="biopython.html#introduction-to-biopython"><i class="fa fa-check"></i><b>20.1</b> Introduction to Biopython</a></li>
<li class="chapter" data-level="20.2" data-path="biopython.html"><a href="biopython.html#biopython-installation"><i class="fa fa-check"></i><b>20.2</b> Biopython Installation</a></li>
<li class="chapter" data-level="20.3" data-path="biopython.html"><a href="biopython.html#getting-started"><i class="fa fa-check"></i><b>20.3</b> Getting Started</a></li>
<li class="chapter" data-level="20.4" data-path="biopython.html"><a href="biopython.html#parsing-my-fasta"><i class="fa fa-check"></i><b>20.4</b> Parsing my FASTA</a></li>
<li class="chapter" data-level="20.5" data-path="biopython.html"><a href="biopython.html#parsing-my-genbank-or-genpept"><i class="fa fa-check"></i><b>20.5</b> Parsing my GenBank or GenPept</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="biopython-sequences.html"><a href="biopython-sequences.html"><i class="fa fa-check"></i><b>21</b> – Biopython: Sequences</a>
<ul>
<li class="chapter" data-level="21.1" data-path="biopython-sequences.html"><a href="biopython-sequences.html#sequence-objects"><i class="fa fa-check"></i><b>21.1</b> Sequence Objects</a></li>
<li class="chapter" data-level="21.2" data-path="biopython-sequences.html"><a href="biopython-sequences.html#concatenation-with-sequences"><i class="fa fa-check"></i><b>21.2</b> Concatenation with Sequences</a></li>
<li class="chapter" data-level="21.3" data-path="biopython-sequences.html"><a href="biopython-sequences.html#transcription-dna-to-mrna"><i class="fa fa-check"></i><b>21.3</b> Transcription: DNA to mRNA</a></li>
<li class="chapter" data-level="21.4" data-path="biopython-sequences.html"><a href="biopython-sequences.html#translation-rna-to-prot"><i class="fa fa-check"></i><b>21.4</b> Translation: RNA to PROT</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="biopython-mulitple-sequence-alignments.html"><a href="biopython-mulitple-sequence-alignments.html"><i class="fa fa-check"></i><b>22</b> – Biopython: Mulitple Sequence Alignments</a>
<ul>
<li class="chapter" data-level="22.1" data-path="biopython-mulitple-sequence-alignments.html"><a href="biopython-mulitple-sequence-alignments.html#pairwise2"><i class="fa fa-check"></i><b>22.1</b> pairwise2</a></li>
<li class="chapter" data-level="22.2" data-path="biopython-mulitple-sequence-alignments.html"><a href="biopython-mulitple-sequence-alignments.html#pairwisealigner"><i class="fa fa-check"></i><b>22.2</b> PairwiseAligner</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="biopython-genomediagram.html"><a href="biopython-genomediagram.html"><i class="fa fa-check"></i><b>23</b> – Biopython: GenomeDiagram</a>
<ul>
<li class="chapter" data-level="23.1" data-path="biopython-genomediagram.html"><a href="biopython-genomediagram.html#linearcircular-gene-diagrams"><i class="fa fa-check"></i><b>23.1</b> Linear/Circular Gene Diagrams</a></li>
<li class="chapter" data-level="23.2" data-path="biopython-genomediagram.html"><a href="biopython-genomediagram.html#diagram-readability"><i class="fa fa-check"></i><b>23.2</b> Diagram Readability</a></li>
<li class="chapter" data-level="23.3" data-path="biopython-genomediagram.html"><a href="biopython-genomediagram.html#box-shape"><i class="fa fa-check"></i><b>23.3</b> Box Shape</a></li>
<li class="chapter" data-level="23.4" data-path="biopython-genomediagram.html"><a href="biopython-genomediagram.html#edit-box-shape-arrows"><i class="fa fa-check"></i><b>23.4</b> Edit Box Shape: Arrows</a></li>
<li class="chapter" data-level="23.5" data-path="biopython-genomediagram.html"><a href="biopython-genomediagram.html#restriction-map"><i class="fa fa-check"></i><b>23.5</b> Restriction Map</a></li>
<li class="chapter" data-level="23.6" data-path="biopython-genomediagram.html"><a href="biopython-genomediagram.html#tracks-on-tracks"><i class="fa fa-check"></i><b>23.6</b> Tracks on Tracks</a></li>
<li class="chapter" data-level="23.7" data-path="biopython-genomediagram.html"><a href="biopython-genomediagram.html#cross-link-data"><i class="fa fa-check"></i><b>23.7</b> Cross-link Data</a></li>
<li class="chapter" data-level="23.8" data-path="biopython-genomediagram.html"><a href="biopython-genomediagram.html#clean-cross-link"><i class="fa fa-check"></i><b>23.8</b> Clean Cross-Link</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="biopython-chromosome-modeling.html"><a href="biopython-chromosome-modeling.html"><i class="fa fa-check"></i><b>24</b> – Biopython: Chromosome Modeling</a>
<ul>
<li class="chapter" data-level="24.1" data-path="biopython-chromosome-modeling.html"><a href="biopython-chromosome-modeling.html#gene-feature-modeling"><i class="fa fa-check"></i><b>24.1</b> Gene Feature Modeling</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="biopython-sequence-parsing-with-plots.html"><a href="biopython-sequence-parsing-with-plots.html"><i class="fa fa-check"></i><b>25</b> – Biopython: Sequence Parsing with Plots</a>
<ul>
<li class="chapter" data-level="25.1" data-path="biopython-sequence-parsing-with-plots.html"><a href="biopython-sequence-parsing-with-plots.html#histograms-1"><i class="fa fa-check"></i><b>25.1</b> Histograms</a></li>
<li class="chapter" data-level="25.2" data-path="biopython-sequence-parsing-with-plots.html"><a href="biopython-sequence-parsing-with-plots.html#gc-content"><i class="fa fa-check"></i><b>25.2</b> GC Content</a></li>
<li class="chapter" data-level="25.3" data-path="biopython-sequence-parsing-with-plots.html"><a href="biopython-sequence-parsing-with-plots.html#nt-alignment-dot-plot"><i class="fa fa-check"></i><b>25.3</b> Nt Alignment Dot Plot</a></li>
<li class="chapter" data-level="25.4" data-path="biopython-sequence-parsing-with-plots.html"><a href="biopython-sequence-parsing-with-plots.html#bigger-dots-for-the-dot-plot"><i class="fa fa-check"></i><b>25.4</b> Bigger Dots for the Dot Plot</a></li>
<li class="chapter" data-level="25.5" data-path="biopython-sequence-parsing-with-plots.html"><a href="biopython-sequence-parsing-with-plots.html#fastq-we-did-not-forget-you"><i class="fa fa-check"></i><b>25.5</b> FASTQ we did not forget you</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="python-web-scraping-w-beautifulsoup.html"><a href="python-web-scraping-w-beautifulsoup.html"><i class="fa fa-check"></i><b>26</b> – Python: Web Scraping w/ BeautifulSoup</a>
<ul>
<li class="chapter" data-level="26.1" data-path="python-web-scraping-w-beautifulsoup.html"><a href="python-web-scraping-w-beautifulsoup.html#introduction"><i class="fa fa-check"></i><b>26.1</b> Introduction</a></li>
<li class="chapter" data-level="26.2" data-path="python-web-scraping-w-beautifulsoup.html"><a href="python-web-scraping-w-beautifulsoup.html#installation"><i class="fa fa-check"></i><b>26.2</b> Installation</a></li>
<li class="chapter" data-level="26.3" data-path="python-web-scraping-w-beautifulsoup.html"><a href="python-web-scraping-w-beautifulsoup.html#getting-started-1"><i class="fa fa-check"></i><b>26.3</b> Getting started</a></li>
<li class="chapter" data-level="26.4" data-path="python-web-scraping-w-beautifulsoup.html"><a href="python-web-scraping-w-beautifulsoup.html#mining-all-matching-tags"><i class="fa fa-check"></i><b>26.4</b> Mining all matching tags</a></li>
<li class="chapter" data-level="26.5" data-path="python-web-scraping-w-beautifulsoup.html"><a href="python-web-scraping-w-beautifulsoup.html#mining-tags-by-class-or-id"><i class="fa fa-check"></i><b>26.5</b> Mining tags by class or id</a></li>
<li class="chapter" data-level="26.6" data-path="python-web-scraping-w-beautifulsoup.html"><a href="python-web-scraping-w-beautifulsoup.html#use-css-selectors-for-positional-mining"><i class="fa fa-check"></i><b>26.6</b> Use CSS Selectors for positional mining</a></li>
<li class="chapter" data-level="26.7" data-path="python-web-scraping-w-beautifulsoup.html"><a href="python-web-scraping-w-beautifulsoup.html#weather-page-example"><i class="fa fa-check"></i><b>26.7</b> Weather Page Example</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="python-subprocess.html"><a href="python-subprocess.html"><i class="fa fa-check"></i><b>27</b> – Python Subprocess</a>
<ul>
<li class="chapter" data-level="27.1" data-path="python-subprocess.html"><a href="python-subprocess.html#introduction-and-installation"><i class="fa fa-check"></i><b>27.1</b> Introduction and Installation</a></li>
<li class="chapter" data-level="27.2" data-path="python-subprocess.html"><a href="python-subprocess.html#creating-your-first-python-script-w-bbtools"><i class="fa fa-check"></i><b>27.2</b> Creating your first python script w/ BBTools</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html"><i class="fa fa-check"></i><b>28</b> – Control Structures &amp; Loops in R</a>
<ul>
<li class="chapter" data-level="28.1" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#controling-the-flow"><i class="fa fa-check"></i><b>28.1</b> Controling the flow</a></li>
<li class="chapter" data-level="28.2" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#conditional-if"><i class="fa fa-check"></i><b>28.2</b> Conditional <code>if</code></a></li>
<li class="chapter" data-level="28.3" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#conditional-if-and-else"><i class="fa fa-check"></i><b>28.3</b> Conditional <code>if</code> and <code>else</code></a></li>
<li class="chapter" data-level="28.4" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#nested-conditionals-if-if-else-and-else"><i class="fa fa-check"></i><b>28.4</b> Nested conditionals <code>if</code>, <code>if else</code> and <code>else</code></a></li>
<li class="chapter" data-level="28.5" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#conditional-ifelse"><i class="fa fa-check"></i><b>28.5</b> Conditional <code>ifelse</code></a></li>
<li class="chapter" data-level="28.6" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#loops-that-control-iterations-and-repeations"><i class="fa fa-check"></i><b>28.6</b> Loops that control iterations and repeations</a></li>
<li class="chapter" data-level="28.7" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#the-for-loop"><i class="fa fa-check"></i><b>28.7</b> The <code>for</code> Loop</a></li>
<li class="chapter" data-level="28.8" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#the-while-loop"><i class="fa fa-check"></i><b>28.8</b> The <code>while</code> Loop</a></li>
<li class="chapter" data-level="28.9" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#the-repeat-loop"><i class="fa fa-check"></i><b>28.9</b> The <code>repeat</code> Loop</a></li>
<li class="chapter" data-level="28.10" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#the-next-and-break-statements"><i class="fa fa-check"></i><b>28.10</b> The <code>next</code> and <code>break</code> statements</a></li>
<li class="chapter" data-level="28.11" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#other-loop-functionslapply"><i class="fa fa-check"></i><b>28.11</b> Other loop functions:<code>lapply</code></a></li>
<li class="chapter" data-level="28.12" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#other-loop-functionsapply"><i class="fa fa-check"></i><b>28.12</b> Other loop functions:<code>apply</code></a></li>
<li class="chapter" data-level="28.13" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#other-loop-functionsmapply"><i class="fa fa-check"></i><b>28.13</b> Other loop functions:<code>mapply</code></a></li>
<li class="chapter" data-level="28.14" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#other-loop-functionstapply"><i class="fa fa-check"></i><b>28.14</b> Other loop functions:<code>tapply</code></a></li>
<li class="chapter" data-level="28.15" data-path="control-structures-loops-in-r.html"><a href="control-structures-loops-in-r.html#other-loop-functionssplit"><i class="fa fa-check"></i><b>28.15</b> Other loop functions:<code>split</code></a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="bioinformatics-literature.html"><a href="bioinformatics-literature.html"><i class="fa fa-check"></i><b>29</b> – Bioinformatics Literature</a>
<ul>
<li class="chapter" data-level="29.1" data-path="bioinformatics-literature.html"><a href="bioinformatics-literature.html#peer-reviewed-bioinformatics-journals"><i class="fa fa-check"></i><b>29.1</b> Peer-reviewed bioinformatics journals</a></li>
<li class="chapter" data-level="29.2" data-path="bioinformatics-literature.html"><a href="bioinformatics-literature.html#access-to-journals-articles"><i class="fa fa-check"></i><b>29.2</b> Access to journals articles</a></li>
<li class="chapter" data-level="29.3" data-path="bioinformatics-literature.html"><a href="bioinformatics-literature.html#informal-access-to-code-preprints-and-vignettes"><i class="fa fa-check"></i><b>29.3</b> Informal access to code: Preprints and vignettes</a></li>
<li class="chapter" data-level="29.4" data-path="bioinformatics-literature.html"><a href="bioinformatics-literature.html#accessing-online-data-dryad"><i class="fa fa-check"></i><b>29.4</b> Accessing online data (DRYAD)</a></li>
<li class="chapter" data-level="29.5" data-path="bioinformatics-literature.html"><a href="bioinformatics-literature.html#fixing-problems-while-importing-datasets"><i class="fa fa-check"></i><b>29.5</b> Fixing problems while importing datasets</a></li>
<li class="chapter" data-level="29.6" data-path="bioinformatics-literature.html"><a href="bioinformatics-literature.html#online-bioinformatics-courses"><i class="fa fa-check"></i><b>29.6</b> Online bioinformatics courses</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>30</b> – Miscellaneous</a>
<ul>
<li class="chapter" data-level="30.1" data-path="miscellaneous.html"><a href="miscellaneous.html#sampling-from-a-vector-of-names"><i class="fa fa-check"></i><b>30.1</b> Sampling from a vector of names</a></li>
<li class="chapter" data-level="30.2" data-path="miscellaneous.html"><a href="miscellaneous.html#miscellaneous-1"><i class="fa fa-check"></i><b>30.2</b> Miscellaneous</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bioinformatics Workshop Gitbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimating-phylogenetic-trees" class="section level1" number="12">
<h1><span class="header-section-number">Session 12</span> – Estimating Phylogenetic Trees</h1>
<p>Most sequence alignments can be used to estimate phylogenies. These are hypotheses of evolutionary relationships between sequences and the species or populations that they represent. Phylogenies can be estimated from DNA, RNA and amino acid sequences (other features like morphology can also be used). The tree topology provides information about the observed organisms (i.e., source of sequences) at the tips or leaves of the tree, the internal vertices or nodes that represent intermediate ancestors (i.e., likely extinct), and the edges or connecting lines represent evolutionary ancestor-descendant relationships. The value of phylogenies is fundamental in the study biological diversity from taxonomy, epidemiology and population genetics. Data for molecular phylogenies are easy to collect, yet problems derived from homoplasy, reversals and incomplete lineage sorting might affect the reliability of phylogenetic hypotheses.</p>
<p><img src="figures/session_12_figs/1_Darwins_I_think.jpg" width="60%" /></p>
<p>One of <a href="https://en.wikipedia.org/wiki/Charles_Darwin" target="_blank"><strong>Charles Darwin</strong></a> greatest insights was phylogenetic trees that has shape modern biology.</p>
<div id="phylogeny-inference-with-iqtree2" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Phylogeny inference with <code>iqtree2</code></h2>
<p>I do not use R or any R packages to estimate phylogenies, there are so many good programs on their own that can to this better and faster. We can devote many sessions to talk about these software, yet we will concentrate only in <a href="http://www.iqtree.org/" target="_blank"><strong>iqtree2</strong></a> that has emerged as a fast and reliable software that also includes molecular model testing and sequence partition. Likewise, <strong>iqtree2</strong> has an extensive manual <a href="http://www.iqtree.org/doc/Tutorial" target="_blank"><strong>here</strong></a> and it also can be easily manipulated within R. This will also illustrate how R can manage software outside its environment and bring back results to it.</p>
</div>
<div id="installing-iqtree2-in-macos" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Installing <code>iqtree2</code> in macOS</h2>
<p><strong>1)</strong> We will start with installing <a href="http://www.iqtree.org/" target="_blank"><strong>iqtree2</strong></a> and locating the path of the binary file that will be used R to run phylogenetic estimations.</p>
<p><strong>a)</strong> You need to go first to <a href="http://www.iqtree.org/#download" target="_blank"><strong>iqtree2 download</strong></a> website and choose the 64-bit multicore version for your operative system (i.e., macOS, Windows or Linux). Make sure that it is version 2: <strong>COVID-19 release 2.1.2 (October 22, 2020)</strong>.</p>
<p><img src="figures/session_12_figs/2_iqtree_donwload.png" width="90%" /></p>
<p><strong>b)</strong> This is a zip file and you need to uncompress it and search for the folder with the precompiled version (in masOS is called <code>bin</code>) and copy that file to directly that you will like to store such software. In my case, I named <code>my_programs</code></p>
<p><img src="figures/session_12_figs/3_iqtree_unpack.png" width="90%" /></p>
<p><strong>c)</strong> Now, the <code>my_programs</code> folder includes the binary <strong>iqtree2</strong> that is the only thing that you might need to run this program.</p>
<p><strong>d) For macOS:</strong> You can test if this program is working by opening the <strong>Terminal</strong> on your computer. Most people do not have <strong>Terminal</strong> in their dock for easy access software. To open <strong>Terminal</strong>, you need to access your hard drive (click on it). Then, look for <strong>Applications</strong> folder (click on it). In this folder look for subfolder <strong>Utilities</strong>.</p>
<p><img src="figures/session_12_figs/4_iterminal.png" width="90%" /></p>
<p><strong>e) For macOS:</strong> the <strong>Terminal</strong> icon is in the <strong>Utilities</strong> folder and you can create a shortcut by draging <strong>Terminal</strong> to your dock. However, you do not have to do this to test <strong>iqtree2</strong>.</p>
<p><img src="figures/session_12_figs/5_find_terminal.png" width="90%" /></p>
<p><strong>f) For macOS:</strong> You can activate <strong>Terminal</strong> by double clicking on it and a new window will appear like the one below.</p>
<p><img src="figures/session_12_figs/6_open_terminal.png" width="90%" /></p>
<p><strong>g) For macOS:</strong> The working directory by default is root. You need to change working directory by typing <code>cd</code> and dragging and dropping the folder that contains <strong>iqtree2</strong> (i.e., in my case, the folder <code>my_programs</code>).</p>
<p><img src="figures/session_12_figs/7_change_to_folder.png" width="90%" /></p>
<p><strong>h) For macOS:</strong> After pressing enter, the working directory will be now <code>my_programs</code>. You can type <code>ls</code> and enter. You will get that <strong>iqtree2</strong> file is there.</p>
<p><img src="figures/session_12_figs/8_ls_folder.png" width="90%" /></p>
<p><strong>i) For macOS:</strong> To make sure that <strong>iqtree2</strong> will work, you will need to type <code>./iqtree2</code> and press enter.</p>
<p><img src="figures/session_12_figs/9_fot_iqtree.png" width="90%" /></p>
<p><strong>j) For macOS:</strong> After pressing enter, you should get the following message.</p>
<p><img src="figures/session_12_figs/10_test_for_iqtree2.png" width="90%" /></p>
<p><strong>NOTICE:</strong> For PCs, the process to run <strong>iqtree2</strong> outside R are provided in <a href="http://www.iqtree.org/doc/Quickstart#for-windows-users" target="_blank"><strong>here</strong></a>.</p>
</div>
<div id="installing-and-running-iqtree2-in-a-pc" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Installing and running <code>iqtree2</code> in a PC</h2>
<p><strong>2)</strong> We will start with installing <a href="http://www.iqtree.org/" target="_blank"><strong>iqtree2</strong></a> and locating the path of the binary file that will be used R to run phylogenetic estimations.</p>
<p><strong>a)</strong> You need to go first to <a href="http://www.iqtree.org/#download" target="_blank"><strong>iqtree2 download</strong></a> website and choose the 64-bit multicore version for your operative system (i.e., macOS, Windows or Linux). Make sure that it is version 2: <strong>COVID-19 release 2.1.2 (October 22, 2020)</strong>.</p>
<p><img src="figures/session_12_figs/2_iqtree_donwload.png" width="90%" /></p>
<p><strong>b)</strong> This is a zip file and you need to uncompress it and search for the folder with the precompiled version (in PC is called <code>bin</code>) and you will see three files: <code>iqtree</code>, <code>iqtree-click</code> and <code>libiomp5md.dll</code>.</p>
<p><img src="figures/session_12_figs/22_pc_iqtree_pc3.jpg" width="100%" /></p>
<p><strong>c)</strong> The <code>iqtree_runner_R</code> function <strong>DOES NOT</strong> run in PCs, but it will give the commands that you need to run this software.</p>
<p><strong>d)</strong> On the folder that contains your alignment, you need to copy that files <code>iqtree-click</code> and <code>libiomp5md.dll</code> to be able to run the iqtree2 program. This folder should contain the aligned sequence (<strong>Session 12</strong>) or you can access some these files with aligned data and download them from the <a href="https://github.com/corytophanes/BIO_BIT_Bioinformatics_209/tree/main/ref_files_pdfs" target="_blank"><strong>GitHub repository</strong></a> for this class (e.g., <code>Ameerega_aligned_end.fasta</code>).</p>
<p><img src="figures/session_12_figs/23_pc_iqtree_pc2.jpg" width="100%" /></p>
<p><strong>e)</strong> To activate the interactive <code>iqtree</code> command building tool, you need to <strong>double click</strong> on the <code>iqtree-click</code> (Notice that windows might prevent you from running so, you will need to allow the program to run).
You will get the following window.</p>
<p><img src="figures/session_12_figs/24_pc_iqtree_pc4.jpg" width="100%" /></p>
<p><strong>f)</strong> Now, you will interact with this window bulding commands to run <code>iqtree</code> by presing <code>y</code>.</p>
<p><img src="figures/session_12_figs/25_pc_iqtree_pc5.jpg" width="100%" /></p>
<p><strong>g)</strong> The first command will be <code>-s</code> for the alignment input and then <code>e</code> to extend.</p>
<p><img src="figures/session_12_figs/26_pc_iqtree_pc6.jpg" width="100%" /></p>
<p><strong>h)</strong> We will add to the command line the name of the alignment in the folder <code>Ameerega_aligned_end.fasta</code> for the alignment input and then <code>e</code> to extend.</p>
<p><img src="figures/session_12_figs/27_pc_iqtree_pc8.jpg" width="100%" /></p>
<p><strong>h)</strong> We will continue adding to the command line the options for model <code>-m</code>, then <code>e</code> to extend, then <code>MFP+MERGE</code>.</p>
<p><img src="figures/session_12_figs/28_pc_iqtree_pc9.jpg" width="100%" /></p>
<p><strong>i)</strong> After we have included all commands to the command line, we will type <code>y</code> to confirm.</p>
<p><img src="figures/session_12_figs/29_pc_iqtree_pc10.jpg" width="100%" /></p>
<p><strong>j)</strong> If correct, the program will run and you will have to wait until it finish and then press <code>return</code> to exit.</p>
<p><img src="figures/session_12_figs/30_pc_iqtree_pc11.jpg" width="100%" /></p>
<p><strong>k)</strong> In the folder, you will see the output files. The file <code>*.treefile</code> will contain the resulting phylogeny.</p>
<p><img src="figures/session_12_figs/31_pc_iqtree_pc12.jpg" width="100%" /></p>
<p><strong>l)</strong> To run other commands in this format (e.g., bootstraps or with partitions), you need to run <code>iqtree_runner_R</code> first to get all the necessary input commands. They will look as follows on the first few lines of the <code>iqtree_runner_R</code> function output (even if it does not run):</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="estimating-phylogenetic-trees.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="do">## this is an example of the commands that you need to input in the format for PCs</span></span>
<span id="cb485-2"><a href="estimating-phylogenetic-trees.html#cb485-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;iqtree2  -s Ameerega_aligned_end.fasta     -m  MFP+MERGE  &quot;</span></span></code></pre></div>
</div>
<div id="loading-the-iqtree_runner_r-function" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Loading the <code>iqtree_runner_R</code> function</h2>
<p><strong>3)</strong> To run software outside R requires several components and scripting outside this workshop, I will not go in detail on these other than provide you with a function that will allow you to run our aligned sequence matrices (<strong>Session 12</strong>) or you can access some these files with aligned data on the <a href="https://github.com/corytophanes/BIO_BIT_Bioinformatics_209/tree/main/ref_files_pdfs" target="_blank"><strong>GitHub repository</strong></a> for this class (e.g., <code>Ameerega_aligned_end.fasta</code>). The function provided below allows to run <strong>iqtree2</strong> and importing back the tree and its nodal support after the analyses. However, it only works in macOS and for PC users please follow instructions on <strong>2)</strong>. If you have questions about the <code>iqtree_runner_R</code> function below, please contact me for more details.</p>
<p>You need to install two packages <code>doParallel</code> and <code>ape</code> before we run <code>iqtree_runner_R</code>. We will not get into details about <code>doParallel</code>, but we will use <code>ape</code> for other phylogenetic analyses.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="estimating-phylogenetic-trees.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="do">## it requires to install these R packages</span></span>
<span id="cb486-2"><a href="estimating-phylogenetic-trees.html#cb486-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;doParallel&quot;</span>)</span>
<span id="cb486-3"><a href="estimating-phylogenetic-trees.html#cb486-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ape&quot;</span>)</span></code></pre></div>
<p>Please copy an paste the text below for <code>iqtree_runner_R</code> in R. This function is to run iqtree2 from your computer, but it has been used in macOS. We will need to test for PCs</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="estimating-phylogenetic-trees.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="do">## make sure that you have the required packages</span></span>
<span id="cb487-2"><a href="estimating-phylogenetic-trees.html#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(doParallel)</span>
<span id="cb487-3"><a href="estimating-phylogenetic-trees.html#cb487-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ape)</span>
<span id="cb487-4"><a href="estimating-phylogenetic-trees.html#cb487-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-5"><a href="estimating-phylogenetic-trees.html#cb487-5" aria-hidden="true" tabindex="-1"></a><span class="do">## iqtree_runner function copy text from here until </span><span class="re">END</span><span class="do"> OF FUNCTION (find this below)</span></span>
<span id="cb487-6"><a href="estimating-phylogenetic-trees.html#cb487-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-7"><a href="estimating-phylogenetic-trees.html#cb487-7" aria-hidden="true" tabindex="-1"></a>iqtree_runner_R <span class="ot">&lt;-</span> <span class="cf">function</span>(input_alignment_file_user,</span>
<span id="cb487-8"><a href="estimating-phylogenetic-trees.html#cb487-8" aria-hidden="true" tabindex="-1"></a>                           iqtree_bin_location_user,</span>
<span id="cb487-9"><a href="estimating-phylogenetic-trees.html#cb487-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">run_iqtree_call_user =</span> <span class="fu">c</span>(<span class="st">&quot;serial&quot;</span>,<span class="st">&quot;parallel&quot;</span>),</span>
<span id="cb487-10"><a href="estimating-phylogenetic-trees.html#cb487-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_quiet_user =</span> <span class="cn">FALSE</span>,</span>
<span id="cb487-11"><a href="estimating-phylogenetic-trees.html#cb487-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_redo_user =</span> <span class="cn">FALSE</span>,</span>
<span id="cb487-12"><a href="estimating-phylogenetic-trees.html#cb487-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_prefix_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-13"><a href="estimating-phylogenetic-trees.html#cb487-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_input_model_m_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-14"><a href="estimating-phylogenetic-trees.html#cb487-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_mtree_user =</span> <span class="cn">FALSE</span>,</span>
<span id="cb487-15"><a href="estimating-phylogenetic-trees.html#cb487-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_sequence_type_st_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-16"><a href="estimating-phylogenetic-trees.html#cb487-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_UFBoot_B_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-17"><a href="estimating-phylogenetic-trees.html#cb487-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_UFBoot_bnni_user =</span> <span class="cn">TRUE</span>,</span>
<span id="cb487-18"><a href="estimating-phylogenetic-trees.html#cb487-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_nonpara_boot_b_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-19"><a href="estimating-phylogenetic-trees.html#cb487-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_SHaLRT_alrt_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-20"><a href="estimating-phylogenetic-trees.html#cb487-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_multicore_T_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-21"><a href="estimating-phylogenetic-trees.html#cb487-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_maxcores_ntmax_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-22"><a href="estimating-phylogenetic-trees.html#cb487-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_partition_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-23"><a href="estimating-phylogenetic-trees.html#cb487-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_partition_if_by_position_user =</span> <span class="cn">TRUE</span>,</span>
<span id="cb487-24"><a href="estimating-phylogenetic-trees.html#cb487-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_partition_file_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-25"><a href="estimating-phylogenetic-trees.html#cb487-25" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_chronogram_from_tree_file_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-26"><a href="estimating-phylogenetic-trees.html#cb487-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_chronogram_mrca_bounds_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-27"><a href="estimating-phylogenetic-trees.html#cb487-27" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_date_file_user =</span> <span class="cn">NULL</span>,</span>
<span id="cb487-28"><a href="estimating-phylogenetic-trees.html#cb487-28" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_pass_parameters_user =</span> <span class="cn">NULL</span>){</span>
<span id="cb487-29"><a href="estimating-phylogenetic-trees.html#cb487-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-30"><a href="estimating-phylogenetic-trees.html#cb487-30" aria-hidden="true" tabindex="-1"></a><span class="do">## require libraries</span></span>
<span id="cb487-31"><a href="estimating-phylogenetic-trees.html#cb487-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-32"><a href="estimating-phylogenetic-trees.html#cb487-32" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(doParallel)</span>
<span id="cb487-33"><a href="estimating-phylogenetic-trees.html#cb487-33" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ape)</span>
<span id="cb487-34"><a href="estimating-phylogenetic-trees.html#cb487-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-35"><a href="estimating-phylogenetic-trees.html#cb487-35" aria-hidden="true" tabindex="-1"></a><span class="do">############# input from user</span></span>
<span id="cb487-36"><a href="estimating-phylogenetic-trees.html#cb487-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-37"><a href="estimating-phylogenetic-trees.html#cb487-37" aria-hidden="true" tabindex="-1"></a><span class="do">## sequence and tree arguments</span></span>
<span id="cb487-38"><a href="estimating-phylogenetic-trees.html#cb487-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-39"><a href="estimating-phylogenetic-trees.html#cb487-39" aria-hidden="true" tabindex="-1"></a>input_files <span class="ot">&lt;-</span> input_alignment_file_user </span>
<span id="cb487-40"><a href="estimating-phylogenetic-trees.html#cb487-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-41"><a href="estimating-phylogenetic-trees.html#cb487-41" aria-hidden="true" tabindex="-1"></a><span class="co"># iqtree location</span></span>
<span id="cb487-42"><a href="estimating-phylogenetic-trees.html#cb487-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-43"><a href="estimating-phylogenetic-trees.html#cb487-43" aria-hidden="true" tabindex="-1"></a>iqtree_bin_location <span class="ot">&lt;-</span> iqtree_bin_location_user</span>
<span id="cb487-44"><a href="estimating-phylogenetic-trees.html#cb487-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-45"><a href="estimating-phylogenetic-trees.html#cb487-45" aria-hidden="true" tabindex="-1"></a><span class="co"># serial or parallel calls</span></span>
<span id="cb487-46"><a href="estimating-phylogenetic-trees.html#cb487-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-47"><a href="estimating-phylogenetic-trees.html#cb487-47" aria-hidden="true" tabindex="-1"></a>run_iqtree <span class="ot">&lt;-</span> run_iqtree_call_user</span>
<span id="cb487-48"><a href="estimating-phylogenetic-trees.html#cb487-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-49"><a href="estimating-phylogenetic-trees.html#cb487-49" aria-hidden="true" tabindex="-1"></a>iqtree_quiet <span class="ot">&lt;-</span> iqtree_quiet_user</span>
<span id="cb487-50"><a href="estimating-phylogenetic-trees.html#cb487-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-51"><a href="estimating-phylogenetic-trees.html#cb487-51" aria-hidden="true" tabindex="-1"></a><span class="do">####### basic iqtree parameters</span></span>
<span id="cb487-52"><a href="estimating-phylogenetic-trees.html#cb487-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-53"><a href="estimating-phylogenetic-trees.html#cb487-53" aria-hidden="true" tabindex="-1"></a><span class="co"># overwrite all previous output: -redo</span></span>
<span id="cb487-54"><a href="estimating-phylogenetic-trees.html#cb487-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-55"><a href="estimating-phylogenetic-trees.html#cb487-55" aria-hidden="true" tabindex="-1"></a>iqtree_redo <span class="ot">&lt;-</span> iqtree_redo_user</span>
<span id="cb487-56"><a href="estimating-phylogenetic-trees.html#cb487-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-57"><a href="estimating-phylogenetic-trees.html#cb487-57" aria-hidden="true" tabindex="-1"></a><span class="co"># add prefi: --prefix</span></span>
<span id="cb487-58"><a href="estimating-phylogenetic-trees.html#cb487-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-59"><a href="estimating-phylogenetic-trees.html#cb487-59" aria-hidden="true" tabindex="-1"></a>iqtree_prefix <span class="ot">&lt;-</span> iqtree_prefix_user</span>
<span id="cb487-60"><a href="estimating-phylogenetic-trees.html#cb487-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-61"><a href="estimating-phylogenetic-trees.html#cb487-61" aria-hidden="true" tabindex="-1"></a><span class="co"># add model: -m</span></span>
<span id="cb487-62"><a href="estimating-phylogenetic-trees.html#cb487-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-63"><a href="estimating-phylogenetic-trees.html#cb487-63" aria-hidden="true" tabindex="-1"></a>iqtree_model <span class="ot">&lt;-</span> iqtree_input_model_m_user</span>
<span id="cb487-64"><a href="estimating-phylogenetic-trees.html#cb487-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-65"><a href="estimating-phylogenetic-trees.html#cb487-65" aria-hidden="true" tabindex="-1"></a><span class="co"># increase accuracy: -mtree</span></span>
<span id="cb487-66"><a href="estimating-phylogenetic-trees.html#cb487-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-67"><a href="estimating-phylogenetic-trees.html#cb487-67" aria-hidden="true" tabindex="-1"></a>iqtree_mtree <span class="ot">&lt;-</span> iqtree_mtree_user</span>
<span id="cb487-68"><a href="estimating-phylogenetic-trees.html#cb487-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-69"><a href="estimating-phylogenetic-trees.html#cb487-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify sequence type as either of NULL (autodetect) DNA, AA, BIN, MORPH, CODON or NT2AA for DNA</span></span>
<span id="cb487-70"><a href="estimating-phylogenetic-trees.html#cb487-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-71"><a href="estimating-phylogenetic-trees.html#cb487-71" aria-hidden="true" tabindex="-1"></a>iqtree_st <span class="ot">&lt;-</span> iqtree_sequence_type_st_user</span>
<span id="cb487-72"><a href="estimating-phylogenetic-trees.html#cb487-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-73"><a href="estimating-phylogenetic-trees.html#cb487-73" aria-hidden="true" tabindex="-1"></a><span class="co"># UFBoot mode: -B 1000</span></span>
<span id="cb487-74"><a href="estimating-phylogenetic-trees.html#cb487-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-75"><a href="estimating-phylogenetic-trees.html#cb487-75" aria-hidden="true" tabindex="-1"></a>iqtree_UFBoot_B <span class="ot">&lt;-</span> iqtree_UFBoot_B_user</span>
<span id="cb487-76"><a href="estimating-phylogenetic-trees.html#cb487-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-77"><a href="estimating-phylogenetic-trees.html#cb487-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Red_impact_UFBoot</span></span>
<span id="cb487-78"><a href="estimating-phylogenetic-trees.html#cb487-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-79"><a href="estimating-phylogenetic-trees.html#cb487-79" aria-hidden="true" tabindex="-1"></a>iqtree_UFBoot_bnni <span class="ot">&lt;-</span> iqtree_UFBoot_bnni_user</span>
<span id="cb487-80"><a href="estimating-phylogenetic-trees.html#cb487-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-81"><a href="estimating-phylogenetic-trees.html#cb487-81" aria-hidden="true" tabindex="-1"></a><span class="co"># nonparametric bootstrap -b 100</span></span>
<span id="cb487-82"><a href="estimating-phylogenetic-trees.html#cb487-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-83"><a href="estimating-phylogenetic-trees.html#cb487-83" aria-hidden="true" tabindex="-1"></a>iqtree_nonpara_b <span class="ot">&lt;-</span> iqtree_nonpara_boot_b_user</span>
<span id="cb487-84"><a href="estimating-phylogenetic-trees.html#cb487-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-85"><a href="estimating-phylogenetic-trees.html#cb487-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Assessing branch supports with single branch tests SH-like approximate likelihood ratio test: -alrt 1000</span></span>
<span id="cb487-86"><a href="estimating-phylogenetic-trees.html#cb487-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-87"><a href="estimating-phylogenetic-trees.html#cb487-87" aria-hidden="true" tabindex="-1"></a>iqtree_alrt <span class="ot">&lt;-</span> iqtree_SHaLRT_alrt_user</span>
<span id="cb487-88"><a href="estimating-phylogenetic-trees.html#cb487-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-89"><a href="estimating-phylogenetic-trees.html#cb487-89" aria-hidden="true" tabindex="-1"></a><span class="co"># multicore -T AUTO -T 2</span></span>
<span id="cb487-90"><a href="estimating-phylogenetic-trees.html#cb487-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-91"><a href="estimating-phylogenetic-trees.html#cb487-91" aria-hidden="true" tabindex="-1"></a>iqtree_multicore_T <span class="ot">&lt;-</span> iqtree_multicore_T_user</span>
<span id="cb487-92"><a href="estimating-phylogenetic-trees.html#cb487-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-93"><a href="estimating-phylogenetic-trees.html#cb487-93" aria-hidden="true" tabindex="-1"></a><span class="co"># maxcores -ntmax </span></span>
<span id="cb487-94"><a href="estimating-phylogenetic-trees.html#cb487-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-95"><a href="estimating-phylogenetic-trees.html#cb487-95" aria-hidden="true" tabindex="-1"></a>iqtree_maxcores_ntmax <span class="ot">&lt;-</span> iqtree_maxcores_ntmax_user</span>
<span id="cb487-96"><a href="estimating-phylogenetic-trees.html#cb487-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-97"><a href="estimating-phylogenetic-trees.html#cb487-97" aria-hidden="true" tabindex="-1"></a><span class="do">##############       iqtree_partition_user</span></span>
<span id="cb487-98"><a href="estimating-phylogenetic-trees.html#cb487-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-99"><a href="estimating-phylogenetic-trees.html#cb487-99" aria-hidden="true" tabindex="-1"></a>iqtree_partition <span class="ot">&lt;-</span> iqtree_partition_user</span>
<span id="cb487-100"><a href="estimating-phylogenetic-trees.html#cb487-100" aria-hidden="true" tabindex="-1"></a>do_by_codon_pos <span class="ot">&lt;-</span> iqtree_partition_if_by_position_user</span>
<span id="cb487-101"><a href="estimating-phylogenetic-trees.html#cb487-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-102"><a href="estimating-phylogenetic-trees.html#cb487-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-103"><a href="estimating-phylogenetic-trees.html#cb487-103" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_partition)) {</span>
<span id="cb487-104"><a href="estimating-phylogenetic-trees.html#cb487-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-105"><a href="estimating-phylogenetic-trees.html#cb487-105" aria-hidden="true" tabindex="-1"></a>      iqtree_partition_matrix <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,iqtree_partition)</span>
<span id="cb487-106"><a href="estimating-phylogenetic-trees.html#cb487-106" aria-hidden="true" tabindex="-1"></a>             partitions_names <span class="ot">&lt;-</span> <span class="fu">rownames</span>(iqtree_partition_matrix)</span>
<span id="cb487-107"><a href="estimating-phylogenetic-trees.html#cb487-107" aria-hidden="true" tabindex="-1"></a>              type_partitions <span class="ot">&lt;-</span> iqtree_partition_matrix[,<span class="dv">1</span>]</span>
<span id="cb487-108"><a href="estimating-phylogenetic-trees.html#cb487-108" aria-hidden="true" tabindex="-1"></a>                   start_part <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(iqtree_partition_matrix[,<span class="dv">2</span>])</span>
<span id="cb487-109"><a href="estimating-phylogenetic-trees.html#cb487-109" aria-hidden="true" tabindex="-1"></a>                     end_part <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(iqtree_partition_matrix[,<span class="dv">3</span>])</span>
<span id="cb487-110"><a href="estimating-phylogenetic-trees.html#cb487-110" aria-hidden="true" tabindex="-1"></a>                   codon_part <span class="ot">&lt;-</span> iqtree_partition_matrix[,<span class="dv">4</span>]</span>
<span id="cb487-111"><a href="estimating-phylogenetic-trees.html#cb487-111" aria-hidden="true" tabindex="-1"></a>          iqtree_partition_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">partition_name =</span> partitions_names, <span class="at">type =</span> type_partitions, <span class="at">start =</span> start_part, <span class="at">end =</span> end_part, <span class="at">codon =</span> codon_part, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb487-112"><a href="estimating-phylogenetic-trees.html#cb487-112" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(iqtree_partition_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb487-113"><a href="estimating-phylogenetic-trees.html#cb487-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-114"><a href="estimating-phylogenetic-trees.html#cb487-114" aria-hidden="true" tabindex="-1"></a><span class="co"># output file name</span></span>
<span id="cb487-115"><a href="estimating-phylogenetic-trees.html#cb487-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-116"><a href="estimating-phylogenetic-trees.html#cb487-116" aria-hidden="true" tabindex="-1"></a>out_part_file <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;.*/&quot;</span>, <span class="st">&quot;&quot;</span>, input_files)</span>
<span id="cb487-117"><a href="estimating-phylogenetic-trees.html#cb487-117" aria-hidden="true" tabindex="-1"></a>out_part_file <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;[.]&quot;</span>, <span class="st">&quot;_&quot;</span>, out_part_file)</span>
<span id="cb487-118"><a href="estimating-phylogenetic-trees.html#cb487-118" aria-hidden="true" tabindex="-1"></a>out_part_file <span class="ot">&lt;-</span> <span class="fu">paste0</span>(out_part_file,<span class="st">&quot;_partition.txt&quot;</span>)</span>
<span id="cb487-119"><a href="estimating-phylogenetic-trees.html#cb487-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-120"><a href="estimating-phylogenetic-trees.html#cb487-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-121"><a href="estimating-phylogenetic-trees.html#cb487-121" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(iqtree_partition_df)) {</span>
<span id="cb487-122"><a href="estimating-phylogenetic-trees.html#cb487-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># i &lt;- 3</span></span>
<span id="cb487-123"><a href="estimating-phylogenetic-trees.html#cb487-123" aria-hidden="true" tabindex="-1"></a>   one_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(iqtree_partition_df<span class="sc">$</span>type[i], <span class="st">&quot;, &quot;</span>, iqtree_partition_df<span class="sc">$</span>partition_name[i], <span class="st">&quot; = &quot;</span>, </span>
<span id="cb487-124"><a href="estimating-phylogenetic-trees.html#cb487-124" aria-hidden="true" tabindex="-1"></a>                      iqtree_partition_df<span class="sc">$</span>start[i], <span class="st">&quot;-&quot;</span>, iqtree_partition_df<span class="sc">$</span>end[i])</span>
<span id="cb487-125"><a href="estimating-phylogenetic-trees.html#cb487-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-126"><a href="estimating-phylogenetic-trees.html#cb487-126" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(iqtree_partition_df<span class="sc">$</span>codon[i])) {</span>
<span id="cb487-127"><a href="estimating-phylogenetic-trees.html#cb487-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-128"><a href="estimating-phylogenetic-trees.html#cb487-128" aria-hidden="true" tabindex="-1"></a><span class="co"># do_by_codon_pos</span></span>
<span id="cb487-129"><a href="estimating-phylogenetic-trees.html#cb487-129" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(do_by_codon_pos) {</span>
<span id="cb487-130"><a href="estimating-phylogenetic-trees.html#cb487-130" aria-hidden="true" tabindex="-1"></a>              pos1_start <span class="ot">&lt;-</span> iqtree_partition_df<span class="sc">$</span>start[i]</span>
<span id="cb487-131"><a href="estimating-phylogenetic-trees.html#cb487-131" aria-hidden="true" tabindex="-1"></a>               pos1_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(iqtree_partition_df<span class="sc">$</span>partition_name[i],<span class="st">&quot;_pos1&quot;</span>)</span>
<span id="cb487-132"><a href="estimating-phylogenetic-trees.html#cb487-132" aria-hidden="true" tabindex="-1"></a>              pos2_start <span class="ot">&lt;-</span> iqtree_partition_df<span class="sc">$</span>start[i]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb487-133"><a href="estimating-phylogenetic-trees.html#cb487-133" aria-hidden="true" tabindex="-1"></a>               pos2_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(iqtree_partition_df<span class="sc">$</span>partition_name[i],<span class="st">&quot;_pos2&quot;</span>)</span>
<span id="cb487-134"><a href="estimating-phylogenetic-trees.html#cb487-134" aria-hidden="true" tabindex="-1"></a>              pos3_start <span class="ot">&lt;-</span> iqtree_partition_df<span class="sc">$</span>start[i]<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb487-135"><a href="estimating-phylogenetic-trees.html#cb487-135" aria-hidden="true" tabindex="-1"></a>               pos3_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(iqtree_partition_df<span class="sc">$</span>partition_name[i],<span class="st">&quot;_pos3&quot;</span>)</span>
<span id="cb487-136"><a href="estimating-phylogenetic-trees.html#cb487-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-137"><a href="estimating-phylogenetic-trees.html#cb487-137" aria-hidden="true" tabindex="-1"></a>   one_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(iqtree_partition_df<span class="sc">$</span>type[i], <span class="st">&quot;, &quot;</span>, pos1_name, <span class="st">&quot; = &quot;</span>, pos1_start, <span class="st">&quot;-&quot;</span>, iqtree_partition_df<span class="sc">$</span>end[i], <span class="st">&quot;</span><span class="sc">\\</span><span class="st">&quot;</span>, iqtree_partition_df<span class="sc">$</span>codon[i], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb487-138"><a href="estimating-phylogenetic-trees.html#cb487-138" aria-hidden="true" tabindex="-1"></a>                      iqtree_partition_df<span class="sc">$</span>type[i], <span class="st">&quot;, &quot;</span>, pos2_name, <span class="st">&quot; = &quot;</span>, pos2_start, <span class="st">&quot;-&quot;</span>, iqtree_partition_df<span class="sc">$</span>end[i], <span class="st">&quot;</span><span class="sc">\\</span><span class="st">&quot;</span>, iqtree_partition_df<span class="sc">$</span>codon[i], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb487-139"><a href="estimating-phylogenetic-trees.html#cb487-139" aria-hidden="true" tabindex="-1"></a>                      iqtree_partition_df<span class="sc">$</span>type[i], <span class="st">&quot;, &quot;</span>, pos3_name, <span class="st">&quot; = &quot;</span>, pos3_start, <span class="st">&quot;-&quot;</span>, iqtree_partition_df<span class="sc">$</span>end[i], <span class="st">&quot;</span><span class="sc">\\</span><span class="st">&quot;</span>, iqtree_partition_df<span class="sc">$</span>codon[i], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb487-140"><a href="estimating-phylogenetic-trees.html#cb487-140" aria-hidden="true" tabindex="-1"></a>                       }</span>
<span id="cb487-141"><a href="estimating-phylogenetic-trees.html#cb487-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-142"><a href="estimating-phylogenetic-trees.html#cb487-142" aria-hidden="true" tabindex="-1"></a>                                        }</span>
<span id="cb487-143"><a href="estimating-phylogenetic-trees.html#cb487-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-144"><a href="estimating-phylogenetic-trees.html#cb487-144" aria-hidden="true" tabindex="-1"></a><span class="co">#     one_line &lt;- paste0(one_line, &quot;\\&quot;, iqtree_partition_df$codon[i]) }</span></span>
<span id="cb487-145"><a href="estimating-phylogenetic-trees.html#cb487-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-146"><a href="estimating-phylogenetic-trees.html#cb487-146" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(one_line,<span class="at">file=</span>out_part_file,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">append=</span><span class="cn">TRUE</span>)</span>
<span id="cb487-147"><a href="estimating-phylogenetic-trees.html#cb487-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-148"><a href="estimating-phylogenetic-trees.html#cb487-148" aria-hidden="true" tabindex="-1"></a>                                      }</span>
<span id="cb487-149"><a href="estimating-phylogenetic-trees.html#cb487-149" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">rm</span>(i)</span>
<span id="cb487-150"><a href="estimating-phylogenetic-trees.html#cb487-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-151"><a href="estimating-phylogenetic-trees.html#cb487-151" aria-hidden="true" tabindex="-1"></a>iqtree_partition_files <span class="ot">&lt;-</span> out_part_file </span>
<span id="cb487-152"><a href="estimating-phylogenetic-trees.html#cb487-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-153"><a href="estimating-phylogenetic-trees.html#cb487-153" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb487-154"><a href="estimating-phylogenetic-trees.html#cb487-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-155"><a href="estimating-phylogenetic-trees.html#cb487-155" aria-hidden="true" tabindex="-1"></a>iqtree_partition_files <span class="ot">&lt;-</span> iqtree_partition_file_user</span>
<span id="cb487-156"><a href="estimating-phylogenetic-trees.html#cb487-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-157"><a href="estimating-phylogenetic-trees.html#cb487-157" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb487-158"><a href="estimating-phylogenetic-trees.html#cb487-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-159"><a href="estimating-phylogenetic-trees.html#cb487-159" aria-hidden="true" tabindex="-1"></a><span class="do">##############       chronogram_functions</span></span>
<span id="cb487-160"><a href="estimating-phylogenetic-trees.html#cb487-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-161"><a href="estimating-phylogenetic-trees.html#cb487-161" aria-hidden="true" tabindex="-1"></a>iqtree_chronogram_from_tree <span class="ot">&lt;-</span> iqtree_chronogram_from_tree_file_user</span>
<span id="cb487-162"><a href="estimating-phylogenetic-trees.html#cb487-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-163"><a href="estimating-phylogenetic-trees.html#cb487-163" aria-hidden="true" tabindex="-1"></a>iqtree_mrca_bounds <span class="ot">&lt;-</span> iqtree_chronogram_mrca_bounds_user</span>
<span id="cb487-164"><a href="estimating-phylogenetic-trees.html#cb487-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-165"><a href="estimating-phylogenetic-trees.html#cb487-165" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_mrca_bounds)) {</span>
<span id="cb487-166"><a href="estimating-phylogenetic-trees.html#cb487-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-167"><a href="estimating-phylogenetic-trees.html#cb487-167" aria-hidden="true" tabindex="-1"></a><span class="co"># name for DATE_FILE</span></span>
<span id="cb487-168"><a href="estimating-phylogenetic-trees.html#cb487-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-169"><a href="estimating-phylogenetic-trees.html#cb487-169" aria-hidden="true" tabindex="-1"></a>out_part_file <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;.*/&quot;</span>, <span class="st">&quot;&quot;</span>, input_files)</span>
<span id="cb487-170"><a href="estimating-phylogenetic-trees.html#cb487-170" aria-hidden="true" tabindex="-1"></a>out_part_file <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;[.]&quot;</span>, <span class="st">&quot;_&quot;</span>, out_part_file)</span>
<span id="cb487-171"><a href="estimating-phylogenetic-trees.html#cb487-171" aria-hidden="true" tabindex="-1"></a>out_date_file <span class="ot">&lt;-</span> <span class="fu">paste0</span>(out_part_file,<span class="st">&quot;_dates.txt&quot;</span>)</span>
<span id="cb487-172"><a href="estimating-phylogenetic-trees.html#cb487-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-173"><a href="estimating-phylogenetic-trees.html#cb487-173" aria-hidden="true" tabindex="-1"></a><span class="co"># build DATE_FILE</span></span>
<span id="cb487-174"><a href="estimating-phylogenetic-trees.html#cb487-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-175"><a href="estimating-phylogenetic-trees.html#cb487-175" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">length</span>(iqtree_mrca_bounds)</span>
<span id="cb487-176"><a href="estimating-phylogenetic-trees.html#cb487-176" aria-hidden="true" tabindex="-1"></a>n_constraints <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="at">by=</span><span class="dv">2</span>, <span class="at">to=</span>n_total)</span>
<span id="cb487-177"><a href="estimating-phylogenetic-trees.html#cb487-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-178"><a href="estimating-phylogenetic-trees.html#cb487-178" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> n_constraints) {</span>
<span id="cb487-179"><a href="estimating-phylogenetic-trees.html#cb487-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-180"><a href="estimating-phylogenetic-trees.html#cb487-180" aria-hidden="true" tabindex="-1"></a><span class="co"># i &lt;- 1</span></span>
<span id="cb487-181"><a href="estimating-phylogenetic-trees.html#cb487-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-182"><a href="estimating-phylogenetic-trees.html#cb487-182" aria-hidden="true" tabindex="-1"></a>   taxa_part <span class="ot">&lt;-</span> <span class="fu">paste0</span>(iqtree_mrca_bounds[[i]], <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb487-183"><a href="estimating-phylogenetic-trees.html#cb487-183" aria-hidden="true" tabindex="-1"></a>   date_part <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;-&quot;</span>, iqtree_mrca_bounds[[i<span class="sc">+</span><span class="dv">1</span>]])</span>
<span id="cb487-184"><a href="estimating-phylogenetic-trees.html#cb487-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-185"><a href="estimating-phylogenetic-trees.html#cb487-185" aria-hidden="true" tabindex="-1"></a>   one_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(taxa_part, <span class="st">&quot; &quot;</span>, date_part)</span>
<span id="cb487-186"><a href="estimating-phylogenetic-trees.html#cb487-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-187"><a href="estimating-phylogenetic-trees.html#cb487-187" aria-hidden="true" tabindex="-1"></a><span class="co">#     one_line &lt;- paste0(one_line, &quot;\\&quot;, iqtree_partition_df$codon[i]) }</span></span>
<span id="cb487-188"><a href="estimating-phylogenetic-trees.html#cb487-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-189"><a href="estimating-phylogenetic-trees.html#cb487-189" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(one_line,<span class="at">file=</span>out_date_file,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">append=</span><span class="cn">TRUE</span>)</span>
<span id="cb487-190"><a href="estimating-phylogenetic-trees.html#cb487-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-191"><a href="estimating-phylogenetic-trees.html#cb487-191" aria-hidden="true" tabindex="-1"></a>                                      }</span>
<span id="cb487-192"><a href="estimating-phylogenetic-trees.html#cb487-192" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">rm</span>(i)</span>
<span id="cb487-193"><a href="estimating-phylogenetic-trees.html#cb487-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-194"><a href="estimating-phylogenetic-trees.html#cb487-194" aria-hidden="true" tabindex="-1"></a>iqtree_date_files <span class="ot">&lt;-</span> out_date_file </span>
<span id="cb487-195"><a href="estimating-phylogenetic-trees.html#cb487-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-196"><a href="estimating-phylogenetic-trees.html#cb487-196" aria-hidden="true" tabindex="-1"></a>                                 } <span class="cf">else</span> {</span>
<span id="cb487-197"><a href="estimating-phylogenetic-trees.html#cb487-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-198"><a href="estimating-phylogenetic-trees.html#cb487-198" aria-hidden="true" tabindex="-1"></a>iqtree_date_files <span class="ot">&lt;-</span> iqtree_date_file_user</span>
<span id="cb487-199"><a href="estimating-phylogenetic-trees.html#cb487-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-200"><a href="estimating-phylogenetic-trees.html#cb487-200" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb487-201"><a href="estimating-phylogenetic-trees.html#cb487-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-202"><a href="estimating-phylogenetic-trees.html#cb487-202" aria-hidden="true" tabindex="-1"></a><span class="co"># iq pass paramters</span></span>
<span id="cb487-203"><a href="estimating-phylogenetic-trees.html#cb487-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-204"><a href="estimating-phylogenetic-trees.html#cb487-204" aria-hidden="true" tabindex="-1"></a>iqtree_pass <span class="ot">&lt;-</span> iqtree_pass_parameters_user</span>
<span id="cb487-205"><a href="estimating-phylogenetic-trees.html#cb487-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-206"><a href="estimating-phylogenetic-trees.html#cb487-206" aria-hidden="true" tabindex="-1"></a><span class="co"># get work directory to go back</span></span>
<span id="cb487-207"><a href="estimating-phylogenetic-trees.html#cb487-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-208"><a href="estimating-phylogenetic-trees.html#cb487-208" aria-hidden="true" tabindex="-1"></a>master_wd_directory <span class="ot">&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb487-209"><a href="estimating-phylogenetic-trees.html#cb487-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-210"><a href="estimating-phylogenetic-trees.html#cb487-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-211"><a href="estimating-phylogenetic-trees.html#cb487-211" aria-hidden="true" tabindex="-1"></a><span class="do">## get iqtree path</span></span>
<span id="cb487-212"><a href="estimating-phylogenetic-trees.html#cb487-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-213"><a href="estimating-phylogenetic-trees.html#cb487-213" aria-hidden="true" tabindex="-1"></a>path_of_iqtree <span class="ot">&lt;-</span> <span class="fu">paste0</span>(iqtree_bin_location)</span>
<span id="cb487-214"><a href="estimating-phylogenetic-trees.html#cb487-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-215"><a href="estimating-phylogenetic-trees.html#cb487-215" aria-hidden="true" tabindex="-1"></a><span class="do">######     prepare iqtree commands</span></span>
<span id="cb487-216"><a href="estimating-phylogenetic-trees.html#cb487-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-217"><a href="estimating-phylogenetic-trees.html#cb487-217" aria-hidden="true" tabindex="-1"></a>list_iqtree_scripts <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb487-218"><a href="estimating-phylogenetic-trees.html#cb487-218" aria-hidden="true" tabindex="-1"></a>name_of_analyses_iqtree <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb487-219"><a href="estimating-phylogenetic-trees.html#cb487-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-220"><a href="estimating-phylogenetic-trees.html#cb487-220" aria-hidden="true" tabindex="-1"></a>counter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb487-221"><a href="estimating-phylogenetic-trees.html#cb487-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-222"><a href="estimating-phylogenetic-trees.html#cb487-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-223"><a href="estimating-phylogenetic-trees.html#cb487-223" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(input_files)) {</span>
<span id="cb487-224"><a href="estimating-phylogenetic-trees.html#cb487-224" aria-hidden="true" tabindex="-1"></a>      <span class="co"># i &lt;- 1</span></span>
<span id="cb487-225"><a href="estimating-phylogenetic-trees.html#cb487-225" aria-hidden="true" tabindex="-1"></a>    one_alignment_file <span class="ot">&lt;-</span> input_files[i]</span>
<span id="cb487-226"><a href="estimating-phylogenetic-trees.html#cb487-226" aria-hidden="true" tabindex="-1"></a>    counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-227"><a href="estimating-phylogenetic-trees.html#cb487-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-228"><a href="estimating-phylogenetic-trees.html#cb487-228" aria-hidden="true" tabindex="-1"></a><span class="co"># simplify names</span></span>
<span id="cb487-229"><a href="estimating-phylogenetic-trees.html#cb487-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-230"><a href="estimating-phylogenetic-trees.html#cb487-230" aria-hidden="true" tabindex="-1"></a>one_input_file <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;.*/&quot;</span>, <span class="st">&quot;&quot;</span>, one_alignment_file)</span>
<span id="cb487-231"><a href="estimating-phylogenetic-trees.html#cb487-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-232"><a href="estimating-phylogenetic-trees.html#cb487-232" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare commands</span></span>
<span id="cb487-233"><a href="estimating-phylogenetic-trees.html#cb487-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-234"><a href="estimating-phylogenetic-trees.html#cb487-234" aria-hidden="true" tabindex="-1"></a>line_iqtree <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;iqtree2  -s &quot;</span>, one_input_file, <span class="st">&quot;  &quot;</span>)</span>
<span id="cb487-235"><a href="estimating-phylogenetic-trees.html#cb487-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-236"><a href="estimating-phylogenetic-trees.html#cb487-236" aria-hidden="true" tabindex="-1"></a><span class="co"># list of iqtre parameters</span></span>
<span id="cb487-237"><a href="estimating-phylogenetic-trees.html#cb487-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-238"><a href="estimating-phylogenetic-trees.html#cb487-238" aria-hidden="true" tabindex="-1"></a>list_of_iqtree <span class="ot">&lt;-</span> <span class="fu">c</span>(line_iqtree)</span>
<span id="cb487-239"><a href="estimating-phylogenetic-trees.html#cb487-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-240"><a href="estimating-phylogenetic-trees.html#cb487-240" aria-hidden="true" tabindex="-1"></a>counter_2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb487-241"><a href="estimating-phylogenetic-trees.html#cb487-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-242"><a href="estimating-phylogenetic-trees.html#cb487-242" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify sequence type as either of NULL (autodetect) DNA, AA, BIN, MORPH, CODON or NT2AA for DNA</span></span>
<span id="cb487-243"><a href="estimating-phylogenetic-trees.html#cb487-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-244"><a href="estimating-phylogenetic-trees.html#cb487-244" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_st)) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-245"><a href="estimating-phylogenetic-trees.html#cb487-245" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -st  &quot;</span>, iqtree_st, <span class="st">&quot;  &quot;</span>) </span>
<span id="cb487-246"><a href="estimating-phylogenetic-trees.html#cb487-246" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-247"><a href="estimating-phylogenetic-trees.html#cb487-247" aria-hidden="true" tabindex="-1"></a>                     }</span>
<span id="cb487-248"><a href="estimating-phylogenetic-trees.html#cb487-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-249"><a href="estimating-phylogenetic-trees.html#cb487-249" aria-hidden="true" tabindex="-1"></a><span class="co"># add prefi: --prefix</span></span>
<span id="cb487-250"><a href="estimating-phylogenetic-trees.html#cb487-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-251"><a href="estimating-phylogenetic-trees.html#cb487-251" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_prefix)) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-252"><a href="estimating-phylogenetic-trees.html#cb487-252" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  --prefix  &quot;</span>, iqtree_prefix, <span class="st">&quot;  &quot;</span>) </span>
<span id="cb487-253"><a href="estimating-phylogenetic-trees.html#cb487-253" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-254"><a href="estimating-phylogenetic-trees.html#cb487-254" aria-hidden="true" tabindex="-1"></a>                     }</span>
<span id="cb487-255"><a href="estimating-phylogenetic-trees.html#cb487-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-256"><a href="estimating-phylogenetic-trees.html#cb487-256" aria-hidden="true" tabindex="-1"></a><span class="co"># add model: -m</span></span>
<span id="cb487-257"><a href="estimating-phylogenetic-trees.html#cb487-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-258"><a href="estimating-phylogenetic-trees.html#cb487-258" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_model)) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-259"><a href="estimating-phylogenetic-trees.html#cb487-259" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -m  &quot;</span>, iqtree_model, <span class="st">&quot;  &quot;</span>) </span>
<span id="cb487-260"><a href="estimating-phylogenetic-trees.html#cb487-260" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-261"><a href="estimating-phylogenetic-trees.html#cb487-261" aria-hidden="true" tabindex="-1"></a>                     }</span>
<span id="cb487-262"><a href="estimating-phylogenetic-trees.html#cb487-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-263"><a href="estimating-phylogenetic-trees.html#cb487-263" aria-hidden="true" tabindex="-1"></a><span class="co"># increase accuracy: -mtree</span></span>
<span id="cb487-264"><a href="estimating-phylogenetic-trees.html#cb487-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-265"><a href="estimating-phylogenetic-trees.html#cb487-265" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(iqtree_mtree) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-266"><a href="estimating-phylogenetic-trees.html#cb487-266" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -mtree  &quot;</span>) </span>
<span id="cb487-267"><a href="estimating-phylogenetic-trees.html#cb487-267" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-268"><a href="estimating-phylogenetic-trees.html#cb487-268" aria-hidden="true" tabindex="-1"></a>                     }</span>
<span id="cb487-269"><a href="estimating-phylogenetic-trees.html#cb487-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-270"><a href="estimating-phylogenetic-trees.html#cb487-270" aria-hidden="true" tabindex="-1"></a><span class="co"># overwrite all previous output: -redo</span></span>
<span id="cb487-271"><a href="estimating-phylogenetic-trees.html#cb487-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-272"><a href="estimating-phylogenetic-trees.html#cb487-272" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(iqtree_redo) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-273"><a href="estimating-phylogenetic-trees.html#cb487-273" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -redo  &quot;</span>) </span>
<span id="cb487-274"><a href="estimating-phylogenetic-trees.html#cb487-274" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-275"><a href="estimating-phylogenetic-trees.html#cb487-275" aria-hidden="true" tabindex="-1"></a>                     }</span>
<span id="cb487-276"><a href="estimating-phylogenetic-trees.html#cb487-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-277"><a href="estimating-phylogenetic-trees.html#cb487-277" aria-hidden="true" tabindex="-1"></a><span class="co"># add partition</span></span>
<span id="cb487-278"><a href="estimating-phylogenetic-trees.html#cb487-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-279"><a href="estimating-phylogenetic-trees.html#cb487-279" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_partition_files)) {counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-280"><a href="estimating-phylogenetic-trees.html#cb487-280" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -p  &quot;</span>, iqtree_partition_files[i]) </span>
<span id="cb487-281"><a href="estimating-phylogenetic-trees.html#cb487-281" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-282"><a href="estimating-phylogenetic-trees.html#cb487-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-283"><a href="estimating-phylogenetic-trees.html#cb487-283" aria-hidden="true" tabindex="-1"></a>                              }</span>
<span id="cb487-284"><a href="estimating-phylogenetic-trees.html#cb487-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-285"><a href="estimating-phylogenetic-trees.html#cb487-285" aria-hidden="true" tabindex="-1"></a><span class="co"># add DATE_FILE</span></span>
<span id="cb487-286"><a href="estimating-phylogenetic-trees.html#cb487-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-287"><a href="estimating-phylogenetic-trees.html#cb487-287" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.null</span>(iqtree_chronogram_from_tree)) {</span>
<span id="cb487-288"><a href="estimating-phylogenetic-trees.html#cb487-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-289"><a href="estimating-phylogenetic-trees.html#cb487-289" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_date_files)) {counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-290"><a href="estimating-phylogenetic-trees.html#cb487-290" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  --date  &quot;</span>, iqtree_date_files[i], <span class="st">&#39; --date-tip 0&#39;</span>) </span>
<span id="cb487-291"><a href="estimating-phylogenetic-trees.html#cb487-291" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-292"><a href="estimating-phylogenetic-trees.html#cb487-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-293"><a href="estimating-phylogenetic-trees.html#cb487-293" aria-hidden="true" tabindex="-1"></a>                              }</span>
<span id="cb487-294"><a href="estimating-phylogenetic-trees.html#cb487-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-295"><a href="estimating-phylogenetic-trees.html#cb487-295" aria-hidden="true" tabindex="-1"></a>                                        }</span>
<span id="cb487-296"><a href="estimating-phylogenetic-trees.html#cb487-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-297"><a href="estimating-phylogenetic-trees.html#cb487-297" aria-hidden="true" tabindex="-1"></a><span class="co"># make chronogram from tree</span></span>
<span id="cb487-298"><a href="estimating-phylogenetic-trees.html#cb487-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-299"><a href="estimating-phylogenetic-trees.html#cb487-299" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_chronogram_from_tree)) {counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-300"><a href="estimating-phylogenetic-trees.html#cb487-300" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  --date  &quot;</span>, iqtree_date_files[i], <span class="st">&#39; --date-tip 0&#39;</span>, <span class="st">&quot; -te &quot;</span>, iqtree_chronogram_from_tree) </span>
<span id="cb487-301"><a href="estimating-phylogenetic-trees.html#cb487-301" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-302"><a href="estimating-phylogenetic-trees.html#cb487-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-303"><a href="estimating-phylogenetic-trees.html#cb487-303" aria-hidden="true" tabindex="-1"></a>                              }</span>
<span id="cb487-304"><a href="estimating-phylogenetic-trees.html#cb487-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-305"><a href="estimating-phylogenetic-trees.html#cb487-305" aria-hidden="true" tabindex="-1"></a><span class="do">##### ultra fast bootstrap</span></span>
<span id="cb487-306"><a href="estimating-phylogenetic-trees.html#cb487-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-307"><a href="estimating-phylogenetic-trees.html#cb487-307" aria-hidden="true" tabindex="-1"></a><span class="co"># UFBoot mode: -B 1000</span></span>
<span id="cb487-308"><a href="estimating-phylogenetic-trees.html#cb487-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-309"><a href="estimating-phylogenetic-trees.html#cb487-309" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_UFBoot_B)) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-310"><a href="estimating-phylogenetic-trees.html#cb487-310" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -B &quot;</span>, iqtree_UFBoot_B, <span class="st">&quot;  &quot;</span>) </span>
<span id="cb487-311"><a href="estimating-phylogenetic-trees.html#cb487-311" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-312"><a href="estimating-phylogenetic-trees.html#cb487-312" aria-hidden="true" tabindex="-1"></a>                     }</span>
<span id="cb487-313"><a href="estimating-phylogenetic-trees.html#cb487-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-314"><a href="estimating-phylogenetic-trees.html#cb487-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Red_impact_UFBoot</span></span>
<span id="cb487-315"><a href="estimating-phylogenetic-trees.html#cb487-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-316"><a href="estimating-phylogenetic-trees.html#cb487-316" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_UFBoot_B)) {</span>
<span id="cb487-317"><a href="estimating-phylogenetic-trees.html#cb487-317" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span>(iqtree_UFBoot_bnni) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-318"><a href="estimating-phylogenetic-trees.html#cb487-318" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -bnni  &quot;</span>) </span>
<span id="cb487-319"><a href="estimating-phylogenetic-trees.html#cb487-319" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-320"><a href="estimating-phylogenetic-trees.html#cb487-320" aria-hidden="true" tabindex="-1"></a>                                }</span>
<span id="cb487-321"><a href="estimating-phylogenetic-trees.html#cb487-321" aria-hidden="true" tabindex="-1"></a>                              }</span>
<span id="cb487-322"><a href="estimating-phylogenetic-trees.html#cb487-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-323"><a href="estimating-phylogenetic-trees.html#cb487-323" aria-hidden="true" tabindex="-1"></a><span class="do">##### non-parameteric bootstrap</span></span>
<span id="cb487-324"><a href="estimating-phylogenetic-trees.html#cb487-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-325"><a href="estimating-phylogenetic-trees.html#cb487-325" aria-hidden="true" tabindex="-1"></a><span class="co"># nonparametric bootstrap -b 100</span></span>
<span id="cb487-326"><a href="estimating-phylogenetic-trees.html#cb487-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-327"><a href="estimating-phylogenetic-trees.html#cb487-327" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_nonpara_b)) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-328"><a href="estimating-phylogenetic-trees.html#cb487-328" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -b &quot;</span>, iqtree_nonpara_b, <span class="st">&quot;  &quot;</span>) </span>
<span id="cb487-329"><a href="estimating-phylogenetic-trees.html#cb487-329" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-330"><a href="estimating-phylogenetic-trees.html#cb487-330" aria-hidden="true" tabindex="-1"></a>                     }</span>
<span id="cb487-331"><a href="estimating-phylogenetic-trees.html#cb487-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-332"><a href="estimating-phylogenetic-trees.html#cb487-332" aria-hidden="true" tabindex="-1"></a><span class="do">##### SH-like approximate likelihood ratio test</span></span>
<span id="cb487-333"><a href="estimating-phylogenetic-trees.html#cb487-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-334"><a href="estimating-phylogenetic-trees.html#cb487-334" aria-hidden="true" tabindex="-1"></a><span class="co"># Assessing branch supports with single branch tests : -alrt 1000</span></span>
<span id="cb487-335"><a href="estimating-phylogenetic-trees.html#cb487-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-336"><a href="estimating-phylogenetic-trees.html#cb487-336" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_alrt)) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-337"><a href="estimating-phylogenetic-trees.html#cb487-337" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -alrt &quot;</span>, iqtree_alrt, <span class="st">&quot;  &quot;</span>) </span>
<span id="cb487-338"><a href="estimating-phylogenetic-trees.html#cb487-338" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-339"><a href="estimating-phylogenetic-trees.html#cb487-339" aria-hidden="true" tabindex="-1"></a>                     }</span>
<span id="cb487-340"><a href="estimating-phylogenetic-trees.html#cb487-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-341"><a href="estimating-phylogenetic-trees.html#cb487-341" aria-hidden="true" tabindex="-1"></a><span class="do">### multicore</span></span>
<span id="cb487-342"><a href="estimating-phylogenetic-trees.html#cb487-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-343"><a href="estimating-phylogenetic-trees.html#cb487-343" aria-hidden="true" tabindex="-1"></a><span class="co"># multicore -T AUTO -T 2</span></span>
<span id="cb487-344"><a href="estimating-phylogenetic-trees.html#cb487-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-345"><a href="estimating-phylogenetic-trees.html#cb487-345" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_multicore_T)) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-346"><a href="estimating-phylogenetic-trees.html#cb487-346" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -T &quot;</span>, iqtree_multicore_T, <span class="st">&quot;  &quot;</span>) </span>
<span id="cb487-347"><a href="estimating-phylogenetic-trees.html#cb487-347" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-348"><a href="estimating-phylogenetic-trees.html#cb487-348" aria-hidden="true" tabindex="-1"></a>                     }</span>
<span id="cb487-349"><a href="estimating-phylogenetic-trees.html#cb487-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-350"><a href="estimating-phylogenetic-trees.html#cb487-350" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_multicore_T)) {</span>
<span id="cb487-351"><a href="estimating-phylogenetic-trees.html#cb487-351" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_maxcores_ntmax)) {</span>
<span id="cb487-352"><a href="estimating-phylogenetic-trees.html#cb487-352" aria-hidden="true" tabindex="-1"></a>                                    counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-353"><a href="estimating-phylogenetic-trees.html#cb487-353" aria-hidden="true" tabindex="-1"></a>                                     out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;  -ntmax &quot;</span>, iqtree_maxcores_ntmax, <span class="st">&quot;  &quot;</span>) </span>
<span id="cb487-354"><a href="estimating-phylogenetic-trees.html#cb487-354" aria-hidden="true" tabindex="-1"></a>                    list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-355"><a href="estimating-phylogenetic-trees.html#cb487-355" aria-hidden="true" tabindex="-1"></a>                                              }</span>
<span id="cb487-356"><a href="estimating-phylogenetic-trees.html#cb487-356" aria-hidden="true" tabindex="-1"></a>                                  }</span>
<span id="cb487-357"><a href="estimating-phylogenetic-trees.html#cb487-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-358"><a href="estimating-phylogenetic-trees.html#cb487-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-359"><a href="estimating-phylogenetic-trees.html#cb487-359" aria-hidden="true" tabindex="-1"></a><span class="do">### iqtree pass paramters</span></span>
<span id="cb487-360"><a href="estimating-phylogenetic-trees.html#cb487-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-361"><a href="estimating-phylogenetic-trees.html#cb487-361" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(iqtree_pass)) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-362"><a href="estimating-phylogenetic-trees.html#cb487-362" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot; &quot;</span>, iqtree_pass, <span class="st">&quot;  &quot;</span>) </span>
<span id="cb487-363"><a href="estimating-phylogenetic-trees.html#cb487-363" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-364"><a href="estimating-phylogenetic-trees.html#cb487-364" aria-hidden="true" tabindex="-1"></a>                          }</span>
<span id="cb487-365"><a href="estimating-phylogenetic-trees.html#cb487-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-366"><a href="estimating-phylogenetic-trees.html#cb487-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-367"><a href="estimating-phylogenetic-trees.html#cb487-367" aria-hidden="true" tabindex="-1"></a><span class="co"># quiet</span></span>
<span id="cb487-368"><a href="estimating-phylogenetic-trees.html#cb487-368" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb487-369"><a href="estimating-phylogenetic-trees.html#cb487-369" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(iqtree_quiet) { counter_2 <span class="ot">&lt;-</span> counter_2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb487-370"><a href="estimating-phylogenetic-trees.html#cb487-370" aria-hidden="true" tabindex="-1"></a>                   out_line <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot; -quiet  &quot;</span>) </span>
<span id="cb487-371"><a href="estimating-phylogenetic-trees.html#cb487-371" aria-hidden="true" tabindex="-1"></a>   list_of_iqtree[counter_2] <span class="ot">&lt;-</span> out_line</span>
<span id="cb487-372"><a href="estimating-phylogenetic-trees.html#cb487-372" aria-hidden="true" tabindex="-1"></a>                          }</span>
<span id="cb487-373"><a href="estimating-phylogenetic-trees.html#cb487-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-374"><a href="estimating-phylogenetic-trees.html#cb487-374" aria-hidden="true" tabindex="-1"></a><span class="do">### all lines together</span></span>
<span id="cb487-375"><a href="estimating-phylogenetic-trees.html#cb487-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-376"><a href="estimating-phylogenetic-trees.html#cb487-376" aria-hidden="true" tabindex="-1"></a>iqtree_out <span class="ot">&lt;-</span> <span class="fu">paste0</span>(list_of_iqtree, <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb487-377"><a href="estimating-phylogenetic-trees.html#cb487-377" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(iqtree_out)</span>
<span id="cb487-378"><a href="estimating-phylogenetic-trees.html#cb487-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-379"><a href="estimating-phylogenetic-trees.html#cb487-379" aria-hidden="true" tabindex="-1"></a>  list_iqtree_scripts[[counter]] <span class="ot">&lt;-</span> iqtree_out</span>
<span id="cb487-380"><a href="estimating-phylogenetic-trees.html#cb487-380" aria-hidden="true" tabindex="-1"></a>name_of_analyses_iqtree[counter] <span class="ot">&lt;-</span> one_input_file</span>
<span id="cb487-381"><a href="estimating-phylogenetic-trees.html#cb487-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-382"><a href="estimating-phylogenetic-trees.html#cb487-382" aria-hidden="true" tabindex="-1"></a>                                  }</span>
<span id="cb487-383"><a href="estimating-phylogenetic-trees.html#cb487-383" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rm</span>(i)</span>
<span id="cb487-384"><a href="estimating-phylogenetic-trees.html#cb487-384" aria-hidden="true" tabindex="-1"></a>                       <span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">&quot;counter&quot;</span>)){<span class="fu">rm</span>(counter)}</span>
<span id="cb487-385"><a href="estimating-phylogenetic-trees.html#cb487-385" aria-hidden="true" tabindex="-1"></a>                       <span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">&quot;counter_2&quot;</span>)){<span class="fu">rm</span>(counter_2)}</span>
<span id="cb487-386"><a href="estimating-phylogenetic-trees.html#cb487-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-387"><a href="estimating-phylogenetic-trees.html#cb487-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-388"><a href="estimating-phylogenetic-trees.html#cb487-388" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################################################################</span></span>
<span id="cb487-389"><a href="estimating-phylogenetic-trees.html#cb487-389" aria-hidden="true" tabindex="-1"></a><span class="do">#### open and run iqtree from R</span></span>
<span id="cb487-390"><a href="estimating-phylogenetic-trees.html#cb487-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-391"><a href="estimating-phylogenetic-trees.html#cb487-391" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector to export path -- export PATH=/opt/local/bin:/opt/local/sbin:$PATH</span></span>
<span id="cb487-392"><a href="estimating-phylogenetic-trees.html#cb487-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-393"><a href="estimating-phylogenetic-trees.html#cb487-393" aria-hidden="true" tabindex="-1"></a>export_path_iqtree_bins <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(iqtree_bin_location)</span>
<span id="cb487-394"><a href="estimating-phylogenetic-trees.html#cb487-394" aria-hidden="true" tabindex="-1"></a>export_path_iqtree_vector <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;export PATH=&quot;</span>,export_path_iqtree_bins,<span class="st">&quot;:$PATH&quot;</span>)</span>
<span id="cb487-395"><a href="estimating-phylogenetic-trees.html#cb487-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-396"><a href="estimating-phylogenetic-trees.html#cb487-396" aria-hidden="true" tabindex="-1"></a><span class="do">## iqtree execute function</span></span>
<span id="cb487-397"><a href="estimating-phylogenetic-trees.html#cb487-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-398"><a href="estimating-phylogenetic-trees.html#cb487-398" aria-hidden="true" tabindex="-1"></a>execute_iqtree_terminal <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">export_path_section =</span> export_path_iqtree_vector, </span>
<span id="cb487-399"><a href="estimating-phylogenetic-trees.html#cb487-399" aria-hidden="true" tabindex="-1"></a>                                   iqtree_command, </span>
<span id="cb487-400"><a href="estimating-phylogenetic-trees.html#cb487-400" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">intern =</span> <span class="cn">FALSE</span>, </span>
<span id="cb487-401"><a href="estimating-phylogenetic-trees.html#cb487-401" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">wait =</span> <span class="cn">FALSE</span>){</span>
<span id="cb487-402"><a href="estimating-phylogenetic-trees.html#cb487-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-403"><a href="estimating-phylogenetic-trees.html#cb487-403" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="fu">paste0</span>(export_path_section, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb487-404"><a href="estimating-phylogenetic-trees.html#cb487-404" aria-hidden="true" tabindex="-1"></a>                    iqtree_command, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>), </span>
<span id="cb487-405"><a href="estimating-phylogenetic-trees.html#cb487-405" aria-hidden="true" tabindex="-1"></a>                                <span class="at">intern =</span> intern, </span>
<span id="cb487-406"><a href="estimating-phylogenetic-trees.html#cb487-406" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">wait =</span> wait)</span>
<span id="cb487-407"><a href="estimating-phylogenetic-trees.html#cb487-407" aria-hidden="true" tabindex="-1"></a>                                                 }</span>
<span id="cb487-408"><a href="estimating-phylogenetic-trees.html#cb487-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-409"><a href="estimating-phylogenetic-trees.html#cb487-409" aria-hidden="true" tabindex="-1"></a><span class="do">## run list elements with iqtree commands</span></span>
<span id="cb487-410"><a href="estimating-phylogenetic-trees.html#cb487-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-411"><a href="estimating-phylogenetic-trees.html#cb487-411" aria-hidden="true" tabindex="-1"></a><span class="do">## serial</span></span>
<span id="cb487-412"><a href="estimating-phylogenetic-trees.html#cb487-412" aria-hidden="true" tabindex="-1"></a><span class="co"># run_iqtree &lt;- &quot;serial&quot;</span></span>
<span id="cb487-413"><a href="estimating-phylogenetic-trees.html#cb487-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-414"><a href="estimating-phylogenetic-trees.html#cb487-414" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(run_iqtree <span class="sc">==</span> <span class="st">&quot;serial&quot;</span>) {</span>
<span id="cb487-415"><a href="estimating-phylogenetic-trees.html#cb487-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-416"><a href="estimating-phylogenetic-trees.html#cb487-416" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">****** started serial analisis of: &quot;</span>, <span class="fu">length</span>(list_iqtree_scripts), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span> )</span>
<span id="cb487-417"><a href="estimating-phylogenetic-trees.html#cb487-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-418"><a href="estimating-phylogenetic-trees.html#cb487-418" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(list_iqtree_scripts)) {</span>
<span id="cb487-419"><a href="estimating-phylogenetic-trees.html#cb487-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-420"><a href="estimating-phylogenetic-trees.html#cb487-420" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;***** iqtree analysis name: &quot;</span>,name_of_analyses_iqtree[j], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb487-421"><a href="estimating-phylogenetic-trees.html#cb487-421" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;***** iqtree commands: &quot;</span>, list_iqtree_scripts[[j]], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb487-422"><a href="estimating-phylogenetic-trees.html#cb487-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-423"><a href="estimating-phylogenetic-trees.html#cb487-423" aria-hidden="true" tabindex="-1"></a><span class="fu">execute_iqtree_terminal</span>(<span class="at">export_path_section =</span> export_path_iqtree_vector, </span>
<span id="cb487-424"><a href="estimating-phylogenetic-trees.html#cb487-424" aria-hidden="true" tabindex="-1"></a>                             <span class="at">iqtree_command =</span>  list_iqtree_scripts[[j]], </span>
<span id="cb487-425"><a href="estimating-phylogenetic-trees.html#cb487-425" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">intern =</span> <span class="cn">FALSE</span>, </span>
<span id="cb487-426"><a href="estimating-phylogenetic-trees.html#cb487-426" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">wait =</span> <span class="cn">TRUE</span>)</span>
<span id="cb487-427"><a href="estimating-phylogenetic-trees.html#cb487-427" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;***** DONE ***** </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb487-428"><a href="estimating-phylogenetic-trees.html#cb487-428" aria-hidden="true" tabindex="-1"></a>                                        }</span>
<span id="cb487-429"><a href="estimating-phylogenetic-trees.html#cb487-429" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">rm</span>(j)</span>
<span id="cb487-430"><a href="estimating-phylogenetic-trees.html#cb487-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-431"><a href="estimating-phylogenetic-trees.html#cb487-431" aria-hidden="true" tabindex="-1"></a>                           }</span>
<span id="cb487-432"><a href="estimating-phylogenetic-trees.html#cb487-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-433"><a href="estimating-phylogenetic-trees.html#cb487-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-434"><a href="estimating-phylogenetic-trees.html#cb487-434" aria-hidden="true" tabindex="-1"></a><span class="do">### parallel</span></span>
<span id="cb487-435"><a href="estimating-phylogenetic-trees.html#cb487-435" aria-hidden="true" tabindex="-1"></a><span class="co"># run_iqtree &lt;- &quot;parallel&quot;</span></span>
<span id="cb487-436"><a href="estimating-phylogenetic-trees.html#cb487-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-437"><a href="estimating-phylogenetic-trees.html#cb487-437" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(run_iqtree <span class="sc">==</span> <span class="st">&quot;parallel&quot;</span>) {</span>
<span id="cb487-438"><a href="estimating-phylogenetic-trees.html#cb487-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-439"><a href="estimating-phylogenetic-trees.html#cb487-439" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">****** started parallel analisis of: &quot;</span>, <span class="fu">length</span>(list_iqtree_scripts), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span> )</span>
<span id="cb487-440"><a href="estimating-phylogenetic-trees.html#cb487-440" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(name_of_analyses_iqtree)</span>
<span id="cb487-441"><a href="estimating-phylogenetic-trees.html#cb487-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-442"><a href="estimating-phylogenetic-trees.html#cb487-442" aria-hidden="true" tabindex="-1"></a>ncores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb487-443"><a href="estimating-phylogenetic-trees.html#cb487-443" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(ncores)</span>
<span id="cb487-444"><a href="estimating-phylogenetic-trees.html#cb487-444" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb487-445"><a href="estimating-phylogenetic-trees.html#cb487-445" aria-hidden="true" tabindex="-1"></a><span class="fu">foreach</span>(<span class="at">iqtree_i=</span>list_iqtree_scripts, <span class="at">.export =</span> <span class="st">&quot;execute_iqtree_terminal&quot;</span>) <span class="sc">%dopar%</span> </span>
<span id="cb487-446"><a href="estimating-phylogenetic-trees.html#cb487-446" aria-hidden="true" tabindex="-1"></a>                               {<span class="fu">execute_iqtree_terminal</span>(<span class="at">iqtree_command=</span>iqtree_i)}</span>
<span id="cb487-447"><a href="estimating-phylogenetic-trees.html#cb487-447" aria-hidden="true" tabindex="-1"></a>parallel<span class="sc">::</span><span class="fu">stopCluster</span>(cl)</span>
<span id="cb487-448"><a href="estimating-phylogenetic-trees.html#cb487-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-449"><a href="estimating-phylogenetic-trees.html#cb487-449" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st"> ****** DONE ****** </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb487-450"><a href="estimating-phylogenetic-trees.html#cb487-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-451"><a href="estimating-phylogenetic-trees.html#cb487-451" aria-hidden="true" tabindex="-1"></a>                           }</span>
<span id="cb487-452"><a href="estimating-phylogenetic-trees.html#cb487-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-453"><a href="estimating-phylogenetic-trees.html#cb487-453" aria-hidden="true" tabindex="-1"></a><span class="do">### to return to user grab treefile</span></span>
<span id="cb487-454"><a href="estimating-phylogenetic-trees.html#cb487-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-455"><a href="estimating-phylogenetic-trees.html#cb487-455" aria-hidden="true" tabindex="-1"></a>iqtrees_vector <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.treefile$&quot;</span>, <span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb487-456"><a href="estimating-phylogenetic-trees.html#cb487-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-457"><a href="estimating-phylogenetic-trees.html#cb487-457" aria-hidden="true" tabindex="-1"></a>list_of_trees <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb487-458"><a href="estimating-phylogenetic-trees.html#cb487-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-459"><a href="estimating-phylogenetic-trees.html#cb487-459" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(iqtrees_vector)) {list_of_trees[[i]] <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(iqtrees_vector[i])}</span>
<span id="cb487-460"><a href="estimating-phylogenetic-trees.html#cb487-460" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i)</span>
<span id="cb487-461"><a href="estimating-phylogenetic-trees.html#cb487-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-462"><a href="estimating-phylogenetic-trees.html#cb487-462" aria-hidden="true" tabindex="-1"></a><span class="do">### if chronograms</span></span>
<span id="cb487-463"><a href="estimating-phylogenetic-trees.html#cb487-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-464"><a href="estimating-phylogenetic-trees.html#cb487-464" aria-hidden="true" tabindex="-1"></a>iqtree_chronograms <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.timetree.nex$&quot;</span>, <span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb487-465"><a href="estimating-phylogenetic-trees.html#cb487-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-466"><a href="estimating-phylogenetic-trees.html#cb487-466" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(iqtree_chronograms) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb487-467"><a href="estimating-phylogenetic-trees.html#cb487-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-468"><a href="estimating-phylogenetic-trees.html#cb487-468" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(iqtree_chronograms)) {</span>
<span id="cb487-469"><a href="estimating-phylogenetic-trees.html#cb487-469" aria-hidden="true" tabindex="-1"></a>                               one_chronogram <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.nexus</span>(iqtree_chronograms[i])</span>
<span id="cb487-470"><a href="estimating-phylogenetic-trees.html#cb487-470" aria-hidden="true" tabindex="-1"></a>                                      n_trees <span class="ot">&lt;-</span> <span class="fu">length</span>(list_of_trees)</span>
<span id="cb487-471"><a href="estimating-phylogenetic-trees.html#cb487-471" aria-hidden="true" tabindex="-1"></a>                   list_of_trees[[n_trees<span class="sc">+</span><span class="dv">1</span>]] <span class="ot">&lt;-</span> one_chronogram }</span>
<span id="cb487-472"><a href="estimating-phylogenetic-trees.html#cb487-472" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i)</span>
<span id="cb487-473"><a href="estimating-phylogenetic-trees.html#cb487-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-474"><a href="estimating-phylogenetic-trees.html#cb487-474" aria-hidden="true" tabindex="-1"></a>                                   }</span>
<span id="cb487-475"><a href="estimating-phylogenetic-trees.html#cb487-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-476"><a href="estimating-phylogenetic-trees.html#cb487-476" aria-hidden="true" tabindex="-1"></a><span class="do">############ open and run iqtree from R: DONE</span></span>
<span id="cb487-477"><a href="estimating-phylogenetic-trees.html#cb487-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-478"><a href="estimating-phylogenetic-trees.html#cb487-478" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(master_wd_directory)</span>
<span id="cb487-479"><a href="estimating-phylogenetic-trees.html#cb487-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-480"><a href="estimating-phylogenetic-trees.html#cb487-480" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n\n</span><span class="st"> *************         iqtree outfiles written to        ************* </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb487-481"><a href="estimating-phylogenetic-trees.html#cb487-481" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(master_wd_directory)</span>
<span id="cb487-482"><a href="estimating-phylogenetic-trees.html#cb487-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-483"><a href="estimating-phylogenetic-trees.html#cb487-483" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(list_of_trees)</span>
<span id="cb487-484"><a href="estimating-phylogenetic-trees.html#cb487-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-485"><a href="estimating-phylogenetic-trees.html#cb487-485" aria-hidden="true" tabindex="-1"></a>                                           }</span>
<span id="cb487-486"><a href="estimating-phylogenetic-trees.html#cb487-486" aria-hidden="true" tabindex="-1"></a><span class="do">##    </span><span class="re">END</span><span class="do"> OF FUNCTION   </span></span></code></pre></div>
<p>After you have copied and pasted the function <code>iqtree_runner_R()</code>, you will not get any result yet. However, the function will be in memory ready to run.</p>
</div>
<div id="running-iqtree2-from-r" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> Running <code>iqtree2</code> from R</h2>
<p>After you have loaded the function <code>iqtree_runner_R()</code>, we will perform several analyses. <strong>IMPORTANT</strong> Your alignment file (fasta or nexus) cannot have taxa, terminals or sequences with the same name; if you want to run including such sequences make sure that you label them accordingly.</p>
</div>
<div id="one-marker-and-no-partitions" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> One marker and no partitions</h2>
<p>In most cases, you just want a phylogenetic tree estimated from your sequences. This makes <strong>iqtree2</strong> extremely powerful as it can automatically select molecular model that best fits your data (i.e., <code>ModelFinder</code> section).</p>
<p><strong>4)</strong> We will start with the most simple using the COI aligned sequences in the file <code>Ameerega_aligned_end.fasta</code>.</p>
<p><strong>a)</strong> Set up your working directory (e.g., <code>my_phylogeny_1</code>) and get its path.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="estimating-phylogenetic-trees.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="do">## this is exclusive to your OWN COMPUTER change it accordingly</span></span>
<span id="cb488-2"><a href="estimating-phylogenetic-trees.html#cb488-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;~/Desktop/Teach_R/my_working_directory/my_phylogeny_1&quot;</span>)</span></code></pre></div>
<p><strong>b)</strong> find the file with aligned sequences: <code>Ameerega_aligned_end.fasta</code> and copy that file to your working directory (e.g., <code>my_phylogeny_1</code>)</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="estimating-phylogenetic-trees.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="do">## copy the file Ameerega_aligned_end.fasta to your working directory my_phylogeny_1</span></span>
<span id="cb489-2"><a href="estimating-phylogenetic-trees.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="do">## this is the path to that file and exclusive to your OWN COMPUTER change it accordingly</span></span>
<span id="cb489-3"><a href="estimating-phylogenetic-trees.html#cb489-3" aria-hidden="true" tabindex="-1"></a>my_path_to_aligned_sequences <span class="ot">&lt;-</span> <span class="st">&quot;~/Desktop/Teach_R/my_working_directory/my_phylogeny_1/Ameerega_aligned_end.fasta&quot;</span></span></code></pre></div>
<p><img src="figures/session_12_figs/11_preparing_directory.png" width="90%" /></p>
<p><strong>c)</strong> find the path to the directory that contain the binary of <strong>iqtree2</strong>. Note that this is path to the directory, NOT the binary itself (check the syntax below).</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="estimating-phylogenetic-trees.html#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="do">## macOS: if you drag and drop the binary iqtree2</span></span>
<span id="cb490-2"><a href="estimating-phylogenetic-trees.html#cb490-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-3"><a href="estimating-phylogenetic-trees.html#cb490-3" aria-hidden="true" tabindex="-1"></a><span class="sc">~</span><span class="er">/</span>Desktop<span class="sc">/</span>Teach_R<span class="sc">/</span>class_pages_reference<span class="sc">/</span>bioinformatics_gitbook_1<span class="sc">/</span>my_programs<span class="sc">/</span>iqtree2</span>
<span id="cb490-4"><a href="estimating-phylogenetic-trees.html#cb490-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-5"><a href="estimating-phylogenetic-trees.html#cb490-5" aria-hidden="true" tabindex="-1"></a><span class="do">## this is exclusive to your OWN COMPUTER and we just need the path to the directory that contains iqtree2</span></span>
<span id="cb490-6"><a href="estimating-phylogenetic-trees.html#cb490-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Note: the diffecent from path above and the one below.</span></span>
<span id="cb490-7"><a href="estimating-phylogenetic-trees.html#cb490-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-8"><a href="estimating-phylogenetic-trees.html#cb490-8" aria-hidden="true" tabindex="-1"></a>my_path_to_iqtree2 <span class="ot">&lt;-</span> <span class="st">&quot;~/Desktop/Teach_R/class_pages_reference/bioinformatics_gitbook_1/my_programs&quot;</span></span></code></pre></div>
<p><strong>d)</strong> Now, we can run the function <code>iqtree_runner_R()</code>.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="estimating-phylogenetic-trees.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="do">## SIMPLE iqtree2 run </span></span>
<span id="cb491-2"><a href="estimating-phylogenetic-trees.html#cb491-2" aria-hidden="true" tabindex="-1"></a>COI_simple_phylogeny <span class="ot">&lt;-</span> <span class="fu">iqtree_runner_R</span> (<span class="at">input_alignment_file_user =</span> my_path_to_aligned_sequences,</span>
<span id="cb491-3"><a href="estimating-phylogenetic-trees.html#cb491-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_bin_location_user =</span> my_path_to_iqtree2,</span>
<span id="cb491-4"><a href="estimating-phylogenetic-trees.html#cb491-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">run_iqtree_call_user =</span> <span class="st">&quot;serial&quot;</span>,</span>
<span id="cb491-5"><a href="estimating-phylogenetic-trees.html#cb491-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_input_model_m_user =</span> <span class="st">&quot;MFP+MERGE&quot;</span>)</span>
<span id="cb491-6"><a href="estimating-phylogenetic-trees.html#cb491-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-7"><a href="estimating-phylogenetic-trees.html#cb491-7" aria-hidden="true" tabindex="-1"></a><span class="do">## you will get this output on the console</span></span>
<span id="cb491-8"><a href="estimating-phylogenetic-trees.html#cb491-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-9"><a href="estimating-phylogenetic-trees.html#cb491-9" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] &quot;iqtree2  -s Ameerega_aligned_end.fasta     -m  MFP+MERGE  &quot;</span></span>
<span id="cb491-10"><a href="estimating-phylogenetic-trees.html#cb491-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-11"><a href="estimating-phylogenetic-trees.html#cb491-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ****** started serial analisis of:  1 </span></span>
<span id="cb491-12"><a href="estimating-phylogenetic-trees.html#cb491-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ***** iqtree analysis name:  Ameerega_aligned_end.fasta </span></span>
<span id="cb491-13"><a href="estimating-phylogenetic-trees.html#cb491-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ***** iqtree commands:  iqtree2  -s Ameerega_aligned_end.fasta     -m  MFP+MERGE   </span></span>
<span id="cb491-14"><a href="estimating-phylogenetic-trees.html#cb491-14" aria-hidden="true" tabindex="-1"></a><span class="co"># IQ-TREE multicore version 2.1.2 COVID-edition for Mac OS X 64-bit built Oct 22 2020</span></span>
<span id="cb491-15"><a href="estimating-phylogenetic-trees.html#cb491-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Developed by Bui Quang Minh, James Barbetti, Nguyen Lam Tung,</span></span>
<span id="cb491-16"><a href="estimating-phylogenetic-trees.html#cb491-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Olga Chernomor, Heiko Schmidt, Dominik Schrempf, Michael Woodhams.</span></span>
<span id="cb491-17"><a href="estimating-phylogenetic-trees.html#cb491-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-18"><a href="estimating-phylogenetic-trees.html#cb491-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Host:    LFQSANTOSJ2016 (AVX2, FMA3, 8 GB RAM)</span></span>
<span id="cb491-19"><a href="estimating-phylogenetic-trees.html#cb491-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Command: iqtree2 -s Ameerega_aligned_end.fasta -m MFP+MERGE</span></span>
<span id="cb491-20"><a href="estimating-phylogenetic-trees.html#cb491-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Seed:    487027 (Using SPRNG - Scalable Parallel Random Number Generator)</span></span>
<span id="cb491-21"><a href="estimating-phylogenetic-trees.html#cb491-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Time:    Tue Feb 23 17:46:25 2021</span></span>
<span id="cb491-22"><a href="estimating-phylogenetic-trees.html#cb491-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Kernel:  AVX+FMA - 1 threads (4 CPU cores detected)</span></span>
<span id="cb491-23"><a href="estimating-phylogenetic-trees.html#cb491-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-24"><a href="estimating-phylogenetic-trees.html#cb491-24" aria-hidden="true" tabindex="-1"></a><span class="co"># HINT: Use -nt option to specify number of threads because your CPU has 4 cores!</span></span>
<span id="cb491-25"><a href="estimating-phylogenetic-trees.html#cb491-25" aria-hidden="true" tabindex="-1"></a><span class="co"># HINT: -nt AUTO will automatically determine the best number of threads to use.</span></span>
<span id="cb491-26"><a href="estimating-phylogenetic-trees.html#cb491-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-27"><a href="estimating-phylogenetic-trees.html#cb491-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading alignment file Ameerega_aligned_end.fasta ... Fasta format detected</span></span>
<span id="cb491-28"><a href="estimating-phylogenetic-trees.html#cb491-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Alignment most likely contains DNA/RNA sequences</span></span>
<span id="cb491-29"><a href="estimating-phylogenetic-trees.html#cb491-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Alignment has 24 sequences with 1539 columns, 452 distinct patterns</span></span>
<span id="cb491-30"><a href="estimating-phylogenetic-trees.html#cb491-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 378 parsimony-informative, 140 singleton sites, 1021 constant sites</span></span>
<span id="cb491-31"><a href="estimating-phylogenetic-trees.html#cb491-31" aria-hidden="true" tabindex="-1"></a><span class="co">#             Gap/Ambiguity  Composition  p-value</span></span>
<span id="cb491-32"><a href="estimating-phylogenetic-trees.html#cb491-32" aria-hidden="true" tabindex="-1"></a><span class="co">#    1  MW042032.1    0.00%    passed     91.59%</span></span>
<span id="cb491-33"><a href="estimating-phylogenetic-trees.html#cb491-33" aria-hidden="true" tabindex="-1"></a><span class="co">#    2  MW042031.1    0.00%    passed     61.48%</span></span>
<span id="cb491-34"><a href="estimating-phylogenetic-trees.html#cb491-34" aria-hidden="true" tabindex="-1"></a><span class="co">#    3  MW042030.1    0.00%    passed     81.11%</span></span>
<span id="cb491-35"><a href="estimating-phylogenetic-trees.html#cb491-35" aria-hidden="true" tabindex="-1"></a><span class="co">#    4  KU494334.1   58.02%    passed     72.66%</span></span>
<span id="cb491-36"><a href="estimating-phylogenetic-trees.html#cb491-36" aria-hidden="true" tabindex="-1"></a><span class="co">#    5  KU494333.1   57.96%    passed     99.83%</span></span>
<span id="cb491-37"><a href="estimating-phylogenetic-trees.html#cb491-37" aria-hidden="true" tabindex="-1"></a><span class="co">#    6  KU494332.1   57.96%    passed     99.83%</span></span>
<span id="cb491-38"><a href="estimating-phylogenetic-trees.html#cb491-38" aria-hidden="true" tabindex="-1"></a><span class="co">#    7  AF097506.1   66.21%    passed     51.07%</span></span>
<span id="cb491-39"><a href="estimating-phylogenetic-trees.html#cb491-39" aria-hidden="true" tabindex="-1"></a><span class="co">#    8  DQ502932.1   57.24%    passed     90.55%</span></span>
<span id="cb491-40"><a href="estimating-phylogenetic-trees.html#cb491-40" aria-hidden="true" tabindex="-1"></a><span class="co">#    9  DQ502929.1   57.24%    passed     55.70%</span></span>
<span id="cb491-41"><a href="estimating-phylogenetic-trees.html#cb491-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   10  DQ502922.1   57.24%    passed     84.11%</span></span>
<span id="cb491-42"><a href="estimating-phylogenetic-trees.html#cb491-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   11  DQ502920.1   57.24%    passed     33.21%</span></span>
<span id="cb491-43"><a href="estimating-phylogenetic-trees.html#cb491-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   12  DQ502903.1   57.24%    passed     51.16%</span></span>
<span id="cb491-44"><a href="estimating-phylogenetic-trees.html#cb491-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   13  DQ502902.1   57.24%    passed     65.03%</span></span>
<span id="cb491-45"><a href="estimating-phylogenetic-trees.html#cb491-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   14  DQ502901.1   57.24%    passed     48.46%</span></span>
<span id="cb491-46"><a href="estimating-phylogenetic-trees.html#cb491-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   15  DQ502851.1   57.24%    passed     94.07%</span></span>
<span id="cb491-47"><a href="estimating-phylogenetic-trees.html#cb491-47" aria-hidden="true" tabindex="-1"></a><span class="co">#   16  DQ502849.1   57.24%    passed     33.21%</span></span>
<span id="cb491-48"><a href="estimating-phylogenetic-trees.html#cb491-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   17  DQ502848.1   57.24%    passed     29.31%</span></span>
<span id="cb491-49"><a href="estimating-phylogenetic-trees.html#cb491-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   18  DQ502832.1   57.31%    passed     91.59%</span></span>
<span id="cb491-50"><a href="estimating-phylogenetic-trees.html#cb491-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   19  DQ502831.1   57.24%    passed     93.67%</span></span>
<span id="cb491-51"><a href="estimating-phylogenetic-trees.html#cb491-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   20  DQ502825.1   57.24%    passed     60.02%</span></span>
<span id="cb491-52"><a href="estimating-phylogenetic-trees.html#cb491-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   21  MW042037.1    0.00%    passed     77.97%</span></span>
<span id="cb491-53"><a href="estimating-phylogenetic-trees.html#cb491-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   22  KR862889.1   57.50%    passed     41.02%</span></span>
<span id="cb491-54"><a href="estimating-phylogenetic-trees.html#cb491-54" aria-hidden="true" tabindex="-1"></a><span class="co">#   23  MW042036.1    0.00%    failed      0.13%</span></span>
<span id="cb491-55"><a href="estimating-phylogenetic-trees.html#cb491-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   24  MW042039.1    0.00%    failed      0.57%</span></span>
<span id="cb491-56"><a href="estimating-phylogenetic-trees.html#cb491-56" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: 18 sequences contain more than 50% gaps/ambiguity</span></span>
<span id="cb491-57"><a href="estimating-phylogenetic-trees.html#cb491-57" aria-hidden="true" tabindex="-1"></a><span class="co"># ****  TOTAL        43.41%  2 sequences failed composition chi2 test (p-value&lt;5%; df=3)</span></span>
<span id="cb491-58"><a href="estimating-phylogenetic-trees.html#cb491-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: KU494332.1 is identical to KU494333.1 but kept for subsequent analysis</span></span>
<span id="cb491-59"><a href="estimating-phylogenetic-trees.html#cb491-59" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-60"><a href="estimating-phylogenetic-trees.html#cb491-60" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-61"><a href="estimating-phylogenetic-trees.html#cb491-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Create initial parsimony tree by phylogenetic likelihood library (PLL)... 0.003 seconds</span></span>
<span id="cb491-62"><a href="estimating-phylogenetic-trees.html#cb491-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform fast likelihood tree search using GTR+I+G model...</span></span>
<span id="cb491-63"><a href="estimating-phylogenetic-trees.html#cb491-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model parameters (epsilon = 5.000)</span></span>
<span id="cb491-64"><a href="estimating-phylogenetic-trees.html#cb491-64" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-65"><a href="estimating-phylogenetic-trees.html#cb491-65" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: Estimated model parameters are at boundary that can cause numerical instability!</span></span>
<span id="cb491-66"><a href="estimating-phylogenetic-trees.html#cb491-66" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-67"><a href="estimating-phylogenetic-trees.html#cb491-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform nearest neighbor interchange...</span></span>
<span id="cb491-68"><a href="estimating-phylogenetic-trees.html#cb491-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model parameters (epsilon = 1.000)</span></span>
<span id="cb491-69"><a href="estimating-phylogenetic-trees.html#cb491-69" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Initial log-likelihood: -7191.031</span></span>
<span id="cb491-70"><a href="estimating-phylogenetic-trees.html#cb491-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal log-likelihood: -7189.967</span></span>
<span id="cb491-71"><a href="estimating-phylogenetic-trees.html#cb491-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Rate parameters:  A-C: 7.98907  A-G: 64.12175  A-T: 11.66195  C-G: 1.43333  C-T: 100.00000  G-T: 1.00000</span></span>
<span id="cb491-72"><a href="estimating-phylogenetic-trees.html#cb491-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Base frequencies:  A: 0.240  C: 0.266  G: 0.172  T: 0.321</span></span>
<span id="cb491-73"><a href="estimating-phylogenetic-trees.html#cb491-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of invariable sites: 0.357</span></span>
<span id="cb491-74"><a href="estimating-phylogenetic-trees.html#cb491-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Gamma shape alpha: 0.388</span></span>
<span id="cb491-75"><a href="estimating-phylogenetic-trees.html#cb491-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters optimization took 1 rounds (0.044 sec)</span></span>
<span id="cb491-76"><a href="estimating-phylogenetic-trees.html#cb491-76" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-77"><a href="estimating-phylogenetic-trees.html#cb491-77" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: Estimated model parameters are at boundary that can cause numerical instability!</span></span>
<span id="cb491-78"><a href="estimating-phylogenetic-trees.html#cb491-78" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-79"><a href="estimating-phylogenetic-trees.html#cb491-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Time for fast ML tree search: 0.322 seconds</span></span>
<span id="cb491-80"><a href="estimating-phylogenetic-trees.html#cb491-80" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-81"><a href="estimating-phylogenetic-trees.html#cb491-81" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: ModelFinder requires 3 MB RAM!</span></span>
<span id="cb491-82"><a href="estimating-phylogenetic-trees.html#cb491-82" aria-hidden="true" tabindex="-1"></a><span class="co"># ModelFinder will test up to 286 DNA models (sample size: 1539) ...</span></span>
<span id="cb491-83"><a href="estimating-phylogenetic-trees.html#cb491-83" aria-hidden="true" tabindex="-1"></a><span class="co">#  No. Model         -LnL         df  AIC          AICc         BIC</span></span>
<span id="cb491-84"><a href="estimating-phylogenetic-trees.html#cb491-84" aria-hidden="true" tabindex="-1"></a><span class="co">#   1  GTR+F         7870.984     53  15847.967    15851.822    16130.928</span></span>
<span id="cb491-85"><a href="estimating-phylogenetic-trees.html#cb491-85" aria-hidden="true" tabindex="-1"></a><span class="co">#   2  GTR+F+I       7216.150     54  14540.301    14544.303    14828.601</span></span>
<span id="cb491-86"><a href="estimating-phylogenetic-trees.html#cb491-86" aria-hidden="true" tabindex="-1"></a><span class="co">#   3  GTR+F+G4      7199.116     54  14506.232    14510.235    14794.532</span></span>
<span id="cb491-87"><a href="estimating-phylogenetic-trees.html#cb491-87" aria-hidden="true" tabindex="-1"></a><span class="co">#   4  GTR+F+I+G4    7176.558     55  14463.117    14467.270    14756.755</span></span>
<span id="cb491-88"><a href="estimating-phylogenetic-trees.html#cb491-88" aria-hidden="true" tabindex="-1"></a><span class="co">#   5  GTR+F+R2      7295.486     55  14700.971    14705.125    14994.610</span></span>
<span id="cb491-89"><a href="estimating-phylogenetic-trees.html#cb491-89" aria-hidden="true" tabindex="-1"></a><span class="co">#   6  GTR+F+R3      7242.022     57  14598.044    14602.509    14902.361</span></span>
<span id="cb491-90"><a href="estimating-phylogenetic-trees.html#cb491-90" aria-hidden="true" tabindex="-1"></a><span class="co">#   7  GTR+F+R4      7215.932     59  14549.863    14554.650    14864.858</span></span>
<span id="cb491-91"><a href="estimating-phylogenetic-trees.html#cb491-91" aria-hidden="true" tabindex="-1"></a><span class="co">#   8  GTR+F+R5      7202.474     61  14526.949    14532.070    14852.621</span></span>
<span id="cb491-92"><a href="estimating-phylogenetic-trees.html#cb491-92" aria-hidden="true" tabindex="-1"></a><span class="co">#   9  GTR+F+R6      7195.140     63  14516.279    14521.746    14852.629</span></span>
<span id="cb491-93"><a href="estimating-phylogenetic-trees.html#cb491-93" aria-hidden="true" tabindex="-1"></a><span class="co">#  17  SYM+I+G4      7230.681     52  14565.361    14569.071    14842.984</span></span>
<span id="cb491-94"><a href="estimating-phylogenetic-trees.html#cb491-94" aria-hidden="true" tabindex="-1"></a><span class="co">#  30  TVM+F+I+G4    7179.891     54  14467.782    14471.784    14756.081</span></span>
<span id="cb491-95"><a href="estimating-phylogenetic-trees.html#cb491-95" aria-hidden="true" tabindex="-1"></a><span class="co">#  43  TVMe+I+G4     7265.512     51  14633.024    14636.590    14905.307</span></span>
<span id="cb491-96"><a href="estimating-phylogenetic-trees.html#cb491-96" aria-hidden="true" tabindex="-1"></a><span class="co">#  56  TIM3+F+I+G4   7203.542     53  14513.085    14516.939    14796.046</span></span>
<span id="cb491-97"><a href="estimating-phylogenetic-trees.html#cb491-97" aria-hidden="true" tabindex="-1"></a><span class="co">#  69  TIM3e+I+G4    7284.220     50  14668.440    14671.867    14935.384</span></span>
<span id="cb491-98"><a href="estimating-phylogenetic-trees.html#cb491-98" aria-hidden="true" tabindex="-1"></a><span class="co">#  82  TIM2+F+I+G4   7177.515     53  14461.029    14464.884    14743.990</span></span>
<span id="cb491-99"><a href="estimating-phylogenetic-trees.html#cb491-99" aria-hidden="true" tabindex="-1"></a><span class="co">#  95  TIM2e+I+G4    7233.907     50  14567.815    14571.242    14834.759</span></span>
<span id="cb491-100"><a href="estimating-phylogenetic-trees.html#cb491-100" aria-hidden="true" tabindex="-1"></a><span class="co"># 108  TIM+F+I+G4    7202.565     53  14511.129    14514.984    14794.090</span></span>
<span id="cb491-101"><a href="estimating-phylogenetic-trees.html#cb491-101" aria-hidden="true" tabindex="-1"></a><span class="co"># 121  TIMe+I+G4     7283.344     50  14666.689    14670.116    14933.633</span></span>
<span id="cb491-102"><a href="estimating-phylogenetic-trees.html#cb491-102" aria-hidden="true" tabindex="-1"></a><span class="co"># 134  TPM3u+F+I+G4  7205.716     52  14515.433    14519.142    14793.055</span></span>
<span id="cb491-103"><a href="estimating-phylogenetic-trees.html#cb491-103" aria-hidden="true" tabindex="-1"></a><span class="co"># 147  TPM3+F+I+G4   7205.716     52  14515.433    14519.142    14793.055</span></span>
<span id="cb491-104"><a href="estimating-phylogenetic-trees.html#cb491-104" aria-hidden="true" tabindex="-1"></a><span class="co"># 160  TPM2u+F+I+G4  7181.001     52  14466.003    14469.712    14743.625</span></span>
<span id="cb491-105"><a href="estimating-phylogenetic-trees.html#cb491-105" aria-hidden="true" tabindex="-1"></a><span class="co"># 173  TPM2+F+I+G4   7180.996     52  14465.992    14469.702    14743.614</span></span>
<span id="cb491-106"><a href="estimating-phylogenetic-trees.html#cb491-106" aria-hidden="true" tabindex="-1"></a><span class="co"># 186  K3Pu+F+I+G4   7204.884     52  14513.768    14517.477    14791.390</span></span>
<span id="cb491-107"><a href="estimating-phylogenetic-trees.html#cb491-107" aria-hidden="true" tabindex="-1"></a><span class="co"># 199  K3P+I+G4      7315.342     49  14728.684    14731.975    14990.290</span></span>
<span id="cb491-108"><a href="estimating-phylogenetic-trees.html#cb491-108" aria-hidden="true" tabindex="-1"></a><span class="co"># 212  TN+F+I+G4     7204.352     52  14512.704    14516.413    14790.326</span></span>
<span id="cb491-109"><a href="estimating-phylogenetic-trees.html#cb491-109" aria-hidden="true" tabindex="-1"></a><span class="co"># 225  TNe+I+G4      7286.452     49  14670.904    14674.195    14932.510</span></span>
<span id="cb491-110"><a href="estimating-phylogenetic-trees.html#cb491-110" aria-hidden="true" tabindex="-1"></a><span class="co"># 238  HKY+F+I+G4    7206.672     51  14515.343    14518.910    14787.627</span></span>
<span id="cb491-111"><a href="estimating-phylogenetic-trees.html#cb491-111" aria-hidden="true" tabindex="-1"></a><span class="co"># 251  K2P+I+G4      7318.616     48  14733.231    14736.388    14989.498</span></span>
<span id="cb491-112"><a href="estimating-phylogenetic-trees.html#cb491-112" aria-hidden="true" tabindex="-1"></a><span class="co"># 264  F81+F+I+G4    7804.765     50  15709.531    15712.958    15976.475</span></span>
<span id="cb491-113"><a href="estimating-phylogenetic-trees.html#cb491-113" aria-hidden="true" tabindex="-1"></a><span class="co"># 277  JC+I+G4       7964.515     47  16023.030    16026.056    16273.957</span></span>
<span id="cb491-114"><a href="estimating-phylogenetic-trees.html#cb491-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Akaike Information Criterion:           TIM2+F+I+G4</span></span>
<span id="cb491-115"><a href="estimating-phylogenetic-trees.html#cb491-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Corrected Akaike Information Criterion: TIM2+F+I+G4</span></span>
<span id="cb491-116"><a href="estimating-phylogenetic-trees.html#cb491-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian Information Criterion:         TPM2+F+I+G4</span></span>
<span id="cb491-117"><a href="estimating-phylogenetic-trees.html#cb491-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Best-fit model: TPM2+F+I+G4 chosen according to BIC</span></span>
<span id="cb491-118"><a href="estimating-phylogenetic-trees.html#cb491-118" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-119"><a href="estimating-phylogenetic-trees.html#cb491-119" aria-hidden="true" tabindex="-1"></a><span class="co"># All model information printed to Ameerega_aligned_end.fasta.model.gz</span></span>
<span id="cb491-120"><a href="estimating-phylogenetic-trees.html#cb491-120" aria-hidden="true" tabindex="-1"></a><span class="co"># CPU time for ModelFinder: 6.355 seconds (0h:0m:6s)</span></span>
<span id="cb491-121"><a href="estimating-phylogenetic-trees.html#cb491-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Wall-clock time for ModelFinder: 6.536 seconds (0h:0m:6s)</span></span>
<span id="cb491-122"><a href="estimating-phylogenetic-trees.html#cb491-122" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-123"><a href="estimating-phylogenetic-trees.html#cb491-123" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: 1 MB RAM (0 GB) is required!</span></span>
<span id="cb491-124"><a href="estimating-phylogenetic-trees.html#cb491-124" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model parameters (epsilon = 0.100)</span></span>
<span id="cb491-125"><a href="estimating-phylogenetic-trees.html#cb491-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Thoroughly optimizing +I+G parameters from 10 start values...</span></span>
<span id="cb491-126"><a href="estimating-phylogenetic-trees.html#cb491-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Init pinv, alpha: 0.000, 1.370 / Estimate: 0.000, 0.166 / LogL: -7202.724</span></span>
<span id="cb491-127"><a href="estimating-phylogenetic-trees.html#cb491-127" aria-hidden="true" tabindex="-1"></a><span class="co"># Init pinv, alpha: 0.074, 1.370 / Estimate: 0.071, 0.192 / LogL: -7203.417</span></span>
<span id="cb491-128"><a href="estimating-phylogenetic-trees.html#cb491-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Init pinv, alpha: 0.147, 1.370 / Estimate: 0.149, 0.227 / LogL: -7203.178</span></span>
<span id="cb491-129"><a href="estimating-phylogenetic-trees.html#cb491-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Init pinv, alpha: 0.221, 1.370 / Estimate: 0.592, 1.298 / LogL: -7181.054</span></span>
<span id="cb491-130"><a href="estimating-phylogenetic-trees.html#cb491-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Init pinv, alpha: 0.295, 1.370 / Estimate: 0.593, 1.312 / LogL: -7181.038</span></span>
<span id="cb491-131"><a href="estimating-phylogenetic-trees.html#cb491-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Init pinv, alpha: 0.369, 1.370 / Estimate: 0.592, 1.300 / LogL: -7181.052</span></span>
<span id="cb491-132"><a href="estimating-phylogenetic-trees.html#cb491-132" aria-hidden="true" tabindex="-1"></a><span class="co"># Init pinv, alpha: 0.442, 1.370 / Estimate: 0.593, 1.311 / LogL: -7181.038</span></span>
<span id="cb491-133"><a href="estimating-phylogenetic-trees.html#cb491-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Init pinv, alpha: 0.516, 1.370 / Estimate: 0.593, 1.314 / LogL: -7181.034</span></span>
<span id="cb491-134"><a href="estimating-phylogenetic-trees.html#cb491-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Init pinv, alpha: 0.590, 1.370 / Estimate: 0.593, 1.324 / LogL: -7181.039</span></span>
<span id="cb491-135"><a href="estimating-phylogenetic-trees.html#cb491-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Init pinv, alpha: 0.663, 1.370 / Estimate: 0.603, 1.476 / LogL: -7181.034</span></span>
<span id="cb491-136"><a href="estimating-phylogenetic-trees.html#cb491-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal pinv,alpha: 0.593, 1.314 / LogL: -7181.034</span></span>
<span id="cb491-137"><a href="estimating-phylogenetic-trees.html#cb491-137" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-138"><a href="estimating-phylogenetic-trees.html#cb491-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters optimization took 2.390 sec</span></span>
<span id="cb491-139"><a href="estimating-phylogenetic-trees.html#cb491-139" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-140"><a href="estimating-phylogenetic-trees.html#cb491-140" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: Estimated model parameters are at boundary that can cause numerical instability!</span></span>
<span id="cb491-141"><a href="estimating-phylogenetic-trees.html#cb491-141" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-142"><a href="estimating-phylogenetic-trees.html#cb491-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing ML distances based on estimated model parameters...</span></span>
<span id="cb491-143"><a href="estimating-phylogenetic-trees.html#cb491-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing ML distances took 0.013737 sec (of wall-clock time) 0.013278 sec(of CPU time)</span></span>
<span id="cb491-144"><a href="estimating-phylogenetic-trees.html#cb491-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing RapidNJ tree took 0.000465 sec (of wall-clock time) 0.000218 sec (of CPU time)</span></span>
<span id="cb491-145"><a href="estimating-phylogenetic-trees.html#cb491-145" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-likelihood of RapidNJ tree: -7193.279</span></span>
<span id="cb491-146"><a href="estimating-phylogenetic-trees.html#cb491-146" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------------------------</span></span>
<span id="cb491-147"><a href="estimating-phylogenetic-trees.html#cb491-147" aria-hidden="true" tabindex="-1"></a><span class="co"># |             INITIALIZING CANDIDATE TREE SET                      |</span></span>
<span id="cb491-148"><a href="estimating-phylogenetic-trees.html#cb491-148" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------------------------</span></span>
<span id="cb491-149"><a href="estimating-phylogenetic-trees.html#cb491-149" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating 98 parsimony trees... 0.182 second</span></span>
<span id="cb491-150"><a href="estimating-phylogenetic-trees.html#cb491-150" aria-hidden="true" tabindex="-1"></a><span class="co"># Computing log-likelihood of 98 initial trees ... 0.260 seconds</span></span>
<span id="cb491-151"><a href="estimating-phylogenetic-trees.html#cb491-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Current best score: -7181.034</span></span>
<span id="cb491-152"><a href="estimating-phylogenetic-trees.html#cb491-152" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-153"><a href="estimating-phylogenetic-trees.html#cb491-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Do NNI search on 20 best initial trees</span></span>
<span id="cb491-154"><a href="estimating-phylogenetic-trees.html#cb491-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model parameters (epsilon = 0.100)</span></span>
<span id="cb491-155"><a href="estimating-phylogenetic-trees.html#cb491-155" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-156"><a href="estimating-phylogenetic-trees.html#cb491-156" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: Estimated model parameters are at boundary that can cause numerical instability!</span></span>
<span id="cb491-157"><a href="estimating-phylogenetic-trees.html#cb491-157" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-158"><a href="estimating-phylogenetic-trees.html#cb491-158" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER TREE FOUND at iteration 1: -7181.009</span></span>
<span id="cb491-159"><a href="estimating-phylogenetic-trees.html#cb491-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model parameters (epsilon = 0.100)</span></span>
<span id="cb491-160"><a href="estimating-phylogenetic-trees.html#cb491-160" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-161"><a href="estimating-phylogenetic-trees.html#cb491-161" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: Estimated model parameters are at boundary that can cause numerical instability!</span></span>
<span id="cb491-162"><a href="estimating-phylogenetic-trees.html#cb491-162" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-163"><a href="estimating-phylogenetic-trees.html#cb491-163" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER TREE FOUND at iteration 3: -7179.089</span></span>
<span id="cb491-164"><a href="estimating-phylogenetic-trees.html#cb491-164" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER TREE FOUND at iteration 6: -7179.089</span></span>
<span id="cb491-165"><a href="estimating-phylogenetic-trees.html#cb491-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model parameters (epsilon = 0.100)</span></span>
<span id="cb491-166"><a href="estimating-phylogenetic-trees.html#cb491-166" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-167"><a href="estimating-phylogenetic-trees.html#cb491-167" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: Estimated model parameters are at boundary that can cause numerical instability!</span></span>
<span id="cb491-168"><a href="estimating-phylogenetic-trees.html#cb491-168" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-169"><a href="estimating-phylogenetic-trees.html#cb491-169" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER TREE FOUND at iteration 7: -7176.557</span></span>
<span id="cb491-170"><a href="estimating-phylogenetic-trees.html#cb491-170" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 10 / LogL: -7178.385 / Time: 0h:0m:3s</span></span>
<span id="cb491-171"><a href="estimating-phylogenetic-trees.html#cb491-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model parameters (epsilon = 0.100)</span></span>
<span id="cb491-172"><a href="estimating-phylogenetic-trees.html#cb491-172" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-173"><a href="estimating-phylogenetic-trees.html#cb491-173" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: Estimated model parameters are at boundary that can cause numerical instability!</span></span>
<span id="cb491-174"><a href="estimating-phylogenetic-trees.html#cb491-174" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-175"><a href="estimating-phylogenetic-trees.html#cb491-175" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER TREE FOUND at iteration 11: -7176.259</span></span>
<span id="cb491-176"><a href="estimating-phylogenetic-trees.html#cb491-176" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model parameters (epsilon = 0.100)</span></span>
<span id="cb491-177"><a href="estimating-phylogenetic-trees.html#cb491-177" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-178"><a href="estimating-phylogenetic-trees.html#cb491-178" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: Estimated model parameters are at boundary that can cause numerical instability!</span></span>
<span id="cb491-179"><a href="estimating-phylogenetic-trees.html#cb491-179" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-180"><a href="estimating-phylogenetic-trees.html#cb491-180" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER TREE FOUND at iteration 13: -7175.959</span></span>
<span id="cb491-181"><a href="estimating-phylogenetic-trees.html#cb491-181" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 20 / LogL: -7176.267 / Time: 0h:0m:3s</span></span>
<span id="cb491-182"><a href="estimating-phylogenetic-trees.html#cb491-182" aria-hidden="true" tabindex="-1"></a><span class="co"># Finish initializing candidate tree set (16)</span></span>
<span id="cb491-183"><a href="estimating-phylogenetic-trees.html#cb491-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Current best tree score: -7175.959 / CPU time: 1.545</span></span>
<span id="cb491-184"><a href="estimating-phylogenetic-trees.html#cb491-184" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of iterations: 20</span></span>
<span id="cb491-185"><a href="estimating-phylogenetic-trees.html#cb491-185" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------------------------</span></span>
<span id="cb491-186"><a href="estimating-phylogenetic-trees.html#cb491-186" aria-hidden="true" tabindex="-1"></a><span class="co"># |               OPTIMIZING CANDIDATE TREE SET                      |</span></span>
<span id="cb491-187"><a href="estimating-phylogenetic-trees.html#cb491-187" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------------------------</span></span>
<span id="cb491-188"><a href="estimating-phylogenetic-trees.html#cb491-188" aria-hidden="true" tabindex="-1"></a><span class="co"># UPDATE BEST LOG-LIKELIHOOD: -7175.952</span></span>
<span id="cb491-189"><a href="estimating-phylogenetic-trees.html#cb491-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 30 / LogL: -7179.103 / Time: 0h:0m:4s (0h:0m:12s left)</span></span>
<span id="cb491-190"><a href="estimating-phylogenetic-trees.html#cb491-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 40 / LogL: -7176.262 / Time: 0h:0m:5s (0h:0m:9s left)</span></span>
<span id="cb491-191"><a href="estimating-phylogenetic-trees.html#cb491-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 50 / LogL: -7175.952 / Time: 0h:0m:5s (0h:0m:7s left)</span></span>
<span id="cb491-192"><a href="estimating-phylogenetic-trees.html#cb491-192" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 60 / LogL: -7176.560 / Time: 0h:0m:6s (0h:0m:5s left)</span></span>
<span id="cb491-193"><a href="estimating-phylogenetic-trees.html#cb491-193" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 70 / LogL: -7180.060 / Time: 0h:0m:6s (0h:0m:4s left)</span></span>
<span id="cb491-194"><a href="estimating-phylogenetic-trees.html#cb491-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 80 / LogL: -7176.560 / Time: 0h:0m:7s (0h:0m:3s left)</span></span>
<span id="cb491-195"><a href="estimating-phylogenetic-trees.html#cb491-195" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 90 / LogL: -7176.793 / Time: 0h:0m:7s (0h:0m:2s left)</span></span>
<span id="cb491-196"><a href="estimating-phylogenetic-trees.html#cb491-196" aria-hidden="true" tabindex="-1"></a><span class="co"># UPDATE BEST LOG-LIKELIHOOD: -7175.950</span></span>
<span id="cb491-197"><a href="estimating-phylogenetic-trees.html#cb491-197" aria-hidden="true" tabindex="-1"></a><span class="co"># UPDATE BEST LOG-LIKELIHOOD: -7175.950</span></span>
<span id="cb491-198"><a href="estimating-phylogenetic-trees.html#cb491-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 100 / LogL: -7175.950 / Time: 0h:0m:8s (0h:0m:1s left)</span></span>
<span id="cb491-199"><a href="estimating-phylogenetic-trees.html#cb491-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 110 / LogL: -7176.560 / Time: 0h:0m:8s (0h:0m:0s left)</span></span>
<span id="cb491-200"><a href="estimating-phylogenetic-trees.html#cb491-200" aria-hidden="true" tabindex="-1"></a><span class="co"># TREE SEARCH COMPLETED AFTER 114 ITERATIONS / Time: 0h:0m:9s</span></span>
<span id="cb491-201"><a href="estimating-phylogenetic-trees.html#cb491-201" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-202"><a href="estimating-phylogenetic-trees.html#cb491-202" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------------------------</span></span>
<span id="cb491-203"><a href="estimating-phylogenetic-trees.html#cb491-203" aria-hidden="true" tabindex="-1"></a><span class="co"># |                    FINALIZING TREE SEARCH                        |</span></span>
<span id="cb491-204"><a href="estimating-phylogenetic-trees.html#cb491-204" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------------------------</span></span>
<span id="cb491-205"><a href="estimating-phylogenetic-trees.html#cb491-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Performs final model parameters optimization</span></span>
<span id="cb491-206"><a href="estimating-phylogenetic-trees.html#cb491-206" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate model parameters (epsilon = 0.010)</span></span>
<span id="cb491-207"><a href="estimating-phylogenetic-trees.html#cb491-207" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Initial log-likelihood: -7175.950</span></span>
<span id="cb491-208"><a href="estimating-phylogenetic-trees.html#cb491-208" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal log-likelihood: -7175.948</span></span>
<span id="cb491-209"><a href="estimating-phylogenetic-trees.html#cb491-209" aria-hidden="true" tabindex="-1"></a><span class="co"># Rate parameters:  A-C: 11.77863  A-G: 100.00000  A-T: 11.77863  C-G: 1.00000  C-T: 100.00000  G-T: 1.00000</span></span>
<span id="cb491-210"><a href="estimating-phylogenetic-trees.html#cb491-210" aria-hidden="true" tabindex="-1"></a><span class="co"># Base frequencies:  A: 0.240  C: 0.266  G: 0.172  T: 0.321</span></span>
<span id="cb491-211"><a href="estimating-phylogenetic-trees.html#cb491-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of invariable sites: 0.596</span></span>
<span id="cb491-212"><a href="estimating-phylogenetic-trees.html#cb491-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Gamma shape alpha: 1.312</span></span>
<span id="cb491-213"><a href="estimating-phylogenetic-trees.html#cb491-213" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters optimization took 1 rounds (0.011 sec)</span></span>
<span id="cb491-214"><a href="estimating-phylogenetic-trees.html#cb491-214" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-215"><a href="estimating-phylogenetic-trees.html#cb491-215" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: Estimated model parameters are at boundary that can cause numerical instability!</span></span>
<span id="cb491-216"><a href="estimating-phylogenetic-trees.html#cb491-216" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-217"><a href="estimating-phylogenetic-trees.html#cb491-217" aria-hidden="true" tabindex="-1"></a><span class="co"># BEST SCORE FOUND : -7175.948</span></span>
<span id="cb491-218"><a href="estimating-phylogenetic-trees.html#cb491-218" aria-hidden="true" tabindex="-1"></a><span class="co"># Total tree length: 2.452</span></span>
<span id="cb491-219"><a href="estimating-phylogenetic-trees.html#cb491-219" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-220"><a href="estimating-phylogenetic-trees.html#cb491-220" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of iterations: 114</span></span>
<span id="cb491-221"><a href="estimating-phylogenetic-trees.html#cb491-221" aria-hidden="true" tabindex="-1"></a><span class="co"># CPU time used for tree search: 6.683 sec (0h:0m:6s)</span></span>
<span id="cb491-222"><a href="estimating-phylogenetic-trees.html#cb491-222" aria-hidden="true" tabindex="-1"></a><span class="co"># Wall-clock time used for tree search: 6.730 sec (0h:0m:6s)</span></span>
<span id="cb491-223"><a href="estimating-phylogenetic-trees.html#cb491-223" aria-hidden="true" tabindex="-1"></a><span class="co"># Total CPU time used: 9.078 sec (0h:0m:9s)</span></span>
<span id="cb491-224"><a href="estimating-phylogenetic-trees.html#cb491-224" aria-hidden="true" tabindex="-1"></a><span class="co"># Total wall-clock time used: 9.182 sec (0h:0m:9s)</span></span>
<span id="cb491-225"><a href="estimating-phylogenetic-trees.html#cb491-225" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-226"><a href="estimating-phylogenetic-trees.html#cb491-226" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysis results written to: </span></span>
<span id="cb491-227"><a href="estimating-phylogenetic-trees.html#cb491-227" aria-hidden="true" tabindex="-1"></a><span class="co">#   IQ-TREE report:                Ameerega_aligned_end.fasta.iqtree</span></span>
<span id="cb491-228"><a href="estimating-phylogenetic-trees.html#cb491-228" aria-hidden="true" tabindex="-1"></a><span class="co">#   Maximum-likelihood tree:       Ameerega_aligned_end.fasta.treefile</span></span>
<span id="cb491-229"><a href="estimating-phylogenetic-trees.html#cb491-229" aria-hidden="true" tabindex="-1"></a><span class="co">#   Likelihood distances:          Ameerega_aligned_end.fasta.mldist</span></span>
<span id="cb491-230"><a href="estimating-phylogenetic-trees.html#cb491-230" aria-hidden="true" tabindex="-1"></a><span class="co">#   Screen log file:               Ameerega_aligned_end.fasta.log</span></span>
<span id="cb491-231"><a href="estimating-phylogenetic-trees.html#cb491-231" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-232"><a href="estimating-phylogenetic-trees.html#cb491-232" aria-hidden="true" tabindex="-1"></a><span class="co"># Date and Time: Tue Feb 23 17:46:41 2021</span></span>
<span id="cb491-233"><a href="estimating-phylogenetic-trees.html#cb491-233" aria-hidden="true" tabindex="-1"></a><span class="co"># #***** DONE ***** </span></span>
<span id="cb491-234"><a href="estimating-phylogenetic-trees.html#cb491-234" aria-hidden="true" tabindex="-1"></a><span class="co"># #</span></span>
<span id="cb491-235"><a href="estimating-phylogenetic-trees.html#cb491-235" aria-hidden="true" tabindex="-1"></a><span class="co"># # *************         iqtree outfiles written to        ************* </span></span>
<span id="cb491-236"><a href="estimating-phylogenetic-trees.html#cb491-236" aria-hidden="true" tabindex="-1"></a><span class="co"># #[1] &quot;/Users/santosj/Desktop/Teach_R/my_working_directory/my_phylogeny_1&quot;</span></span></code></pre></div>
<p>The following files will be now present in your working directory.</p>
<p><img src="figures/session_12_figs/12_output_directory.png" width="90%" /></p>
<p><strong>e)</strong> You can visualize the resulting phylogenetic tree as follows.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="estimating-phylogenetic-trees.html#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="do">## content of output object.</span></span>
<span id="cb492-2"><a href="estimating-phylogenetic-trees.html#cb492-2" aria-hidden="true" tabindex="-1"></a>COI_simple_phylogeny</span>
<span id="cb492-3"><a href="estimating-phylogenetic-trees.html#cb492-3" aria-hidden="true" tabindex="-1"></a><span class="co">#[[1]]</span></span>
<span id="cb492-4"><a href="estimating-phylogenetic-trees.html#cb492-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb492-5"><a href="estimating-phylogenetic-trees.html#cb492-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Phylogenetic tree with 24 tips and 22 internal nodes.</span></span>
<span id="cb492-6"><a href="estimating-phylogenetic-trees.html#cb492-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb492-7"><a href="estimating-phylogenetic-trees.html#cb492-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Tip labels:</span></span>
<span id="cb492-8"><a href="estimating-phylogenetic-trees.html#cb492-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  MW042032.1, MW042031.1, DQ502932.1, DQ502902.1, DQ502922.1, DQ502929.1, ...</span></span>
<span id="cb492-9"><a href="estimating-phylogenetic-trees.html#cb492-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb492-10"><a href="estimating-phylogenetic-trees.html#cb492-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Unrooted; includes branch lengths.</span></span>
<span id="cb492-11"><a href="estimating-phylogenetic-trees.html#cb492-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-12"><a href="estimating-phylogenetic-trees.html#cb492-12" aria-hidden="true" tabindex="-1"></a>COI_simple_phylogeny[[<span class="dv">1</span>]]</span>
<span id="cb492-13"><a href="estimating-phylogenetic-trees.html#cb492-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Phylogenetic tree with 24 tips and 22 internal nodes.</span></span>
<span id="cb492-14"><a href="estimating-phylogenetic-trees.html#cb492-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb492-15"><a href="estimating-phylogenetic-trees.html#cb492-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Tip labels:</span></span>
<span id="cb492-16"><a href="estimating-phylogenetic-trees.html#cb492-16" aria-hidden="true" tabindex="-1"></a><span class="co">#  MW042032.1, MW042031.1, DQ502932.1, DQ502902.1, DQ502922.1, DQ502929.1, ...</span></span>
<span id="cb492-17"><a href="estimating-phylogenetic-trees.html#cb492-17" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb492-18"><a href="estimating-phylogenetic-trees.html#cb492-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Unrooted; includes branch lengths.</span></span>
<span id="cb492-19"><a href="estimating-phylogenetic-trees.html#cb492-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-20"><a href="estimating-phylogenetic-trees.html#cb492-20" aria-hidden="true" tabindex="-1"></a><span class="do">## you can plot this tree using ape</span></span>
<span id="cb492-21"><a href="estimating-phylogenetic-trees.html#cb492-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(COI_simple_phylogeny[[<span class="dv">1</span>]])</span></code></pre></div>
<p><img src="figures/session_12_figs/13_output_phylogeny.png" width="90%" />
The actual phylogenetic tree is in the file <code>Ameerega_aligned_end.fasta.treefile</code> in our working folder.</p>
</div>
<div id="one-marker-and-with-partitions" class="section level2" number="12.7">
<h2><span class="header-section-number">12.7</span> One marker and with partitions</h2>
<p>You provide a partition for your sequences based on information about it. For example, you can divide a protein coding gene in three sections based on the codon position. As it has been demonstrated, the codon code is redundant and variations in 3rd positions usually result in the same amino acid residue after translation, for more information see <a href="https://en.wikipedia.org/wiki/DNA_and_RNA_codon_tables" target="_blank"><strong>here</strong></a>. In our example, we can split our split our COI matrix by codon position.</p>
<p><strong>5)</strong> We will use the COI aligned sequences in the file <code>Ameerega_aligned_end.fasta</code>. Notice the argument <code>iqtree_partition_user = list(COI = c("DNA",1,1539,3))</code>. We define it a <code>DNA</code> segment, starting on position <code>1</code>, ending on position <code>1539</code> (this number can be find in <strong>Session 11.7</strong> or just by counting the number of bases on the aligned matrix) and <code>3</code> that means to divide it by 3 for 1st, 2nd, and 3rd codon positions.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="estimating-phylogenetic-trees.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="do">## set up a new working directory</span></span>
<span id="cb493-2"><a href="estimating-phylogenetic-trees.html#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;~/Desktop/Teach_R/my_working_directory/my_phylogeny_2&quot;</span>)</span>
<span id="cb493-3"><a href="estimating-phylogenetic-trees.html#cb493-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-4"><a href="estimating-phylogenetic-trees.html#cb493-4" aria-hidden="true" tabindex="-1"></a><span class="do">## copy as paste again the sequence data</span></span>
<span id="cb493-5"><a href="estimating-phylogenetic-trees.html#cb493-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-6"><a href="estimating-phylogenetic-trees.html#cb493-6" aria-hidden="true" tabindex="-1"></a><span class="do">## update the </span></span>
<span id="cb493-7"><a href="estimating-phylogenetic-trees.html#cb493-7" aria-hidden="true" tabindex="-1"></a>my_path_to_aligned_sequences2 <span class="ot">&lt;-</span> <span class="st">&quot;~/Desktop/Teach_R/my_working_directory/my_phylogeny_2/Ameerega_aligned_end.fasta&quot;</span></span>
<span id="cb493-8"><a href="estimating-phylogenetic-trees.html#cb493-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-9"><a href="estimating-phylogenetic-trees.html#cb493-9" aria-hidden="true" tabindex="-1"></a><span class="do">## iqtree2 run with defined codon positions</span></span>
<span id="cb493-10"><a href="estimating-phylogenetic-trees.html#cb493-10" aria-hidden="true" tabindex="-1"></a>COI_with_partitions_phylogeny <span class="ot">&lt;-</span> <span class="fu">iqtree_runner_R</span> (<span class="at">input_alignment_file_user =</span> my_path_to_aligned_sequences2,</span>
<span id="cb493-11"><a href="estimating-phylogenetic-trees.html#cb493-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_bin_location_user =</span> my_path_to_iqtree2,</span>
<span id="cb493-12"><a href="estimating-phylogenetic-trees.html#cb493-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">run_iqtree_call_user =</span> <span class="st">&quot;serial&quot;</span>,</span>
<span id="cb493-13"><a href="estimating-phylogenetic-trees.html#cb493-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_input_model_m_user =</span> <span class="st">&quot;MFP+MERGE&quot;</span>,</span>
<span id="cb493-14"><a href="estimating-phylogenetic-trees.html#cb493-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">iqtree_partition_user =</span> <span class="fu">list</span>(<span class="at">COI =</span> <span class="fu">c</span>(<span class="st">&quot;DNA&quot;</span>,<span class="dv">1</span>,<span class="dv">1539</span>,<span class="dv">3</span>)),</span>
<span id="cb493-15"><a href="estimating-phylogenetic-trees.html#cb493-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">iqtree_partition_if_by_position_user =</span> <span class="cn">TRUE</span>)</span>
<span id="cb493-16"><a href="estimating-phylogenetic-trees.html#cb493-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-17"><a href="estimating-phylogenetic-trees.html#cb493-17" aria-hidden="true" tabindex="-1"></a><span class="do">## see and plot the new tree</span></span>
<span id="cb493-18"><a href="estimating-phylogenetic-trees.html#cb493-18" aria-hidden="true" tabindex="-1"></a>COI_with_partitions_phylogeny[[<span class="dv">1</span>]]</span>
<span id="cb493-19"><a href="estimating-phylogenetic-trees.html#cb493-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Phylogenetic tree with 24 tips and 22 internal nodes.</span></span>
<span id="cb493-20"><a href="estimating-phylogenetic-trees.html#cb493-20" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb493-21"><a href="estimating-phylogenetic-trees.html#cb493-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Tip labels:</span></span>
<span id="cb493-22"><a href="estimating-phylogenetic-trees.html#cb493-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  MW042032.1, MW042031.1, DQ502932.1, DQ502902.1, DQ502922.1, DQ502929.1, ...</span></span>
<span id="cb493-23"><a href="estimating-phylogenetic-trees.html#cb493-23" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb493-24"><a href="estimating-phylogenetic-trees.html#cb493-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Unrooted; includes branch lengths.</span></span>
<span id="cb493-25"><a href="estimating-phylogenetic-trees.html#cb493-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(COI_with_partitions_phylogeny[[<span class="dv">1</span>]])</span></code></pre></div>
<p><img src="figures/session_12_figs/14_output_phylogeny2.png" width="90%" /></p>
<p>The actual phylogenetic tree is in the file <code>Ameerega_aligned_end_fasta_partition.txt.treefile</code> in our working folder.</p>
</div>
<div id="bootstrap-support" class="section level2" number="12.8">
<h2><span class="header-section-number">12.8</span> Bootstrap support</h2>
<p><strong>6)</strong> In most cases, you also want to know how reliable is your phylogenetic reconstruction. This is determined by the statistical support of the nodes (the internal junctions of lines). These are usually evaluated over 100% based on the type of the approach used by <strong>iqtree2</strong>, which means that such phylogenetic relationships are very reliable. If values are less than 75%, your confidence drops significantly and usually means conflicting hypotheses about the evolutionary relationships for that node. We will use the COI aligned sequences in the file <code>Ameerega_aligned_end.fasta</code>. Notice the arguments <code>iqtree_UFBoot_B_user = 1000</code> and <code>iqtree_UFBoot_bnni_user = TRUE</code>. This will ask for 1000 non-parametric bootstraps with corrections, for details see <a href="http://www.iqtree.org/doc/Tutorial#assessing-branch-supports-with--standard-nonparametric-bootstrap" target="_blank"><strong>here</strong></a>.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="estimating-phylogenetic-trees.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="do">## set up a new working directory</span></span>
<span id="cb494-2"><a href="estimating-phylogenetic-trees.html#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;~/Desktop/Teach_R/my_working_directory/my_phylogeny_3&quot;</span>)</span>
<span id="cb494-3"><a href="estimating-phylogenetic-trees.html#cb494-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb494-4"><a href="estimating-phylogenetic-trees.html#cb494-4" aria-hidden="true" tabindex="-1"></a><span class="do">## copy as paste again the sequence data</span></span>
<span id="cb494-5"><a href="estimating-phylogenetic-trees.html#cb494-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb494-6"><a href="estimating-phylogenetic-trees.html#cb494-6" aria-hidden="true" tabindex="-1"></a><span class="do">## update the </span></span>
<span id="cb494-7"><a href="estimating-phylogenetic-trees.html#cb494-7" aria-hidden="true" tabindex="-1"></a>my_path_to_aligned_sequences3 <span class="ot">&lt;-</span> <span class="st">&quot;~/Desktop/Teach_R/my_working_directory/my_phylogeny_3/Ameerega_aligned_end.fasta&quot;</span></span>
<span id="cb494-8"><a href="estimating-phylogenetic-trees.html#cb494-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb494-9"><a href="estimating-phylogenetic-trees.html#cb494-9" aria-hidden="true" tabindex="-1"></a><span class="do">## iqtree2 run with defined codon positions and get 1000 bootstraps</span></span>
<span id="cb494-10"><a href="estimating-phylogenetic-trees.html#cb494-10" aria-hidden="true" tabindex="-1"></a>COI_with_partitions_phylogeny_boot <span class="ot">&lt;-</span> <span class="fu">iqtree_runner_R</span> (<span class="at">input_alignment_file_user =</span> my_path_to_aligned_sequences3,</span>
<span id="cb494-11"><a href="estimating-phylogenetic-trees.html#cb494-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_bin_location_user =</span> my_path_to_iqtree2,</span>
<span id="cb494-12"><a href="estimating-phylogenetic-trees.html#cb494-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">run_iqtree_call_user =</span> <span class="st">&quot;serial&quot;</span>,</span>
<span id="cb494-13"><a href="estimating-phylogenetic-trees.html#cb494-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_input_model_m_user =</span> <span class="st">&quot;GTR+F+I+G4&quot;</span>,</span>
<span id="cb494-14"><a href="estimating-phylogenetic-trees.html#cb494-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_UFBoot_B_user =</span> <span class="dv">1000</span>,</span>
<span id="cb494-15"><a href="estimating-phylogenetic-trees.html#cb494-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_UFBoot_bnni_user =</span> <span class="cn">TRUE</span>,</span>
<span id="cb494-16"><a href="estimating-phylogenetic-trees.html#cb494-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">iqtree_partition_user =</span> <span class="fu">list</span>(<span class="at">COI =</span> <span class="fu">c</span>(<span class="st">&quot;DNA&quot;</span>,<span class="dv">1</span>,<span class="dv">1539</span>,<span class="dv">3</span>)),</span>
<span id="cb494-17"><a href="estimating-phylogenetic-trees.html#cb494-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">iqtree_partition_if_by_position_user =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The actual collection of bootstrap trees is in the file <code>Ameerega_aligned_end_fasta_partition.txt.ufboot</code> and its consensus is in the file <code>Ameerega_aligned_end_fasta_partition.txt.treefile</code> in our working folder.</p>
<p><strong>7)</strong> I could not find an easy way to visualize these threes other than use the other program to visualize phylogenetic trees in general. You need to install <a href="http://tree.bio.ed.ac.uk/software/figtree/" target="_blank"><strong>figtree</strong></a>. To visualize your consensus tree after installing <strong>figtree</strong> you need open this program.</p>
<p><img src="figures/session_12_figs/15_open_figtree.png" width="90%" /></p>
<p>The <code>File&gt;Open...</code> find the bootstrap summary file <code>Ameerega_aligned_end_fasta_partition.txt.treefile</code> and allow to see labels.</p>
<p><img src="figures/session_12_figs/16_open_figtree_labels.png" width="90%" /></p>
<p>You will see your tree, but without the nodal support.</p>
<p><img src="figures/session_12_figs/17_open_figtree_no_support.png" width="90%" /></p>
<p>You will clikc on <code>Nodel Labels</code> and then on <code>label</code>.</p>
<p><img src="figures/session_12_figs/18_open_figtree_no_support2.png" width="90%" /></p>
<p>This will show you the bootstraps for your tree.</p>
<p><img src="figures/session_12_figs/19_open_figtree_with_support.png" width="90%" /></p>
</div>
<div id="many-markers-and-with-partitions" class="section level2" number="12.9">
<h2><span class="header-section-number">12.9</span> Many markers and with partitions</h2>
<p><strong>8)</strong> A phylogeny derived from two or more markers require some modifications to indicate the start and end of each marker.</p>
<p>We start by defining the output directory.</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="estimating-phylogenetic-trees.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="do">## set up a new working directory by creating one; this is exclusive to your OWN COMPUTER change it accordingly</span></span>
<span id="cb495-2"><a href="estimating-phylogenetic-trees.html#cb495-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;~/Desktop/Teach_R/my_working_directory/my_phylogeny_4&quot;</span>)</span></code></pre></div>
<p>We find the file with aligned sequences: <code>my_collected_COI_CYTB_String_path_fasta</code> and copy that file to your working directory (e.g., <code>my_phylogeny_4</code>)</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="estimating-phylogenetic-trees.html#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="do">## copy the file my_collected_COI_CYTB_String_path_fasta to your working directory my_phylogeny_4</span></span>
<span id="cb496-2"><a href="estimating-phylogenetic-trees.html#cb496-2" aria-hidden="true" tabindex="-1"></a><span class="do">## this is the path to that file and exclusive to your OWN COMPUTER change it accordingly</span></span>
<span id="cb496-3"><a href="estimating-phylogenetic-trees.html#cb496-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-4"><a href="estimating-phylogenetic-trees.html#cb496-4" aria-hidden="true" tabindex="-1"></a>my_path_to_aligned_COI_CYTB_sequences <span class="ot">&lt;-</span> <span class="st">&quot;~/Desktop/Teach_R/my_working_directory/my_phylogeny_4/my_collected_COI_CYTB_String_path_fasta.txt&quot;</span></span></code></pre></div>
<p>We run <code>iqtree2</code> and notice the <code>iqtree_partition_user</code> argument that defines the <code>COI</code> and <code>CYTB</code> markers. We define both as <code>DNA</code> segments. For COI, we define the starting on position of COI at <code>1</code> and the ending on position at <code>1539</code> (this number can be find in <strong>Session 11.7</strong> or just by counting the number of bases on the aligned matrix). For CYTB, we check first the that the length of this maker is 944 (see <strong>Session 11.9</strong>) and we concatenated this maker after COI, then we add 1539 + 944 = 2483. However, the CYTB gene does not start on base 1539 but on 1540, so we add 1. Therefore, we define the starting on position of CYTB at <code>1540</code> and the ending on position at <code>2483</code>. Finally, the <code>3</code> on the <code>iqtree_partition_user</code> argument means to divide it by 3 for 1st, 2nd, and 3rd codon positions.</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="estimating-phylogenetic-trees.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="do">## this is exclusive to your OWN COMPUTER and we just need the path to the directory that contains iqtree2</span></span>
<span id="cb497-2"><a href="estimating-phylogenetic-trees.html#cb497-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Note: the diffecent from path above and the one below.</span></span>
<span id="cb497-3"><a href="estimating-phylogenetic-trees.html#cb497-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-4"><a href="estimating-phylogenetic-trees.html#cb497-4" aria-hidden="true" tabindex="-1"></a>my_path_to_iqtree2 <span class="ot">&lt;-</span> <span class="st">&quot;~/Desktop/Teach_R/class_pages_reference/bioinformatics_gitbook_1/my_programs&quot;</span></span>
<span id="cb497-5"><a href="estimating-phylogenetic-trees.html#cb497-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-6"><a href="estimating-phylogenetic-trees.html#cb497-6" aria-hidden="true" tabindex="-1"></a><span class="do">## iqtree2 run with defined codon positions</span></span>
<span id="cb497-7"><a href="estimating-phylogenetic-trees.html#cb497-7" aria-hidden="true" tabindex="-1"></a>COI_CYTB_with_partitions_phylogeny <span class="ot">&lt;-</span> <span class="fu">iqtree_runner_R</span> (<span class="at">input_alignment_file_user =</span> my_path_to_aligned_COI_CYTB_sequences,</span>
<span id="cb497-8"><a href="estimating-phylogenetic-trees.html#cb497-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_bin_location_user =</span> my_path_to_iqtree2,</span>
<span id="cb497-9"><a href="estimating-phylogenetic-trees.html#cb497-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">run_iqtree_call_user =</span> <span class="st">&quot;serial&quot;</span>,</span>
<span id="cb497-10"><a href="estimating-phylogenetic-trees.html#cb497-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqtree_input_model_m_user =</span> <span class="st">&quot;MFP+MERGE&quot;</span>,</span>
<span id="cb497-11"><a href="estimating-phylogenetic-trees.html#cb497-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">iqtree_partition_user =</span> <span class="fu">list</span>(<span class="at">COI =</span> <span class="fu">c</span>(<span class="st">&quot;DNA&quot;</span>,<span class="dv">1</span>,<span class="dv">1539</span>,<span class="dv">3</span>),</span>
<span id="cb497-12"><a href="estimating-phylogenetic-trees.html#cb497-12" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">CYTB =</span> <span class="fu">c</span>(<span class="st">&quot;DNA&quot;</span>,<span class="dv">1540</span>,<span class="dv">2483</span>,<span class="dv">3</span>)),</span>
<span id="cb497-13"><a href="estimating-phylogenetic-trees.html#cb497-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">iqtree_partition_if_by_position_user =</span> <span class="cn">TRUE</span>)</span>
<span id="cb497-14"><a href="estimating-phylogenetic-trees.html#cb497-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-15"><a href="estimating-phylogenetic-trees.html#cb497-15" aria-hidden="true" tabindex="-1"></a><span class="do">## see and plot the new tree</span></span>
<span id="cb497-16"><a href="estimating-phylogenetic-trees.html#cb497-16" aria-hidden="true" tabindex="-1"></a>COI_CYTB_with_partitions_phylogeny[[<span class="dv">1</span>]]</span>
<span id="cb497-17"><a href="estimating-phylogenetic-trees.html#cb497-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-18"><a href="estimating-phylogenetic-trees.html#cb497-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Phylogenetic tree with 12 tips and 10 internal nodes.</span></span>
<span id="cb497-19"><a href="estimating-phylogenetic-trees.html#cb497-19" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb497-20"><a href="estimating-phylogenetic-trees.html#cb497-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Tip labels:</span></span>
<span id="cb497-21"><a href="estimating-phylogenetic-trees.html#cb497-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  Ameerega_bilinguis, Ameerega_braccata, Ameerega_hahneli, Ameerega_trivittata, Ameerega_silverstonei, Ameerega_parvula, ...</span></span>
<span id="cb497-22"><a href="estimating-phylogenetic-trees.html#cb497-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb497-23"><a href="estimating-phylogenetic-trees.html#cb497-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Unrooted; includes branch lengths.</span></span>
<span id="cb497-24"><a href="estimating-phylogenetic-trees.html#cb497-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-25"><a href="estimating-phylogenetic-trees.html#cb497-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(COI_CYTB_with_partitions_phylogeny[[<span class="dv">1</span>]])</span></code></pre></div>
<p><img src="figures/session_12_figs/20_output_two_markers.png" width="90%" /></p>
<p>The actual phylogenetic tree is in the file <code>my_collected_COI_CYTB_String_path_fasta_txt_partition.txt.treefile</code> in our working folder.</p>
</div>
<div id="other-sequence-phylogenetic-tree-estimation-software" class="section level2" number="12.10">
<h2><span class="header-section-number">12.10</span> Other sequence phylogenetic tree estimation software</h2>
<p><strong>9)</strong> Other widely used programs that can do phylogenetic estimations are as follows. You need to follow their vignettes and installation instructions.</p>
<p><strong>a)</strong> <a href="https://github.com/stamatak/standard-RAxML" target="_blank"><strong>RAxML</strong></a>. A manual and tutorial is provided in <a href="https://cme.h-its.org/exelixis/resource/download/NewManual.pdf" target="_blank"><strong>here</strong></a>. General info, vignettes and a GUI interface are also provided <a href="https://cme.h-its.org/exelixis/web/software/raxml/" target="_blank"><strong>here</strong></a>. An online version is provided also <a href="https://raxml-ng.vital-it.ch/#/" target="_blank"><strong>here</strong></a>.</p>
<p><strong>b)</strong> <a href="http://www.atgc-montpellier.fr/phyml/" target="_blank"><strong>PhyML 3.0</strong></a>. A GitHub repository associated is <a href="https://github.com/stephaneguindon/phyml" target="_blank"><strong>here</strong></a>. This software manual is <a href="https://github.com/stephaneguindon/phyml/blob/master/doc/phyml-manual.pdf" target="_blank"><strong>here</strong></a>.</p>
</div>
<div id="drawing-phylogenetic-trees-with-ggtree" class="section level2" number="12.11">
<h2><span class="header-section-number">12.11</span> Drawing phylogenetic trees with <code>ggtree</code></h2>
<p>In most instances you want to draw a phylogenetic tree for your publications, presentations or to visualize taxon/sequence relationships. A phylogenetic tree is graph or diagram that illustrates such relationships usually among organisms (or sequences of nucleotides/proteins that represent them). Each of these diagrams represent hypotheses of relationship derived from the data used to construct them (i.e., it might change if more data are added). Using R, you can plot these phylogenetic trees and noticing the pattern of branching, grouping and the relationship of tips (sources of data) from the series of common ancestors in the nodes of these diagrams. You can read this friendly summary by <a href="https://evolution-outreach.biomedcentral.com/articles/10.1007/s12052-010-0273-6" target="_blank"><strong>McLennan 2010</strong></a>, which provides an easy guide of how to read a phylogenetic tree. You can plot trees using diverse R packages such as <a href="https://cran.r-project.org/web/packages/ape/index.html" target="_blank"><strong>ape</strong></a>, <a href="https://cran.r-project.org/web/packages/phylotools/index.html" target="_blank"><strong>phylotools</strong></a>, and <a href="https://bioconductor.org/packages/release/bioc/html/ggtree.html" target="_blank"><strong>ggtree</strong></a>. We will use <a href="https://bioconductor.org/packages/release/bioc/html/ggtree.html" target="_blank"><strong>ggtree</strong></a> as this one uses many of the strengths of <strong>ggplot</strong> for most of color and graph manipulations. Likewise, it has a extensive <a href="https://yulab-smu.top/treedata-book/" target="_blank"><strong>vignette</strong></a> that make tree plotting easy.</p>
<p><strong>10)</strong> You will need to install <strong>ggtree</strong> and the tree parsing package <a href="http://bioconductor.org/packages/release/bioc/html/treeio.html" target="_blank"><strong>treeio</strong></a> from <strong>Bioconductor</strong> and have a tree file to be plotted. The package <strong>treeio</strong> provides an extensive list of formats to <a href="https://yulab-smu.top/treedata-book/chapter1.html" target="_blank"><strong>import</strong></a>. We will use the functions <code>read.newick</code> or <code>read.tree</code> to import a newick tree (the format that we get from iqtree2). For trees with support values for iqtree we will use <code>read.iqtree</code> to allow parsing IQ-Tree newick string, with ability to parse SH-aLRT and UFBoot support values.</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="estimating-phylogenetic-trees.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="do">## we will install ggtree</span></span>
<span id="cb498-2"><a href="estimating-phylogenetic-trees.html#cb498-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb498-3"><a href="estimating-phylogenetic-trees.html#cb498-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)</span>
<span id="cb498-4"><a href="estimating-phylogenetic-trees.html#cb498-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-5"><a href="estimating-phylogenetic-trees.html#cb498-5" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;ggtree&quot;</span>)</span>
<span id="cb498-6"><a href="estimating-phylogenetic-trees.html#cb498-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtree)</span>
<span id="cb498-7"><a href="estimating-phylogenetic-trees.html#cb498-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-8"><a href="estimating-phylogenetic-trees.html#cb498-8" aria-hidden="true" tabindex="-1"></a><span class="do">## we also need treeio</span></span>
<span id="cb498-9"><a href="estimating-phylogenetic-trees.html#cb498-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb498-10"><a href="estimating-phylogenetic-trees.html#cb498-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)</span>
<span id="cb498-11"><a href="estimating-phylogenetic-trees.html#cb498-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-12"><a href="estimating-phylogenetic-trees.html#cb498-12" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;treeio&quot;</span>)</span>
<span id="cb498-13"><a href="estimating-phylogenetic-trees.html#cb498-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treeio)</span>
<span id="cb498-14"><a href="estimating-phylogenetic-trees.html#cb498-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-15"><a href="estimating-phylogenetic-trees.html#cb498-15" aria-hidden="true" tabindex="-1"></a><span class="do">## we can import a regular iqtree file </span></span>
<span id="cb498-16"><a href="estimating-phylogenetic-trees.html#cb498-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Notice: the extionsion is *.treefile</span></span>
<span id="cb498-17"><a href="estimating-phylogenetic-trees.html#cb498-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-18"><a href="estimating-phylogenetic-trees.html#cb498-18" aria-hidden="true" tabindex="-1"></a>my_tree_file_path <span class="ot">&lt;-</span> <span class="st">&quot;~/Desktop/Teach_R/class_pages_reference/bioinformatics_gitbook_1/my_working_directory/my_phylogeny_1/Ameerega_aligned_end.fasta.treefile&quot;</span></span>
<span id="cb498-19"><a href="estimating-phylogenetic-trees.html#cb498-19" aria-hidden="true" tabindex="-1"></a>my_tree <span class="ot">&lt;-</span> <span class="fu">read.newick</span>(my_tree_file_path)</span>
<span id="cb498-20"><a href="estimating-phylogenetic-trees.html#cb498-20" aria-hidden="true" tabindex="-1"></a>my_tree</span>
<span id="cb498-21"><a href="estimating-phylogenetic-trees.html#cb498-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Phylogenetic tree with 24 tips and 22 internal nodes.</span></span>
<span id="cb498-22"><a href="estimating-phylogenetic-trees.html#cb498-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb498-23"><a href="estimating-phylogenetic-trees.html#cb498-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Tip labels:</span></span>
<span id="cb498-24"><a href="estimating-phylogenetic-trees.html#cb498-24" aria-hidden="true" tabindex="-1"></a><span class="co">#  MW042032.1, MW042031.1, DQ502932.1, DQ502902.1, DQ502922.1, DQ502929.1, ...</span></span>
<span id="cb498-25"><a href="estimating-phylogenetic-trees.html#cb498-25" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb498-26"><a href="estimating-phylogenetic-trees.html#cb498-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Unrooted; includes branch lengths.</span></span>
<span id="cb498-27"><a href="estimating-phylogenetic-trees.html#cb498-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-28"><a href="estimating-phylogenetic-trees.html#cb498-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-29"><a href="estimating-phylogenetic-trees.html#cb498-29" aria-hidden="true" tabindex="-1"></a><span class="do">## we can import the bootstrap summary of iqtree file </span></span>
<span id="cb498-30"><a href="estimating-phylogenetic-trees.html#cb498-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Notice: the extionsion is *txt.treefile</span></span>
<span id="cb498-31"><a href="estimating-phylogenetic-trees.html#cb498-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb498-32"><a href="estimating-phylogenetic-trees.html#cb498-32" aria-hidden="true" tabindex="-1"></a>my_tree_boot_file_path <span class="ot">&lt;-</span> <span class="st">&quot;~/Desktop/Teach_R/class_pages_reference/bioinformatics_gitbook_1/my_working_directory/my_phylogeny_3/Ameerega_aligned_end_fasta_partition.txt.treefile&quot;</span></span>
<span id="cb498-33"><a href="estimating-phylogenetic-trees.html#cb498-33" aria-hidden="true" tabindex="-1"></a>my_tree_boot <span class="ot">&lt;-</span> <span class="fu">read.iqtree</span>(my_tree_boot_file_path)</span>
<span id="cb498-34"><a href="estimating-phylogenetic-trees.html#cb498-34" aria-hidden="true" tabindex="-1"></a>my_tree_boot</span>
<span id="cb498-35"><a href="estimating-phylogenetic-trees.html#cb498-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;treedata&#39; S4 object that stored information of</span></span>
<span id="cb498-36"><a href="estimating-phylogenetic-trees.html#cb498-36" aria-hidden="true" tabindex="-1"></a><span class="co">#  &#39;~/Desktop/Teach_R/class_pages_reference/bioinformatics_gitbook_1/my_working_directory/my_phylogeny_3/Ameerega_aligned_end_fasta_partition.txt.treefile&#39;.</span></span>
<span id="cb498-37"><a href="estimating-phylogenetic-trees.html#cb498-37" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb498-38"><a href="estimating-phylogenetic-trees.html#cb498-38" aria-hidden="true" tabindex="-1"></a><span class="co">#...@ phylo: </span></span>
<span id="cb498-39"><a href="estimating-phylogenetic-trees.html#cb498-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Phylogenetic tree with 24 tips and 22 internal nodes.</span></span>
<span id="cb498-40"><a href="estimating-phylogenetic-trees.html#cb498-40" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb498-41"><a href="estimating-phylogenetic-trees.html#cb498-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Tip labels:</span></span>
<span id="cb498-42"><a href="estimating-phylogenetic-trees.html#cb498-42" aria-hidden="true" tabindex="-1"></a><span class="co">#  MW042032.1, MW042031.1, DQ502932.1, DQ502902.1, DQ502922.1, DQ502929.1, ...</span></span>
<span id="cb498-43"><a href="estimating-phylogenetic-trees.html#cb498-43" aria-hidden="true" tabindex="-1"></a><span class="co">#Node labels:</span></span>
<span id="cb498-44"><a href="estimating-phylogenetic-trees.html#cb498-44" aria-hidden="true" tabindex="-1"></a><span class="co">#  , 69, 33, 48, 29, 94, ...</span></span>
<span id="cb498-45"><a href="estimating-phylogenetic-trees.html#cb498-45" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb498-46"><a href="estimating-phylogenetic-trees.html#cb498-46" aria-hidden="true" tabindex="-1"></a><span class="co">#Unrooted; includes branch lengths.</span></span>
<span id="cb498-47"><a href="estimating-phylogenetic-trees.html#cb498-47" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb498-48"><a href="estimating-phylogenetic-trees.html#cb498-48" aria-hidden="true" tabindex="-1"></a><span class="co">#with the following features available:</span></span>
<span id="cb498-49"><a href="estimating-phylogenetic-trees.html#cb498-49" aria-hidden="true" tabindex="-1"></a><span class="co">#  &#39;SH_aLRT&#39;,  &#39;UFboot&#39;.</span></span></code></pre></div>
<p><strong>11)</strong> Basic tree plots in <strong>ggtree</strong> are straight forward as if they were ggplot objects.</p>
<p>Here, we will plot both trees. Add the following names/labels to our tree. To add tip labels use <code>geom_tiplab()</code> and bootstrap values <code>geom_label2()</code>. In the latter, we indicate that we will use the node labels named <code>label</code>, as a numeric value and only show those that are more than 75. We also added a scale with <code>geom_treescale()</code>.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="estimating-phylogenetic-trees.html#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="do">## make sure that we load cowplot</span></span>
<span id="cb499-2"><a href="estimating-phylogenetic-trees.html#cb499-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-3"><a href="estimating-phylogenetic-trees.html#cb499-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(cowplot)</span>
<span id="cb499-4"><a href="estimating-phylogenetic-trees.html#cb499-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-5"><a href="estimating-phylogenetic-trees.html#cb499-5" aria-hidden="true" tabindex="-1"></a><span class="do">## save to an object a both tree</span></span>
<span id="cb499-6"><a href="estimating-phylogenetic-trees.html#cb499-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-7"><a href="estimating-phylogenetic-trees.html#cb499-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggtree</span>(my_tree, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">geom_tiplab</span>(<span class="at">size=</span><span class="fl">1.7</span>, <span class="at">color=</span><span class="st">&#39;blue&#39;</span>) <span class="sc">+</span> <span class="fu">geom_treescale</span>(<span class="at">fontsize=</span><span class="dv">4</span>, <span class="at">linesize=</span><span class="dv">1</span>, <span class="at">offset=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb499-8"><a href="estimating-phylogenetic-trees.html#cb499-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggtree</span>(my_tree_boot) <span class="sc">+</span> <span class="fu">geom_tiplab</span>(<span class="at">size=</span><span class="fl">1.7</span>) <span class="sc">+</span> <span class="fu">geom_label2</span>(<span class="fu">aes</span>(<span class="at">label=</span>label, <span class="at">subset =</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">as.numeric</span>(label)) <span class="sc">&amp;</span> <span class="fu">as.numeric</span>(label) <span class="sc">&gt;</span> <span class="dv">75</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">geom_treescale</span>(<span class="at">fontsize=</span><span class="dv">4</span>, <span class="at">linesize=</span><span class="dv">1</span>, <span class="at">offset=</span><span class="dv">1</span>)</span>
<span id="cb499-9"><a href="estimating-phylogenetic-trees.html#cb499-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-10"><a href="estimating-phylogenetic-trees.html#cb499-10" aria-hidden="true" tabindex="-1"></a><span class="do">## you can call each individually as</span></span>
<span id="cb499-11"><a href="estimating-phylogenetic-trees.html#cb499-11" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb499-12"><a href="estimating-phylogenetic-trees.html#cb499-12" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb499-13"><a href="estimating-phylogenetic-trees.html#cb499-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-14"><a href="estimating-phylogenetic-trees.html#cb499-14" aria-hidden="true" tabindex="-1"></a><span class="do">## but you can use cowplot to print both side-by-side</span></span>
<span id="cb499-15"><a href="estimating-phylogenetic-trees.html#cb499-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-16"><a href="estimating-phylogenetic-trees.html#cb499-16" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1, p2, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">labels =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code></pre></div>
<p><img src="figures/session_12_figs/21_ggtree_plot1.png" width="90%" /></p>
</div>
<div id="save-ggtree-plots-as-pdf-or-png" class="section level2" number="12.12">
<h2><span class="header-section-number">12.12</span> Save ggtree plots as PDF or PNG</h2>
<p><strong>12)</strong> You can save your ggtree plots using the function <code>ggsave()</code> and any other ggplot graph.</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="estimating-phylogenetic-trees.html#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="do">## save ggtree as pdf and png</span></span>
<span id="cb500-2"><a href="estimating-phylogenetic-trees.html#cb500-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;regular_bootstrap_ggtree.pdf&quot;</span>)</span>
<span id="cb500-3"><a href="estimating-phylogenetic-trees.html#cb500-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;regular_bootstrap_ggtree.png&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sequence-alignments.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mining-from-a-reference-dataset.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/12-Phylogenetic_trees_v7.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
